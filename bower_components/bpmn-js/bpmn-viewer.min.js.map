{"version":3,"file":"bpmn-viewer.min.js","sources":["bpmn-viewer.js"],"names":["e","exports","module","define","amd","f","window","global","self","BpmnJS","t","n","r","s","o","u","a","require","i","Error","call","length",1,"_dereq_","getSvgContents","diagram","outerNode","get","getContainer","svg","innerHTML","replace","initListeners","listeners","events","forEach","l","on","event","handler","checkValidationError","err","pattern","match","exec","message","Viewer","options","this","parent","container","$","addClass","css","position","appendTo","_","logoData","bottom","right","zIndex","attr","Diagram","BpmnModdle","Importer","prototype","importXML","xml","done","moddle","createModdle","fromXML","definitions","importDefinitions","saveXML","toXML","SVG_HEADER","SVG_FOOTER","saveSVG","svgContents","name","invoke","fn","clear","_createDiagram","_init","importBpmnDiagram","__listeners","modules","concat","getModules","additionalModules","unshift","bpmnjs","omit","extend","canvas","_modules","destroy","push","./core","./draw","./import/Importer","bpmn-moddle","diagram-js","diagram-js/lib/features/overlays","diagram-js/lib/features/selection",2,"elementData","semantic","attrs","id","type","$type","businessObject","collectWaypoints","waypoints","collect","p","x","y","BpmnImporter","eventBus","elementFactory","elementRegistry","_eventBus","_canvas","_elementFactory","_elementRegistry","LabelUtil","hasExternalLabel","getExternalLabelBounds","isExpanded","$inject","add","parentElement","element","di","$instanceOf","createRoot","collapsed","hidden","bounds","createShape","width","height","addShape","source","_getSource","target","_getTarget","createConnection","waypoint","addConnection","addLabel","fire","label","createLabel","labelTarget","elementSemantic","sourceRef","isArray","$parent","_getElement","targetRef","getById","../util/Di","../util/Label",3,"bpmnImporter","./BpmnImporter",4,"BpmnRenderer","styles","pathMap","addMarker","markers","marker","initMarkers","paper","createMarker","fill","strokeWidth","strokeLinecap","strokeDasharray","ref","scale","markerWidth","markerHeight","path","circle","stroke","computeStyle","custom","traits","defaultStyles","style","drawCircle","offset","isObject","cx","cy","Math","round","drawRect","rect","drawDiamond","x_2","y_2","points","polygon","drawLine","flattenPoints","polyline","drawPath","d","as","handlers","renderer","renderEventContent","getSemantic","isThrowing","isThrowEvent","isTypedEvent","parallelMultiple","renderLabel","labelUtil","renderEmbeddedLabel","align","box","renderExternalLabel","fontSize","renderLaneLabel","text","textBox","top","transform","createPathFromConnection","connection","pathData","attachTaskMarkers","taskMarkers","obj","subprocess","contains","seq","parallel","compensation","loop","adhoc","loopCharacteristics","undefined","isSequential","isForCompensation","drawShape","h","DefaultRenderer","apply","drawConnection","renderDataItemCollection","yPosition","getScaledPath","xScaleFactor","yScaleFactor","containerWidth","containerHeight","mx","my","isCollection","elementObjectRef","getDi","eventDefinitionType","filter","matches","definition","all","val","key","any","eventDefinitions","TASK_BORDER_RADIUS","INNER_OUTER_DIST","LABEL_STYLE","fontFamily","size","bpmn:Event","bpmn:StartEvent","isInterrupting","bpmn:MessageEventDefinition","messagePath","bpmn:TimerEventDefinition","bpmn:EscalationEventDefinition","bpmn:ConditionalEventDefinition","bpmn:LinkEventDefinition","bpmn:ErrorEventDefinition","bpmn:CancelEventDefinition","bpmn:CompensateEventDefinition","bpmn:SignalEventDefinition","bpmn:MultipleEventDefinition","bpmn:ParallelMultipleEventDefinition","bpmn:EndEvent","bpmn:TerminateEventDefinition","bpmn:IntermediateEvent","outer","bpmn:IntermediateCatchEvent","bpmn:IntermediateThrowEvent","bpmn:Activity","bpmn:Task","bpmn:ServiceTask","task","pathDataBG","abspos","fillPathData","bpmn:UserTask","pathData2","pathData3","bpmn:ManualTask","bpmn:SendTask","bpmn:ReceiveTask","instantiate","bpmn:ScriptTask","bpmn:BusinessRuleTask","headerPathData","businessHeaderPath","headerData","businessPath","bpmn:SubProcess","expanded","DiUtil","isEventSubProcess","triggeredByEvent","bpmn:AdHocSubProcess","bpmn:Transaction","innerAttrs","bpmn:CallActivity","bpmn:Participant","lane","expandedPool","isExpandedPool","text2","participantMultiplicity","bpmn:Lane","bpmn:InclusiveGateway","diamond","bpmn:ExclusiveGateway","bpmn:ComplexGateway","bpmn:ParallelGateway","bpmn:EventBasedGateway","drawEvent","eventGatewayType","parallelPath","innerCircle","bpmn:Gateway","bpmn:SequenceFlow","markerEnd","sequenceFlow","conditionExpression","markerStart","default","bpmn:Association","bpmn:DataInputAssociation","bpmn:DataOutputAssociation","bpmn:MessageFlow","messageVisibleKind","midPoint","getPointAtLength","getTotalLength","markerPathData","messageAttrs","bpmn:DataObject","elementObject","bpmn:DataObjectReference","bpmn:DataInput","arrowPathData","getRawPath","bpmn:DataOutput","bpmn:DataStoreReference","DATA_STORE_PATH","elementStore","bpmn:BoundaryEvent","cancel","cancelActivity","bpmn:Group","pointerEvents","bpmn:TextAnnotation","textElement","textPathData","ParticipantMultiplicityMarker","subProcessPath","SubProcessMarker","markerRect","ParallelMarker","SequentialMarker","sequentialPath","CompensationMarker","compensationPath","LoopMarker","loopPath","strokeMiterlimit","AdhocMarker","Object","create","diagram-js/lib/draw/Renderer","diagram-js/lib/util/LabelUtil",5,"PathMap","Snap","EVENT_MESSAGE","heightElements","widthElements","EVENT_SIGNAL","EVENT_ESCALATION","EVENT_CONDITIONAL","EVENT_LINK","EVENT_ERROR","EVENT_CANCEL_45","EVENT_COMPENSATION","EVENT_TIMER_WH","EVENT_MULTIPLE","EVENT_PARALLEL_MULTIPLE","GATEWAY_EXCLUSIVE","GATEWAY_PARALLEL","GATEWAY_EVENT_BASED","GATEWAY_COMPLEX","DATA_OBJECT_PATH","DATA_OBJECT_COLLECTION_PATH","DATA_ARROW","DATA_STORE","TEXT_ANNOTATION","MARKER_SUB_PROCESS","MARKER_PARALLEL","MARKER_SEQUENTIAL","MARKER_COMPENSATION","MARKER_LOOP","MARKER_ADHOC","TASK_TYPE_SEND","TASK_TYPE_SCRIPT","TASK_TYPE_USER_1","TASK_TYPE_USER_2","TASK_TYPE_USER_3","TASK_TYPE_MANUAL","TASK_TYPE_INSTANTIATING_SEND","TASK_TYPE_SERVICE","TASK_TYPE_SERVICE_FILL","TASK_TYPE_BUSINESS_RULE_HEADER","TASK_TYPE_BUSINESS_RULE_MAIN","MESSAGE_FLOW_MARKER","pathId","param","rawPath","coordinates","heightRatio","widthRatio","heightIndex","widthIndex","format",6,"__depends__","../core","./BpmnRenderer","./PathMap",7,"BpmnTreeWalker","contextual","ctx","is","visit","gfx","visitRoot","root","visitIfDi","logError","error","context","registerDi","bpmnElement","diRefs","bind","handleDiagram","handlePlane","plane","planeElement","handlePlaneElement","handleDefinitions","diagrams","indexOf","rootElement","handleProcess","handleCollaboration","handleUnhandledProcesses","rootElements","handleDeferred","deferred","process","handleFlowElementsContainer","handleIoSpecification","ioSpecification","handleArtifacts","artifacts","handledProcesses","processes","laneSets","handleMessageFlow","messageFlow","handleMessageFlows","messageFlows","handleDataAssociation","association","handleDataInput","dataInput","handleDataOutput","dataOutput","handleArtifact","artifact","dataInputs","dataOutputs","handleSubProcess","subProcess","handleFlowNode","flowNode","childCtx","handleSequenceFlow","handleDataElement","dataObject","handleBoundaryEvent","handleLane","newContext","childLaneSet","handleLaneSet","filterList","flowNodeRef","handleFlowElements","laneSet","lanes","handleLaneSets","handleNonFlowNodes","flowElements","dataInputAssociations","dataOutputAssociations","handleParticipant","participant","newCtx","processRef","collaboration","participants","Refs","enumerable","object-refs",8,"importer","warnings","visitor","parentShape","walker","./BpmnTreeWalker",9,10,"DEFAULT_LABEL_SIZE","getWaypointsMid","mid","first","floor","second","ceil","getExternalLabelMid","max",11,"./lib/simple",12,"packages","Moddle","ModdleXml","xmlStr","typeName","isString","isFunction","reader","Reader","rootHandler","result","writer","Writer","moddle-xml",13,"bpmn","bpmndi","dc","../resources/bpmn/json/bpmn.json","../resources/bpmn/json/bpmndi.json","../resources/bpmn/json/dc.json","../resources/bpmn/json/di.json","./bpmn-moddle",14,"./lib/Reader","./lib/Writer",15,"parseNodeAttributes","node","nodeAttrs","attributes","reduce","v","ns","local","parseNameNs","prefix","value","normalizeNamespaces","model","defaultNsUri","uri","pkg","getPackage","Context","parseRoot","elementsById","references","addReference","reference","addElement","addWarning","w","BaseHandler","BodyHandler","ReferenceHandler","property","ValueHandler","propertyDesc","BaseElementHandler","ElementHandler","getType","GenericElementHandler","XMLReader","resolveReferences","$descriptor","propertiesByName","isMany","collection","idx","splice","set","parser","sax","xmlns","trim","stack","Stack","onerror","onopentag","peek","handleNode","line","column","ontext","oncdata","handleText","onclosetag","old","pop","handleEnd","onend","getElement","write","close","common","Types","types","parseName","aliasToName","body","createReference","coerceType","handleChild","createElement","descriptor","bodyProperty","Type","instance","prop","isReference","getPropertyForElement","nameNs","propertyName","localName","$pkg","elementType","find","properties","isVirtual","isAttribute","hasType","effectiveType","toString","valueHandler","referenceHandler","childHandler","isSimple","newElement","createAny","children","$children","$body","./common","tiny-stack",16,"nsName","getElementNs","isGeneric","nameToAlias","getPropertyNs","getSerializableProperties","hasOwnProperty","escapeAttr","str","escapeMap","\n","\n\r","\"","filterAttributes","props","isAttr","filterContained","ReferenceSerializer","BodySerializer","ValueSerializer","ElementSerializer","TypeSerializer","SavingWriter","FormatingWriter","out","indent","append","appendNewLine","appendIndent","join","unindent","XMLWriter","tree","internalWriter","formatingWriter","preamble","XML_PREAMBLE","build","serializeTo","CDATA_ESCAPE","DEFAULT_NS_MAP","serializeValue","escape","test","otherAttrs","parseNsAttributes","nsTagName","parseGeneric","parseAttributes","parseContainments","parseGenericAttributes","effectiveNs","logNamespaceUsed","nsPropertyTagName","isLocalNs","nsAttributeName","child","genericAttrs","$attrs","logNamespace","addAttribute","console","warn","isBody","asType","serialize","serializer","getNamespaces","namespaces","prefixMap","uriMap","used","existing","$model","serializeAttributes","collectNsAttrs","hasBody","b","typeNs",17,"capitalize","string","charAt","toUpperCase","slice","lower","toLowerCase","hasLowerCaseAlias","alias","xsi",18,"./lib/moddle","./lib/ns","./lib/types",19,"Base",20,"DescriptorBuilder","allTypes","pick","addProperty","addNamedProperty","replaceProperty","oldProperty","newProperty","oldNameNs","setBodyProperty","redefineProperty","nsPrefix","parts","redefines","split","attrName","redefinedProperty","validate","propsByName","assertNotDefined","removeNamedProperty","addIdProperty","definedProperty","definedBy","hasProperty","addTrait","defineProperty","./ns",21,"Factory","createType","ModdleElement","writable","defineModel","defineDescriptor","./base",22,"Properties","factory","registry","Registry","typeCache","cache","getEffectiveDescriptor","nsUri","uriOrPrefix","getPackages","getElementDescriptor","getPropertyDescriptor","./factory","./properties","./registry","./types",23,"defaultPrefix",24,25,"generateId","packageMap","typeMap","registerPackage","registerType","propertyNs","isBuiltIn","definePackage","mapTypes","iterator","superClass","cls","parentNs","builder","./descriptor-builder",26,"BUILTINS","String","Boolean","Integer","Real","Element","TYPE_CONVERTERS","parseInt","parseFloat","converter",27,"TinyStack","data","arg",28,29,30,31,32,33,34,35,36,37,"associations","isAbstract","emumerations","literalValues",38,39,40,"isReadOnly","isUnique","subsettedProperty",41,"./lib/Diagram",42,"bootstrap","bootstrapModules","hasModule","m","addModule","__init__","c","components","injector","Injector","createInjector","configModule","config","coreModule","didi",43,"number","resolution","ensurePx","isNumber","createContainer","document","setAttribute","appendChild","Canvas","graphicsFactory","snap","createPaper","sendToFront","shape","bubble","getGraphics","gfxParent","remove","getGraphicsByElement","_snap","_graphicsFactory","_container","_paper","_root","group","class","parentNode","removeChild","setCTM","mstr","_ensureValidId","getRoot","updateShape","updateConnection","_removeElement","removeShape","removeConnection","_fireViewboxChange","viewbox","innerBox","matrix","outerBox","getSize","Matrix","translate","getBBox","localMatrix","inner","scroll","delta","getCTM","dx","dy","createSVGMatrix","multiply","zoom","newScale","center","vbox","min","_setZoom","centerPoint","originalPoint","currentMatrix","scaleMatrix","newMatrix","viewport","point","createSVGPoint","currentScale","matrixTransform","inverse","clientWidth","clientHeight","getAbsoluteBBox","transformBBox","bbox","../util/Collections",44,"ElementFactory","_uid","Model","../model",45,"ElementRegistry","_elementMap","_graphicsMap","graphicsMap","getByGraphics",46,"EventBus","getListeners","listenerMap","extendEvent","stopPropagation","propagationStopped","preventDefault","defaultPrevented","isPropagationStopped","isDefaultPrevented","priority","callback","EventPriority","standard","addEventToArray","once","wrappedCallback","eventType","arguments","off","listener","handleError","args","Array","shift","array","sort","overwrite",47,"gfxContainer","clearVisual","oldVisual","select","newVisual","before","createContainerFactory","GraphicsFactory","_renderer","createSnapAt","gfxGroup",48,"../draw","./Canvas","./ElementFactory","./ElementRegistry","./EventBus","./GraphicsFactory",49,"Renderer","CONNECTION_STYLE","SHAPE_STYLE",50,"snapsvg","./snapsvg-extensions",51,"Styles","defaultTraits","no-fill","no-border","strokeOpacity","no-events","className","additionalAttrs","inject",52,"./Renderer","./Snap","./Styles",53,"plugin","getClasses","setClasses","classes","current","hasClass","removeClass","createElementNS",54,"InteractionEvents","isCtxSwitch","relatedTarget","baseEvent","eventName","makeSelectable","hit","visual","GraphicsUtil","getVisual","clone","HIT_STYLE","prependTo","hover","click","dblclick","registerEvents","../../util/GraphicsUtil",55,"interactionEvents","./InteractionEvents",56,"Outline","createOutline","OUTLINE_STYLE","updateOutline","outline","OUTLINE_OFFSET",57,"./Outline",58,"Overlays","_ids","ids","_overlayDefaults","show","trigger","minZoom","maxZoom","_overlays","_overlayContainers","_overlayRoot","_getOverlayContainer","overlays","overlay","html","next","_addOverlay","htmlContainer","hide","_updateOverlayContainer","left","_updateOverlay","_createOverlayContainer","_updateRoot","raw","_updateOverlayVisibilty","updateViewbox","deferUpdate","debounce","../../util/IdGenerator",59,"./Overlays",60,"Selection","_selectedElements","deselect","selectedElements","oldSelection","newSelection","isSelected","elements",61,"originalEvent","srcEvent","SelectionVisuals","selection","removeMarker","HOVER_CLS","SELECTED_CLS","shiftKey","srcElement",62,"selectionVisuals","../interaction-events","../outline","./Selection","./SelectionVisuals",63,"parentRefs","labelRefs","outgoingRefs","incomingRefs","Shape","Root","Label","Connection",64,65,66,"IdGenerator","_counter","_prefix","random",67,"parseAlign","horizontal","vertical","parsePadding","padding","layoutNext","lines","fit","fitLine","originalLine","nextLine","remainder","textBBox","getTextBBox","semanticShorten","maxLength","part","shortenedParts","shortenLine","maxWidth","shortenedLine","approximateLength","merge","layouted","totalHeight","sum","DEFAULT_BOX_PADDING",68,"annotate","FN_ARGS","FN_ARG","parse","map",69,"Module","./annotation","./injector","./module",70,"autoAnnotate","currentlyResolving","providers","_providers","instances","_instances","msg","pivot","returned","dependencies","dep","createPrivateInjectorFactory","privateChildInjector","createChild","forceNewInstances","provider","cacheIdx","privateChildInjectorFactory","fromParentModule","matchedScopes","privateInjectorsCache","privateChildInjectors","privateChildFactories","$scope","scope","factoryMap","arrayUnwrap","__exports__","clonedModule","keys","substring","privateInjector","__modules__","getFromPrivateInjector",71,72,"Collection","./lib/collection","./lib/refs",73,"refs","inverseProperty","unset",74,"defineCollectionProperty","_value","ensureBound","./collection",75,76,77],"mappings":"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","sourcesContent":["!function(e){if(\"object\"==typeof exports&&\"undefined\"!=typeof module)module.exports=e();else if(\"function\"==typeof define&&define.amd)define([],e);else{var f;\"undefined\"!=typeof window?f=window:\"undefined\"!=typeof global?f=global:\"undefined\"!=typeof self&&(f=self),f.BpmnJS=e()}}(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error(\"Cannot find module '\"+o+\"'\")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nvar Diagram = _dereq_('diagram-js'),\r\n    BpmnModdle = _dereq_('bpmn-moddle'),\r\n    $ = (window.$),\r\n    _ = (window._);\r\n\r\nvar Importer = _dereq_('./import/Importer');\r\n\r\n\r\nfunction getSvgContents(diagram) {\r\n  var outerNode = diagram.get('canvas').getContainer();\r\n\r\n  var svg = outerNode.innerHTML;\r\n  return svg.replace(/^.*<svg[^>]*>|<\\/svg>.*$/g, '')\r\n            .replace('<desc>Created with Snap</desc>', '')\r\n            .replace(/<g class=\"viewport\"( transform=\"[^\"]*\")?/, '<g');\r\n}\r\n\r\nfunction initListeners(diagram, listeners) {\r\n  var events = diagram.get('eventBus');\r\n\r\n  listeners.forEach(function(l) {\r\n    events.on(l.event, l.handler);\r\n  });\r\n}\r\n\r\nfunction checkValidationError(err) {\r\n\r\n  // check if we can help the user by indicating wrong BPMN 2.0 xml\r\n  // (in case he or the exporting tool did not get that right)\r\n\r\n  var pattern = /unparsable content <([^>]+)> detected([\\s\\S]*)$/;\r\n  var match = pattern.exec(err.message);\r\n\r\n  if (match) {\r\n    err.message =\r\n      'unparsable content <' + match[1] + '> detected; ' +\r\n      'this may indicate an invalid BPMN 2.0 diagram file' + match[2];\r\n  }\r\n\r\n  return err;\r\n}\r\n\r\n/**\r\n * A viewer for BPMN 2.0 diagrams\r\n *\r\n * @class\r\n *\r\n * @param {Object} [options] configuration options to pass to the viewer\r\n * @param {DOMElement} [options.container] the container to render the viewer in, defaults to body.\r\n * @param {String|Number} [options.width] the width of the viewer\r\n * @param {String|Number} [options.height] the height of the viewer\r\n * @param {Array<didi.Module>} [options.modules] a list of modules to override the default modules\r\n * @param {Array<didi.Module>} [options.additionalModules] a list of modules to use with the default modules\r\n */\r\nfunction Viewer(options) {\r\n  this.options = options = options || {};\r\n\r\n  var parent = options.container || $('body');\r\n\r\n  var container = $('<div></div>').addClass('bjs-container').css({\r\n    position: 'relative'\r\n  }).appendTo(parent);\r\n\r\n  _.forEach([ 'width', 'height' ], function(a) {\r\n    if (options[a]) {\r\n      container.css(a, options[a]);\r\n    }\r\n  });\r\n\r\n  // unwrap jquery\r\n  this.container = container.get(0);\r\n\r\n\r\n  /**\r\n   * The code in the <project-logo></project-logo> area\r\n   * must not be changed, see http://bpmn.io/license for more information\r\n   *\r\n   * <project-logo>\r\n   */\r\n\r\n  /* jshint -W101 */\r\n\r\n  // inlined ../resources/bpmnjs.png\r\n  var logoData = 'iVBORw0KGgoAAAANSUhEUgAAADQAAAA0CAMAAADypuvZAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAADBQTFRFiMte9PrwldFwfcZPqtqN0+zEyOe1XLgjvuKncsJAZ70y6fXh3vDT////UrQV////G2zN+AAAABB0Uk5T////////////////////AOAjXRkAAAHDSURBVHjavJZJkoUgDEBJmAX8979tM8u3E6x20VlYJfFFMoL4vBDxATxZcakIOJTWSmxvKWVIkJ8jHvlRv1F2LFrVISCZI+tCtQx+XfewgVTfyY3plPiQEAzI3zWy+kR6NBhFBYeBuscJLOUuA2WVLpCjVIaFzrNQZArxAZKUQm6gsj37L9Cb7dnIBUKxENaaMJQqMpDXvSL+ktxdGRm2IsKgJGGPg7atwUG5CcFUEuSv+CwQqizTrvDTNXdMU2bMiDWZd8d7QIySWVRsb2vBBioxOFt4OinPBapL+neAb5KL5IJ8szOza2/DYoipUCx+CjO0Bpsv0V6mktNZ+k8rlABlWG0FrOpKYVo8DT3dBeLEjUBAj7moDogVii7nSS9QzZnFcOVBp1g2PyBQ3Vr5aIapN91VJy33HTJLC1iX2FY6F8gRdaAeIEfVONgtFCzZTmoLEdOjBDfsIOA6128gw3eu1shAajdZNAORxuQDJN5A5PbEG6gNIu24QJD5iNyRMZIr6bsHbCtCU/OaOaSvgkUyDMdDa1BXGf5HJ1To+/Ym6mCKT02Y+/Sa126ZKyd3jxhzpc1r8zVL6YM1Qy/kR4ABAFJ6iQUnivhAAAAAAElFTkSuQmCC';\r\n\r\n  /* jshint +W101 */\r\n\r\n  var a = $('<a href=\"http://bpmn.io\" target=\"_blank\" class=\"bjs-powered-by\" title=\"Powered by bpmn.io\" />').css({\r\n    position: 'absolute',\r\n    bottom: 15,\r\n    right: 15,\r\n    zIndex: 100\r\n  });\r\n\r\n  var logo = $('<img/>').attr('src', 'data:image/png;base64,' + logoData).appendTo(a);\r\n\r\n  a.appendTo(container);\r\n\r\n  /* </project-logo> */\r\n}\r\n\r\nViewer.prototype.importXML = function(xml, done) {\r\n\r\n  var self = this;\r\n\r\n  this.moddle = this.createModdle();\r\n\r\n  this.moddle.fromXML(xml, 'bpmn:Definitions', function(err, definitions) {\r\n\r\n    if (err) {\r\n      err = checkValidationError(err);\r\n      return done(err);\r\n    }\r\n\r\n    self.importDefinitions(definitions, done);\r\n  });\r\n};\r\n\r\nViewer.prototype.saveXML = function(options, done) {\r\n\r\n  if (!done) {\r\n    done = options;\r\n    options = {};\r\n  }\r\n\r\n  var definitions = this.definitions;\r\n\r\n  if (!definitions) {\r\n    return done(new Error('no definitions loaded'));\r\n  }\r\n\r\n  this.moddle.toXML(definitions, options, function(err, xml) {\r\n    done(err, xml);\r\n  });\r\n};\r\n\r\nViewer.prototype.createModdle = function() {\r\n  return new BpmnModdle();\r\n};\r\n\r\nvar SVG_HEADER =\r\n'<?xml version=\"1.0\" encoding=\"utf-8\"?>\\n' +\r\n'<!-- created with bpmn-js / http://bpmn.io -->\\n' +\r\n'<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\\n' +\r\n'<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" version=\"1.1\">\\n';\r\n\r\nvar SVG_FOOTER = '</svg>';\r\n\r\nViewer.prototype.saveSVG = function(options, done) {\r\n  if (!done) {\r\n    done = options;\r\n    options = {};\r\n  }\r\n\r\n  if (!this.definitions) {\r\n    return done(new Error('no definitions loaded'));\r\n  }\r\n\r\n  var svgContents = getSvgContents(this.diagram);\r\n\r\n  var svg = SVG_HEADER + svgContents + SVG_FOOTER;\r\n\r\n  done(null, svg);\r\n};\r\n\r\nViewer.prototype.get = function(name) {\r\n\r\n  if (!this.diagram) {\r\n    throw new Error('no diagram loaded');\r\n  }\r\n\r\n  return this.diagram.get(name);\r\n};\r\n\r\nViewer.prototype.invoke = function(fn) {\r\n\r\n  if (!this.diagram) {\r\n    throw new Error('no diagram loaded');\r\n  }\r\n\r\n  return this.diagram.invoke(fn);\r\n};\r\n\r\nViewer.prototype.importDefinitions = function(definitions, done) {\r\n\r\n  // use try/catch to not swallow synchronous exceptions\r\n  // that may be raised during model parsing\r\n  try {\r\n    if (this.diagram) {\r\n      this.clear();\r\n    }\r\n\r\n    this.definitions = definitions;\r\n    this.diagram = this._createDiagram(this.options);\r\n\r\n    this._init(this.diagram);\r\n\r\n    Importer.importBpmnDiagram(this.diagram, definitions, done);\r\n  } catch (e) {\r\n    done(e);\r\n  }\r\n};\r\n\r\nViewer.prototype._init = function(diagram) {\r\n  initListeners(diagram, this.__listeners || []);\r\n};\r\n\r\nViewer.prototype._createDiagram = function(options) {\r\n\r\n  var modules = [].concat(options.modules || this.getModules(), options.additionalModules || []);\r\n\r\n  // add self as an available service\r\n  modules.unshift({\r\n    bpmnjs: [ 'value', this ],\r\n    moddle: [ 'value', this.moddle ]\r\n  });\r\n\r\n  options = _.omit(options, 'additionalModules');\r\n\r\n  options = _.extend(options, {\r\n    canvas: { container: this.container },\r\n    modules: modules\r\n  });\r\n\r\n  return new Diagram(options);\r\n};\r\n\r\n\r\nViewer.prototype.getModules = function() {\r\n  return this._modules;\r\n};\r\n\r\n/**\r\n * Remove all drawn elements from the viewer\r\n */\r\nViewer.prototype.clear = function() {\r\n  var diagram = this.diagram;\r\n\r\n  if (diagram) {\r\n    diagram.destroy();\r\n  }\r\n};\r\n\r\n/**\r\n * Register an event listener on the viewer\r\n *\r\n * @param {String} event\r\n * @param {Function} handler\r\n */\r\nViewer.prototype.on = function(event, handler) {\r\n  var diagram = this.diagram,\r\n      listeners = this.__listeners = this.__listeners || [];\r\n\r\n  listeners = this.__listeners || [];\r\n  listeners.push({ event: event, handler: handler });\r\n\r\n  if (diagram) {\r\n    diagram.get('eventBus').on(event, handler);\r\n  }\r\n};\r\n\r\n// modules the viewer is composed of\r\nViewer.prototype._modules = [\r\n  _dereq_('./core'),\r\n  _dereq_('./draw'),\r\n  _dereq_('diagram-js/lib/features/selection'),\r\n  _dereq_('diagram-js/lib/features/overlays')\r\n];\r\n\r\nmodule.exports = Viewer;\r\n\n},{\"./core\":3,\"./draw\":6,\"./import/Importer\":8,\"bpmn-moddle\":11,\"diagram-js\":41,\"diagram-js/lib/features/overlays\":59,\"diagram-js/lib/features/selection\":62}],2:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nvar _ = (window._);\r\n\r\nvar LabelUtil = _dereq_('../util/Label');\r\n\r\nvar hasExternalLabel = LabelUtil.hasExternalLabel,\r\n    getExternalLabelBounds = LabelUtil.getExternalLabelBounds,\r\n    isExpanded = _dereq_('../util/Di').isExpanded;\r\n\r\n\r\nfunction elementData(semantic, attrs) {\r\n  return _.extend({\r\n    id: semantic.id,\r\n    type: semantic.$type,\r\n    businessObject: semantic\r\n  }, attrs);\r\n}\r\n\r\nfunction collectWaypoints(waypoints) {\r\n  return _.collect(waypoints, function(p) {\r\n    return { x: p.x, y: p.y };\r\n  });\r\n}\r\n\r\n\r\n/**\r\n * An importer that adds bpmn elements to the canvas\r\n *\r\n * @param {EventBus} eventBus\r\n * @param {Canvas} canvas\r\n * @param {ElementFactory} elementFactory\r\n * @param {ElementRegistry} elementRegistry\r\n */\r\nfunction BpmnImporter(eventBus, canvas, elementFactory, elementRegistry) {\r\n  this._eventBus = eventBus;\r\n  this._canvas = canvas;\r\n\r\n  this._elementFactory = elementFactory;\r\n  this._elementRegistry = elementRegistry;\r\n}\r\n\r\nBpmnImporter.$inject = [ 'eventBus', 'canvas', 'elementFactory', 'elementRegistry' ];\r\n\r\nmodule.exports = BpmnImporter;\r\n\r\n\r\n/**\r\n * Add bpmn element (semantic) to the canvas onto the\r\n * specified parent shape.\r\n */\r\nBpmnImporter.prototype.add = function(semantic, parentElement) {\r\n\r\n  var di = semantic.di,\r\n      element;\r\n\r\n  // ROOT ELEMENT\r\n  // handle the special case that we deal with a\r\n  // invisible root element (process or collaboration)\r\n  if (di.$instanceOf('bpmndi:BPMNPlane')) {\r\n\r\n    // add a virtual element (not being drawn)\r\n    element = this._elementFactory.createRoot(elementData(semantic));\r\n  }\r\n\r\n  // SHAPE\r\n  else if (di.$instanceOf('bpmndi:BPMNShape')) {\r\n\r\n    var collapsed = !isExpanded(semantic);\r\n    var hidden = parentElement && (parentElement.hidden || parentElement.collapsed);\r\n\r\n    var bounds = semantic.di.bounds;\r\n\r\n    element = this._elementFactory.createShape(elementData(semantic, {\r\n      collapsed: collapsed,\r\n      hidden: hidden,\r\n      x: bounds.x,\r\n      y: bounds.y,\r\n      width: bounds.width,\r\n      height: bounds.height\r\n    }));\r\n\r\n    this._canvas.addShape(element, parentElement);\r\n  }\r\n\r\n  // CONNECTION\r\n  else if (di.$instanceOf('bpmndi:BPMNEdge')) {\r\n\r\n    var source = this._getSource(semantic),\r\n        target = this._getTarget(semantic);\r\n\r\n    if (!source || !target) {\r\n      throw new Error('source or target not rendered for element <' + semantic.id + '>');\r\n    }\r\n\r\n    element = this._elementFactory.createConnection(elementData(semantic, {\r\n      source: source,\r\n      target: target,\r\n      waypoints: collectWaypoints(semantic.di.waypoint)\r\n    }));\r\n\r\n    this._canvas.addConnection(element, parentElement);\r\n  } else {\r\n    throw new Error('unknown di <' + di.$type + '> for element <' + semantic.id + '>');\r\n  }\r\n\r\n  // (optional) LABEL\r\n  if (hasExternalLabel(semantic)) {\r\n    this.addLabel(semantic, element);\r\n  }\r\n\r\n  this._eventBus.fire('bpmnElement.added', { element: element });\r\n\r\n  return element;\r\n};\r\n\r\n\r\n/**\r\n * add label for an element\r\n */\r\nBpmnImporter.prototype.addLabel = function (semantic, element) {\r\n  var bounds = getExternalLabelBounds(semantic, element);\r\n\r\n  var label = this._elementFactory.createLabel(elementData(semantic, {\r\n    id: semantic.id + '_label',\r\n    labelTarget: element,\r\n    type: 'label',\r\n    hidden: element.hidden,\r\n    x: bounds.x,\r\n    y: bounds.y,\r\n    width: bounds.width,\r\n    height: bounds.height\r\n  }));\r\n\r\n  return this._canvas.addShape(label, element.parent);\r\n};\r\n\r\n\r\nBpmnImporter.prototype._getSource = function(semantic) {\r\n\r\n  var element,\r\n      elementSemantic = semantic.sourceRef;\r\n\r\n  // handle mysterious isMany DataAssociation#sourceRef\r\n  if (_.isArray(elementSemantic)) {\r\n    elementSemantic = elementSemantic[0];\r\n  }\r\n\r\n  if (elementSemantic && elementSemantic.$instanceOf('bpmn:DataOutput')) {\r\n    elementSemantic = elementSemantic.$parent.$parent;\r\n  }\r\n\r\n  element = elementSemantic && this._getElement(elementSemantic);\r\n\r\n  if (element) {\r\n    return element;\r\n  }\r\n\r\n  throw new Error('element <' + elementSemantic.id + '> referenced by <' + semantic.id + '> not yet drawn');\r\n};\r\n\r\n\r\nBpmnImporter.prototype._getTarget = function(semantic) {\r\n\r\n  var element,\r\n      elementSemantic = semantic.targetRef;\r\n\r\n  if (elementSemantic && elementSemantic.$instanceOf('bpmn:DataInput')) {\r\n    elementSemantic = elementSemantic.$parent.$parent;\r\n  }\r\n\r\n  element = elementSemantic && this._getElement(elementSemantic);\r\n\r\n  if (element) {\r\n    return element;\r\n  }\r\n\r\n  throw new Error('element <' + elementSemantic.id + '> referenced by <' + semantic.id + '> not yet drawn');\r\n};\r\n\r\n\r\nBpmnImporter.prototype._getElement = function(semantic) {\r\n  return this._elementRegistry.getById(semantic.id);\r\n};\n},{\"../util/Di\":9,\"../util/Label\":10}],3:[function(_dereq_,module,exports){\nmodule.exports = {\r\n  bpmnImporter: [ 'type', _dereq_('./BpmnImporter') ]\r\n};\n},{\"./BpmnImporter\":2}],4:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nvar _ = (window._);\r\n\r\nvar DefaultRenderer = _dereq_('diagram-js/lib/draw/Renderer');\r\nvar LabelUtil = _dereq_('diagram-js/lib/util/LabelUtil');\r\n\r\nvar DiUtil = _dereq_('../util/Di');\r\n\r\nvar flattenPoints = DefaultRenderer.flattenPoints;\r\n\r\n\r\nfunction BpmnRenderer(events, styles, pathMap) {\r\n\r\n  DefaultRenderer.call(this, styles);\r\n\r\n  var TASK_BORDER_RADIUS = 10;\r\n  var INNER_OUTER_DIST = 3;\r\n\r\n  var LABEL_STYLE = {\r\n    fontFamily: 'Arial, sans-serif',\r\n    fontSize: '12px'\r\n  };\r\n\r\n  var labelUtil = new LabelUtil({\r\n    style: LABEL_STYLE,\r\n    size: { width: 100 }\r\n  });\r\n\r\n  var markers = {};\r\n\r\n  function addMarker(id, element) {\r\n    markers[id] = element;\r\n  }\r\n\r\n  function marker(id) {\r\n    return markers[id];\r\n  }\r\n\r\n  function initMarkers(paper) {\r\n\r\n    function createMarker(id, options) {\r\n      var attrs = _.extend({\r\n        fill: 'black',\r\n        strokeWidth: 1,\r\n        strokeLinecap: 'round',\r\n        strokeDasharray: 'none'\r\n      }, options.attrs);\r\n\r\n      var ref = options.ref || { x: 0, y: 0 };\r\n\r\n      var scale = options.scale || 1;\r\n\r\n      // fix for safari / chrome / firefox bug not correctly\r\n      // resetting stroke dash array\r\n      if (attrs.strokeDasharray === 'none') {\r\n        attrs.strokeDasharray = [10000, 1];\r\n      }\r\n\r\n      var marker = options.element\r\n                     .attr(attrs)\r\n                     .marker(0, 0, 20, 20, ref.x, ref.y)\r\n                     .attr({\r\n                       markerWidth: 20 * scale,\r\n                       markerHeight: 20 * scale\r\n                     });\r\n\r\n      return addMarker(id, marker);\r\n    }\r\n\r\n\r\n    createMarker('sequenceflow-end', {\r\n      element: paper.path('M 1 5 L 11 10 L 1 15 Z'),\r\n      ref: { x: 11, y: 10 },\r\n      scale: 0.5\r\n    });\r\n\r\n    createMarker('messageflow-start', {\r\n      element: paper.circle(6, 6, 5),\r\n      attrs: {\r\n        fill: 'white',\r\n        stroke: 'black'\r\n      },\r\n      ref: { x: 6, y: 6 }\r\n    });\r\n\r\n    createMarker('messageflow-end', {\r\n      element: paper.path('M 1 5 L 11 10 L 1 15 Z'),\r\n      attrs: {\r\n        fill: 'white',\r\n        stroke: 'black'\r\n      },\r\n      ref: { x: 11, y: 10 }\r\n    });\r\n\r\n    createMarker('data-association-end', {\r\n      element: paper.path('M 1 5 L 11 10 L 1 15'),\r\n      attrs: {\r\n        fill: 'white',\r\n        stroke: 'black'\r\n      },\r\n      ref: { x: 11, y: 10 },\r\n      scale: 0.5\r\n    });\r\n\r\n    createMarker('conditional-flow-marker', {\r\n      element: paper.path('M 0 10 L 8 6 L 16 10 L 8 14 Z'),\r\n      attrs: {\r\n        fill: 'white',\r\n        stroke: 'black'\r\n      },\r\n      ref: { x: -1, y: 10 },\r\n      scale: 0.5\r\n    });\r\n\r\n    createMarker('conditional-default-flow-marker', {\r\n      element: paper.path('M 1 4 L 5 16'),\r\n      attrs: {\r\n        stroke: 'black'\r\n      },\r\n      ref: { x: -5, y: 10 },\r\n      scale: 0.5\r\n    });\r\n  }\r\n\r\n  function computeStyle(custom, traits, defaultStyles) {\r\n    if (!_.isArray(traits)) {\r\n      defaultStyles = traits;\r\n      traits = [];\r\n    }\r\n\r\n    return styles.style(traits || [], _.extend(defaultStyles, custom || {}));\r\n  }\r\n\r\n  function drawCircle(p, width, height, offset, attrs) {\r\n\r\n    if (_.isObject(offset)) {\r\n      attrs = offset;\r\n      offset = 0;\r\n    }\r\n\r\n    offset = offset || 0;\r\n\r\n    attrs = computeStyle(attrs, {\r\n      stroke: 'black',\r\n      strokeWidth: 2,\r\n      fill: 'white'\r\n    });\r\n\r\n    var cx = width / 2,\r\n        cy = height / 2;\r\n\r\n    return p.circle(cx, cy, Math.round((width + height) / 4 - offset)).attr(attrs);\r\n  }\r\n\r\n  function drawRect(p, width, height, r, offset, attrs) {\r\n\r\n    if (_.isObject(offset)) {\r\n      attrs = offset;\r\n      offset = 0;\r\n    }\r\n\r\n    offset = offset || 0;\r\n\r\n    attrs = computeStyle(attrs, {\r\n      stroke: 'black',\r\n      strokeWidth: 2,\r\n      fill: 'white'\r\n    });\r\n\r\n    return p.rect(offset, offset, width - offset * 2, height - offset * 2, r).attr(attrs);\r\n  }\r\n\r\n  function drawDiamond(p, width, height, attrs) {\r\n\r\n    var x_2 = width / 2;\r\n    var y_2 = height / 2;\r\n\r\n    var points = [x_2, 0, width, y_2, x_2, height, 0, y_2 ];\r\n\r\n    attrs = computeStyle(attrs, {\r\n      stroke: 'black',\r\n      strokeWidth: 2,\r\n      fill: 'white'\r\n    });\r\n\r\n    return p.polygon(points).attr(attrs);\r\n  }\r\n\r\n  function drawLine(p, waypoints, attrs) {\r\n    var points = flattenPoints(waypoints);\r\n\r\n    attrs = computeStyle(attrs, [ 'no-fill' ], {\r\n      stroke: 'black',\r\n      strokeWidth: 2,\r\n      fill: 'none'\r\n    });\r\n\r\n    return p.polyline(points).attr(attrs);\r\n  }\r\n\r\n  function drawPath(p, d, attrs) {\r\n\r\n    attrs = computeStyle(attrs, [ 'no-fill' ], {\r\n      strokeWidth: 2,\r\n      stroke: 'black'\r\n    });\r\n\r\n    return p.path(d).attr(attrs);\r\n  }\r\n\r\n  function as(type) {\r\n    return function(p, element) {\r\n      return handlers[type](p, element);\r\n    };\r\n  }\r\n\r\n  function renderer(type) {\r\n    return handlers[type];\r\n  }\r\n\r\n  function renderEventContent(element, p) {\r\n\r\n    var event = getSemantic(element);\r\n    var isThrowing = isThrowEvent(event);\r\n\r\n    if (isTypedEvent(event, 'bpmn:MessageEventDefinition')) {\r\n      return renderer('bpmn:MessageEventDefinition')(p, element, isThrowing);\r\n    }\r\n\r\n    if (isTypedEvent(event, 'bpmn:TimerEventDefinition')) {\r\n      return renderer('bpmn:TimerEventDefinition')(p, element, isThrowing);\r\n    }\r\n\r\n    if (isTypedEvent(event, 'bpmn:ConditionalEventDefinition')) {\r\n      return renderer('bpmn:ConditionalEventDefinition')(p, element);\r\n    }\r\n\r\n    if (isTypedEvent(event, 'bpmn:SignalEventDefinition')) {\r\n      return renderer('bpmn:SignalEventDefinition')(p, element, isThrowing);\r\n    }\r\n\r\n    if (isTypedEvent(event, 'bpmn:CancelEventDefinition') &&\r\n      isTypedEvent(event, 'bpmn:TerminateEventDefinition', { parallelMultiple: false })) {\r\n      return renderer('bpmn:MultipleEventDefinition')(p, element, isThrowing);\r\n    }\r\n\r\n    if (isTypedEvent(event, 'bpmn:CancelEventDefinition') &&\r\n      isTypedEvent(event, 'bpmn:TerminateEventDefinition', { parallelMultiple: true })) {\r\n      return renderer('bpmn:ParallelMultipleEventDefinition')(p, element, isThrowing);\r\n    }\r\n\r\n    if (isTypedEvent(event, 'bpmn:EscalationEventDefinition')) {\r\n      return renderer('bpmn:EscalationEventDefinition')(p, element, isThrowing);\r\n    }\r\n\r\n    if (isTypedEvent(event, 'bpmn:LinkEventDefinition')) {\r\n      return renderer('bpmn:LinkEventDefinition')(p, element, isThrowing);\r\n    }\r\n\r\n    if (isTypedEvent(event, 'bpmn:ErrorEventDefinition')) {\r\n      return renderer('bpmn:ErrorEventDefinition')(p, element, isThrowing);\r\n    }\r\n\r\n    if (isTypedEvent(event, 'bpmn:CancelEventDefinition')) {\r\n      return renderer('bpmn:CancelEventDefinition')(p, element, isThrowing);\r\n    }\r\n\r\n    if (isTypedEvent(event, 'bpmn:CompensateEventDefinition')) {\r\n      return renderer('bpmn:CompensateEventDefinition')(p, element, isThrowing);\r\n    }\r\n\r\n    if (isTypedEvent(event, 'bpmn:TerminateEventDefinition')) {\r\n      return renderer('bpmn:TerminateEventDefinition')(p, element, isThrowing);\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  function renderLabel(p, label, options) {\r\n    return labelUtil.createLabel(p, label || '', options).addClass('djs-label');\r\n  }\r\n\r\n  function renderEmbeddedLabel(p, element, align) {\r\n    var semantic = getSemantic(element);\r\n    return renderLabel(p, semantic.name, { box: element, align: align });\r\n  }\r\n\r\n  function renderExternalLabel(p, element, align) {\r\n    var semantic = getSemantic(element);\r\n    return renderLabel(p, semantic.name, { box: element, align: align, style: { fontSize: '11px' } });\r\n  }\r\n\r\n  function renderLaneLabel(p, text, element) {\r\n    var textBox = renderLabel(p, text, {\r\n      box: { height: 30, width: element.height },\r\n      align: 'center-middle'\r\n    });\r\n\r\n    var top = -1 * element.height;\r\n    textBox.transform(\r\n      'rotate(270) ' +\r\n      'translate(' + top + ',' + 0 + ')'\r\n    );\r\n  }\r\n\r\n  function createPathFromConnection(connection) {\r\n    var waypoints = connection.waypoints;\r\n\r\n    var pathData = 'm  ' + waypoints[0].x + ',' + waypoints[0].y;\r\n    for (var i = 1; i < waypoints.length; i++) {\r\n      pathData += 'L' + waypoints[i].x + ',' + waypoints[i].y + ' ';\r\n    }\r\n    return pathData;\r\n  }\r\n\r\n  var handlers = {\r\n    'bpmn:Event': function(p, element, attrs) {\r\n      return drawCircle(p, element.width, element.height,  attrs);\r\n    },\r\n    'bpmn:StartEvent': function(p, element) {\r\n      var attrs = {};\r\n      var semantic = getSemantic(element);\r\n\r\n      if (!semantic.isInterrupting) {\r\n        attrs = {\r\n          strokeDasharray: '6',\r\n          strokeLinecap: 'round'\r\n        };\r\n      }\r\n\r\n      var circle = renderer('bpmn:Event')(p, element, attrs);\r\n\r\n      renderEventContent(element, p);\r\n\r\n      return circle;\r\n    },\r\n    'bpmn:MessageEventDefinition': function(p, element, isThrowing) {\r\n      var pathData = pathMap.getScaledPath('EVENT_MESSAGE', {\r\n        xScaleFactor: 0.9,\r\n        yScaleFactor: 0.9,\r\n        containerWidth: element.width,\r\n        containerHeight: element.height,\r\n        position: {\r\n          mx: 0.235,\r\n          my: 0.315\r\n        }\r\n      });\r\n\r\n      var fill = isThrowing ? 'black' : 'none';\r\n      var stroke = isThrowing ? 'white' : 'black';\r\n\r\n      var messagePath = drawPath(p, pathData, {\r\n        strokeWidth: 1,\r\n        fill: fill,\r\n        stroke: stroke\r\n      });\r\n\r\n      return messagePath;\r\n    },\r\n    'bpmn:TimerEventDefinition': function(p, element) {\r\n\r\n      var circle = drawCircle(p, element.width, element.height, 0.2 * element.height, {\r\n        strokeWidth: 2\r\n      });\r\n\r\n      var pathData = pathMap.getScaledPath('EVENT_TIMER_WH', {\r\n        xScaleFactor: 0.75,\r\n        yScaleFactor: 0.75,\r\n        containerWidth: element.width,\r\n        containerHeight: element.height,\r\n        position: {\r\n          mx: 0.5,\r\n          my: 0.5\r\n        }\r\n      });\r\n\r\n      var path = drawPath(p, pathData, {\r\n        strokeWidth: 2\r\n      });\r\n\r\n      return circle;\r\n    },\r\n    'bpmn:EscalationEventDefinition': function(p, event, isThrowing) {\r\n      var pathData = pathMap.getScaledPath('EVENT_ESCALATION', {\r\n        xScaleFactor: 1,\r\n        yScaleFactor: 1,\r\n        containerWidth: event.width,\r\n        containerHeight: event.height,\r\n        position: {\r\n          mx: 0.5,\r\n          my: 0.555\r\n        }\r\n      });\r\n\r\n      var fill = isThrowing ? 'black' : 'none';\r\n\r\n      return drawPath(p, pathData, {\r\n        strokeWidth: 1,\r\n        fill: fill\r\n      });\r\n    },\r\n    'bpmn:ConditionalEventDefinition': function(p, event) {\r\n      var pathData = pathMap.getScaledPath('EVENT_CONDITIONAL', {\r\n        xScaleFactor: 1,\r\n        yScaleFactor: 1,\r\n        containerWidth: event.width,\r\n        containerHeight: event.height,\r\n        position: {\r\n          mx: 0.5,\r\n          my: 0.222\r\n        }\r\n      });\r\n\r\n      return drawPath(p, pathData, {\r\n        strokeWidth: 1\r\n      });\r\n    },\r\n    'bpmn:LinkEventDefinition': function(p, event) {\r\n      var pathData = pathMap.getScaledPath('EVENT_LINK', {\r\n        xScaleFactor: 1,\r\n        yScaleFactor: 1,\r\n        containerWidth: event.width,\r\n        containerHeight: event.height,\r\n        position: {\r\n          mx: 0.57,\r\n          my: 0.263\r\n        }\r\n      });\r\n\r\n      return drawPath(p, pathData, {\r\n        strokeWidth: 1\r\n      });\r\n    },\r\n    'bpmn:ErrorEventDefinition': function(p, event, isThrowing) {\r\n      var pathData = pathMap.getScaledPath('EVENT_ERROR', {\r\n        xScaleFactor: 1.1,\r\n        yScaleFactor: 1.1,\r\n        containerWidth: event.width,\r\n        containerHeight: event.height,\r\n        position: {\r\n          mx: 0.2,\r\n          my: 0.722\r\n        }\r\n      });\r\n\r\n      var fill = isThrowing ? 'black' : 'none';\r\n\r\n      return drawPath(p, pathData, {\r\n        strokeWidth: 1,\r\n        fill: fill\r\n      });\r\n    },\r\n    'bpmn:CancelEventDefinition': function(p, event, isThrowing) {\r\n      var pathData = pathMap.getScaledPath('EVENT_CANCEL_45', {\r\n        xScaleFactor: 1.0,\r\n        yScaleFactor: 1.0,\r\n        containerWidth: event.width,\r\n        containerHeight: event.height,\r\n        position: {\r\n          mx: 0.638,\r\n          my: -0.055\r\n        }\r\n      });\r\n\r\n      var fill = isThrowing ? 'black' : 'none';\r\n\r\n      return drawPath(p, pathData, {\r\n        strokeWidth: 1,\r\n        fill: fill\r\n      }).transform('rotate(45)');\r\n    },\r\n    'bpmn:CompensateEventDefinition': function(p, event, isThrowing) {\r\n      var pathData = pathMap.getScaledPath('EVENT_COMPENSATION', {\r\n        xScaleFactor: 1,\r\n        yScaleFactor: 1,\r\n        containerWidth: event.width,\r\n        containerHeight: event.height,\r\n        position: {\r\n          mx: 0.201,\r\n          my: 0.472\r\n        }\r\n      });\r\n\r\n      var fill = isThrowing ? 'black' : 'none';\r\n\r\n      return drawPath(p, pathData, {\r\n        strokeWidth: 1,\r\n        fill: fill\r\n      });\r\n    },\r\n    'bpmn:SignalEventDefinition': function(p, event, isThrowing) {\r\n      var pathData = pathMap.getScaledPath('EVENT_SIGNAL', {\r\n        xScaleFactor: 0.9,\r\n        yScaleFactor: 0.9,\r\n        containerWidth: event.width,\r\n        containerHeight: event.height,\r\n        position: {\r\n          mx: 0.5,\r\n          my: 0.2\r\n        }\r\n      });\r\n\r\n      var fill = isThrowing ? 'black' : 'none';\r\n\r\n      return drawPath(p, pathData, {\r\n        strokeWidth: 1,\r\n        fill: fill\r\n      });\r\n    },\r\n    'bpmn:MultipleEventDefinition': function(p, event, isThrowing) {\r\n      var pathData = pathMap.getScaledPath('EVENT_MULTIPLE', {\r\n        xScaleFactor: 1.1,\r\n        yScaleFactor: 1.1,\r\n        containerWidth: event.width,\r\n        containerHeight: event.height,\r\n        position: {\r\n          mx: 0.222,\r\n          my: 0.36\r\n        }\r\n      });\r\n\r\n      var fill = isThrowing ? 'black' : 'none';\r\n\r\n      return drawPath(p, pathData, {\r\n        strokeWidth: 1,\r\n        fill: fill\r\n      });\r\n    },\r\n    'bpmn:ParallelMultipleEventDefinition': function(p, event) {\r\n      var pathData = pathMap.getScaledPath('EVENT_PARALLEL_MULTIPLE', {\r\n        xScaleFactor: 1.2,\r\n        yScaleFactor: 1.2,\r\n        containerWidth: event.width,\r\n        containerHeight: event.height,\r\n        position: {\r\n          mx: 0.458,\r\n          my: 0.194\r\n        }\r\n      });\r\n\r\n      return drawPath(p, pathData, {\r\n        strokeWidth: 1\r\n      });\r\n    },\r\n    'bpmn:EndEvent': function(p, element) {\r\n      var circle = renderer('bpmn:Event')(p, element, {\r\n        strokeWidth: 4\r\n      });\r\n\r\n      renderEventContent(element, p, true);\r\n\r\n      return circle;\r\n    },\r\n    'bpmn:TerminateEventDefinition': function(p, element) {\r\n      var circle = drawCircle(p, element.width, element.height, 8, {\r\n        strokeWidth: 4,\r\n        fill: 'black'\r\n      });\r\n\r\n      return circle;\r\n    },\r\n    'bpmn:IntermediateEvent': function(p, element) {\r\n      var outer = renderer('bpmn:Event')(p, element, { strokeWidth: 1 });\r\n      var inner = drawCircle(p, element.width, element.height, INNER_OUTER_DIST, { strokeWidth: 1 });\r\n\r\n      renderEventContent(element, p);\r\n\r\n      return outer;\r\n    },\r\n    'bpmn:IntermediateCatchEvent': as('bpmn:IntermediateEvent'),\r\n    'bpmn:IntermediateThrowEvent': as('bpmn:IntermediateEvent'),\r\n\r\n    'bpmn:Activity': function(p, element, attrs) {\r\n      return drawRect(p, element.width, element.height, TASK_BORDER_RADIUS, attrs);\r\n    },\r\n\r\n    'bpmn:Task': function(p, element) {\r\n      var rect = renderer('bpmn:Activity')(p, element);\r\n      renderEmbeddedLabel(p, element, 'center-middle');\r\n      attachTaskMarkers(p, element);\r\n      return rect;\r\n    },\r\n    'bpmn:ServiceTask': function(p, element) {\r\n      var task = renderer('bpmn:Task')(p, element);\r\n\r\n      var pathDataBG = pathMap.getScaledPath('TASK_TYPE_SERVICE', {\r\n        abspos: {\r\n          x: 12,\r\n          y: 18\r\n        }\r\n      });\r\n\r\n      var servicePathBG = drawPath(p, pathDataBG, {\r\n        strokeWidth: 1,\r\n        fill: 'none'\r\n      });\r\n\r\n      var fillPathData = pathMap.getScaledPath('TASK_TYPE_SERVICE_FILL', {\r\n        abspos: {\r\n          x: 17.2,\r\n          y: 18\r\n        }\r\n      });\r\n\r\n      var serviceFillPath = drawPath(p, fillPathData, {\r\n        strokeWidth: 0,\r\n        stroke: 'none',\r\n        fill: 'white'\r\n      });\r\n\r\n      var pathData = pathMap.getScaledPath('TASK_TYPE_SERVICE', {\r\n        abspos: {\r\n          x: 17,\r\n          y: 22\r\n        }\r\n      });\r\n\r\n      var servicePath = drawPath(p, pathData, {\r\n        strokeWidth: 1,\r\n        fill: 'white'\r\n      });\r\n\r\n      return task;\r\n    },\r\n    'bpmn:UserTask': function(p, element) {\r\n      var task = renderer('bpmn:Task')(p, element);\r\n\r\n      var x = 15;\r\n      var y = 12;\r\n\r\n      var pathData = pathMap.getScaledPath('TASK_TYPE_USER_1', {\r\n        abspos: {\r\n          x: x,\r\n          y: y\r\n        }\r\n      });\r\n\r\n      var userPath = drawPath(p, pathData, {\r\n        strokeWidth: 0.5,\r\n        fill: 'none'\r\n      });\r\n\r\n      var pathData2 = pathMap.getScaledPath('TASK_TYPE_USER_2', {\r\n        abspos: {\r\n          x: x,\r\n          y: y\r\n        }\r\n      });\r\n\r\n      var userPath2 = drawPath(p, pathData2, {\r\n        strokeWidth: 0.5,\r\n        fill: 'none'\r\n      });\r\n\r\n      var pathData3 = pathMap.getScaledPath('TASK_TYPE_USER_3', {\r\n        abspos: {\r\n          x: x,\r\n          y: y\r\n        }\r\n      });\r\n\r\n      var userPath3 = drawPath(p, pathData3, {\r\n        strokeWidth: 0.5,\r\n        fill: 'black'\r\n      });\r\n\r\n      return task;\r\n    },\r\n    'bpmn:ManualTask': function(p, element) {\r\n      var task = renderer('bpmn:Task')(p, element);\r\n\r\n      var pathData = pathMap.getScaledPath('TASK_TYPE_MANUAL', {\r\n        abspos: {\r\n          x: 17,\r\n          y: 15\r\n        }\r\n      });\r\n\r\n      var userPath = drawPath(p, pathData, {\r\n        strokeWidth: 0.25,\r\n        fill: 'none',\r\n        stroke: 'black'\r\n      });\r\n\r\n      return task;\r\n    },\r\n    'bpmn:SendTask': function(p, element) {\r\n      var task = renderer('bpmn:Task')(p, element);\r\n\r\n      var pathData = pathMap.getScaledPath('TASK_TYPE_SEND', {\r\n        xScaleFactor: 1,\r\n        yScaleFactor: 1,\r\n        containerWidth: 21,\r\n        containerHeight: 14,\r\n        position: {\r\n          mx: 0.285,\r\n          my: 0.357\r\n        }\r\n      });\r\n\r\n      var sendPath = drawPath(p, pathData, {\r\n        strokeWidth: 1,\r\n        fill: 'black',\r\n        stroke: 'white'\r\n      });\r\n\r\n      return task;\r\n    },\r\n    'bpmn:ReceiveTask' : function(p, element) {\r\n      var semantic = getSemantic(element);\r\n\r\n      var task = renderer('bpmn:Task')(p, element);\r\n      var pathData;\r\n\r\n      if (semantic.instantiate) {\r\n        drawCircle(p, 28, 28, 20 * 0.22, { strokeWidth: 1 });\r\n\r\n        pathData = pathMap.getScaledPath('TASK_TYPE_INSTANTIATING_SEND', {\r\n          abspos: {\r\n            x: 7.77,\r\n            y: 9.52\r\n          }\r\n        });\r\n      } else {\r\n\r\n        pathData = pathMap.getScaledPath('TASK_TYPE_SEND', {\r\n          xScaleFactor: 0.9,\r\n          yScaleFactor: 0.9,\r\n          containerWidth: 21,\r\n          containerHeight: 14,\r\n          position: {\r\n            mx: 0.3,\r\n            my: 0.4\r\n          }\r\n        });\r\n      }\r\n\r\n      var sendPath = drawPath(p, pathData, {\r\n        strokeWidth: 1\r\n      });\r\n\r\n      return task;\r\n    },\r\n    'bpmn:ScriptTask': function(p, element) {\r\n      var task = renderer('bpmn:Task')(p, element);\r\n\r\n      var pathData = pathMap.getScaledPath('TASK_TYPE_SCRIPT', {\r\n        abspos: {\r\n          x: 15,\r\n          y: 20\r\n        }\r\n      });\r\n\r\n      var scriptPath = drawPath(p, pathData, {\r\n        strokeWidth: 1\r\n      });\r\n\r\n      return task;\r\n    },\r\n    'bpmn:BusinessRuleTask': function(p, element) {\r\n      var task = renderer('bpmn:Task')(p, element);\r\n\r\n      var headerPathData = pathMap.getScaledPath('TASK_TYPE_BUSINESS_RULE_HEADER', {\r\n        abspos: {\r\n          x: 8,\r\n          y: 8\r\n        }\r\n      });\r\n\r\n      var businessHeaderPath = drawPath(p, headerPathData);\r\n      businessHeaderPath.attr({\r\n        strokeWidth: 1,\r\n        fill: 'AAA'\r\n      });\r\n\r\n      var headerData = pathMap.getScaledPath('TASK_TYPE_BUSINESS_RULE_MAIN', {\r\n        abspos: {\r\n          x: 8,\r\n          y: 8\r\n        }\r\n      });\r\n\r\n      var businessPath = drawPath(p, headerData);\r\n      businessPath.attr({\r\n        strokeWidth: 1\r\n      });\r\n\r\n      return task;\r\n    },\r\n    'bpmn:SubProcess': function(p, element, attrs) {\r\n      var rect = renderer('bpmn:Activity')(p, element, attrs);\r\n\r\n      var semantic = getSemantic(element),\r\n          di = getDi(element);\r\n\r\n      var expanded = DiUtil.isExpanded(semantic);\r\n\r\n      var isEventSubProcess = !!getSemantic(element).triggeredByEvent;\r\n      if (isEventSubProcess) {\r\n        rect.attr({\r\n          strokeDasharray: '1,2'\r\n        });\r\n      }\r\n\r\n      renderEmbeddedLabel(p, element, expanded ? 'center-top' : 'center-middle');\r\n\r\n      if (expanded) {\r\n        attachTaskMarkers(p, element);\r\n      } else {\r\n        attachTaskMarkers(p, element, ['SubProcessMarker']);\r\n      }\r\n\r\n      return rect;\r\n    },\r\n    'bpmn:AdHocSubProcess': function(p, element) {\r\n      return renderer('bpmn:SubProcess')(p, element);\r\n    },\r\n    'bpmn:Transaction': function(p, element) {\r\n      var outer = renderer('bpmn:SubProcess')(p, element);\r\n\r\n      var innerAttrs = styles.style([ 'no-fill', 'no-events' ]);\r\n      var inner = drawRect(p, element.width, element.height, TASK_BORDER_RADIUS - 2, INNER_OUTER_DIST, innerAttrs);\r\n\r\n      return outer;\r\n    },\r\n    'bpmn:CallActivity': function(p, element) {\r\n      return renderer('bpmn:SubProcess')(p, element, {\r\n        strokeWidth: 5\r\n      });\r\n    },\r\n    'bpmn:Participant': function(p, element) {\r\n\r\n      var lane = renderer('bpmn:Lane')(p, element);\r\n\r\n      var expandedPool = DiUtil.isExpandedPool(getSemantic(element));\r\n\r\n      if (expandedPool) {\r\n        drawLine(p, [\r\n          {x: 30, y: 0},\r\n          {x: 30, y: element.height}\r\n        ]);\r\n        var text = getSemantic(element).name;\r\n        renderLaneLabel(p, text, element);\r\n      } else {\r\n        // Collapsed pool draw text inline\r\n        var text2 = getSemantic(element).name;\r\n        renderLabel(p, text2, { box: element, align: 'center-middle' });\r\n      }\r\n\r\n      var participantMultiplicity = !!(getSemantic(element).participantMultiplicity);\r\n\r\n      if(participantMultiplicity) {\r\n        renderer('ParticipantMultiplicityMarker')(p, element);\r\n      }\r\n\r\n      return lane;\r\n    },\r\n    'bpmn:Lane': function(p, element) {\r\n      var rect = drawRect(p, element.width, element.height, 0, {\r\n        fill: 'none'\r\n      });\r\n\r\n      var semantic = getSemantic(element);\r\n\r\n      if (semantic.$type === 'bpmn:Lane') {\r\n        var text = semantic.name;\r\n        renderLaneLabel(p, text, element);\r\n      }\r\n\r\n      return rect;\r\n    },\r\n    'bpmn:InclusiveGateway': function(p, element) {\r\n      var diamond = drawDiamond(p, element.width, element.height);\r\n\r\n      var circle = drawCircle(p, element.width, element.height, element.height * 0.24, {\r\n        strokeWidth: 2.5,\r\n        fill: 'none'\r\n      });\r\n\r\n      return diamond;\r\n    },\r\n    'bpmn:ExclusiveGateway': function(p, element) {\r\n      var diamond = drawDiamond(p, element.width, element.height);\r\n\r\n      var pathData = pathMap.getScaledPath('GATEWAY_EXCLUSIVE', {\r\n        xScaleFactor: 0.4,\r\n        yScaleFactor: 0.4,\r\n        containerWidth: element.width,\r\n        containerHeight: element.height,\r\n        position: {\r\n          mx: 0.32,\r\n          my: 0.3\r\n        }\r\n      });\r\n\r\n      if (!!(getDi(element).isMarkerVisible)) {\r\n        drawPath(p, pathData, {\r\n          strokeWidth: 1,\r\n          fill: 'black'\r\n        });\r\n      }\r\n\r\n      return diamond;\r\n    },\r\n    'bpmn:ComplexGateway': function(p, element) {\r\n      var diamond = drawDiamond(p, element.width, element.height);\r\n\r\n      var pathData = pathMap.getScaledPath('GATEWAY_COMPLEX', {\r\n        xScaleFactor: 0.5,\r\n        yScaleFactor:0.5,\r\n        containerWidth: element.width,\r\n        containerHeight: element.height,\r\n        position: {\r\n          mx: 0.46,\r\n          my: 0.26\r\n        }\r\n      });\r\n\r\n      var complexPath = drawPath(p, pathData, {\r\n        strokeWidth: 1,\r\n        fill: 'black'\r\n      });\r\n\r\n      return diamond;\r\n    },\r\n    'bpmn:ParallelGateway': function(p, element) {\r\n      var diamond = drawDiamond(p, element.width, element.height);\r\n\r\n      var pathData = pathMap.getScaledPath('GATEWAY_PARALLEL', {\r\n        xScaleFactor: 0.6,\r\n        yScaleFactor:0.6,\r\n        containerWidth: element.width,\r\n        containerHeight: element.height,\r\n        position: {\r\n          mx: 0.46,\r\n          my: 0.2\r\n        }\r\n      });\r\n\r\n      var parallelPath = drawPath(p, pathData, {\r\n        strokeWidth: 1,\r\n        fill: 'black'\r\n      });\r\n\r\n      return diamond;\r\n    },\r\n    'bpmn:EventBasedGateway': function(p, element) {\r\n\r\n      var semantic = getSemantic(element);\r\n\r\n      var diamond = drawDiamond(p, element.width, element.height);\r\n\r\n      var outerCircle = drawCircle(p, element.width, element.height, element.height * 0.20, {\r\n        strokeWidth: 1,\r\n        fill: 'none'\r\n      });\r\n\r\n      var type = semantic.eventGatewayType;\r\n      var instantiate = !!semantic.instantiate;\r\n\r\n      function drawEvent() {\r\n\r\n        var pathData = pathMap.getScaledPath('GATEWAY_EVENT_BASED', {\r\n          xScaleFactor: 0.18,\r\n          yScaleFactor: 0.18,\r\n          containerWidth: element.width,\r\n          containerHeight: element.height,\r\n          position: {\r\n            mx: 0.36,\r\n            my: 0.44\r\n          }\r\n        });\r\n\r\n        var eventPath = drawPath(p, pathData, {\r\n          strokeWidth: 2,\r\n          fill: 'none'\r\n        });\r\n      }\r\n\r\n      if (type === 'Parallel') {\r\n\r\n        var pathData = pathMap.getScaledPath('GATEWAY_PARALLEL', {\r\n          xScaleFactor: 0.4,\r\n          yScaleFactor:0.4,\r\n          containerWidth: element.width,\r\n          containerHeight: element.height,\r\n          position: {\r\n            mx: 0.474,\r\n            my: 0.296\r\n          }\r\n        });\r\n\r\n        var parallelPath = drawPath(p, pathData);\r\n        parallelPath.attr({\r\n          strokeWidth: 1,\r\n          fill: 'none'\r\n        });\r\n      } else if (type === 'Exclusive') {\r\n\r\n        if (!instantiate) {\r\n          var innerCircle = drawCircle(p, element.width, element.height, element.height * 0.26);\r\n          innerCircle.attr({\r\n            strokeWidth: 1,\r\n            fill: 'none'\r\n          });\r\n        }\r\n\r\n        drawEvent();\r\n      }\r\n\r\n\r\n      return diamond;\r\n    },\r\n    'bpmn:Gateway': function(p, element) {\r\n      return drawDiamond(p, element.width, element.height);\r\n    },\r\n    'bpmn:SequenceFlow': function(p, element) {\r\n      var pathData = createPathFromConnection(element);\r\n      var path = drawPath(p, pathData, {\r\n        markerEnd: marker('sequenceflow-end')\r\n      });\r\n\r\n      var sequenceFlow = getSemantic(element);\r\n      var source = element.source.businessObject;\r\n\r\n      // conditional flow marker\r\n      if (sequenceFlow.conditionExpression && source.$instanceOf('bpmn:Task')) {\r\n        path.attr({\r\n          markerStart: marker('conditional-flow-marker')\r\n        });\r\n      }\r\n\r\n      // default marker\r\n      if (source.default && source.$instanceOf('bpmn:Gateway') && source.default === sequenceFlow) {\r\n        path.attr({\r\n          markerStart: marker('conditional-default-flow-marker')\r\n        });\r\n      }\r\n\r\n      return path;\r\n    },\r\n    'bpmn:Association': function(p, element, attrs) {\r\n\r\n      attrs = _.extend({\r\n        strokeDasharray: '1,6',\r\n        strokeLinecap: 'round'\r\n      }, attrs || {});\r\n\r\n      // TODO(nre): style according to directed state\r\n      return drawLine(p, element.waypoints, attrs);\r\n    },\r\n    'bpmn:DataInputAssociation': function(p, element) {\r\n      return renderer('bpmn:Association')(p, element, {\r\n        markerEnd: marker('data-association-end')\r\n      });\r\n    },\r\n    'bpmn:DataOutputAssociation': function(p, element) {\r\n      return renderer('bpmn:Association')(p, element, {\r\n        markerEnd: marker('data-association-end')\r\n      });\r\n    },\r\n    'bpmn:MessageFlow': function(p, element) {\r\n\r\n      var di = getDi(element);\r\n\r\n      var pathData = createPathFromConnection(element);\r\n      var path = drawPath(p, pathData, {\r\n        markerEnd: marker('messageflow-end'),\r\n        markerStart: marker('messageflow-start'),\r\n        strokeDasharray: '10',\r\n        strokeLinecap: 'round',\r\n        strokeWidth: 1\r\n      });\r\n\r\n      if (!!di.messageVisibleKind) {\r\n        var midPoint = path.getPointAtLength(path.getTotalLength() / 2);\r\n\r\n        var markerPathData = pathMap.getScaledPath('MESSAGE_FLOW_MARKER', {\r\n          abspos: {\r\n            x: midPoint.x,\r\n            y: midPoint.y\r\n          }\r\n        });\r\n\r\n        var messageAttrs = { strokeWidth: 1 };\r\n\r\n        if (di.messageVisibleKind === 'initiating') {\r\n          messageAttrs.fill = 'white';\r\n          messageAttrs.stroke = 'black';\r\n        } else {\r\n          messageAttrs.fill = '#888';\r\n          messageAttrs.stroke = 'white';\r\n        }\r\n\r\n        drawPath(p, markerPathData, messageAttrs);\r\n      }\r\n\r\n      return path;\r\n    },\r\n    'bpmn:DataObject': function(p, element) {\r\n      var pathData = pathMap.getScaledPath('DATA_OBJECT_PATH', {\r\n        xScaleFactor: 1,\r\n        yScaleFactor: 1,\r\n        containerWidth: element.width,\r\n        containerHeight: element.height,\r\n        position: {\r\n          mx: 0.474,\r\n          my: 0.296\r\n        }\r\n      });\r\n\r\n      var elementObject = drawPath(p, pathData, { fill: 'white' });\r\n\r\n      var semantic = getSemantic(element);\r\n\r\n      if (isCollection(semantic)) {\r\n        renderDataItemCollection(p, element);\r\n      }\r\n\r\n      return elementObject;\r\n    },\r\n    'bpmn:DataObjectReference': as('bpmn:DataObject'),\r\n    'bpmn:DataInput': function(p, element) {\r\n\r\n      var arrowPathData = pathMap.getRawPath('DATA_ARROW');\r\n\r\n      // page\r\n      var elementObject = renderer('bpmn:DataObject')(p, element);\r\n\r\n      // arrow\r\n      var elementInput = drawPath(p, arrowPathData, { strokeWidth: 1 });\r\n\r\n      return elementObject;\r\n    },\r\n    'bpmn:DataOutput': function(p, element) {\r\n      var arrowPathData = pathMap.getRawPath('DATA_ARROW');\r\n\r\n      // page\r\n      var elementObject = renderer('bpmn:DataObject')(p, element);\r\n\r\n      // arrow\r\n      var elementInput = drawPath(p, arrowPathData, {\r\n        strokeWidth: 1,\r\n        fill: 'black'\r\n      });\r\n\r\n      return elementObject;\r\n    },\r\n    'bpmn:DataStoreReference': function(p, element) {\r\n      var DATA_STORE_PATH = pathMap.getScaledPath('DATA_STORE', {\r\n        xScaleFactor: 1,\r\n        yScaleFactor: 1,\r\n        containerWidth: element.width,\r\n        containerHeight: element.height,\r\n        position: {\r\n          mx: 0,\r\n          my: 0.133\r\n        }\r\n      });\r\n\r\n      var elementStore = drawPath(p, DATA_STORE_PATH, {\r\n        strokeWidth: 2,\r\n        fill: 'white'\r\n      });\r\n\r\n      return elementStore;\r\n    },\r\n    'bpmn:BoundaryEvent': function(p, element) {\r\n\r\n      var semantic = getSemantic(element),\r\n          cancel = semantic.cancelActivity;\r\n\r\n      var attrs = {\r\n        strokeLinecap: 'round',\r\n        strokeWidth: 1\r\n      };\r\n\r\n      if (!cancel) {\r\n        attrs.strokeDasharray = '6';\r\n      }\r\n\r\n      var outer = renderer('bpmn:Event')(p, element, attrs);\r\n      var inner = drawCircle(p, element.width, element.height, INNER_OUTER_DIST, attrs);\r\n\r\n      renderEventContent(element, p);\r\n\r\n      return outer;\r\n    },\r\n    'bpmn:Group': function(p, element) {\r\n      return drawRect(p, element.width, element.height, TASK_BORDER_RADIUS, {\r\n        strokeWidth: 1,\r\n        strokeDasharray: '8,3,1,3',\r\n        fill: 'none',\r\n        pointerEvents: 'none'\r\n      });\r\n    },\r\n    'label': function(p, element) {\r\n      return renderExternalLabel(p, element, '');\r\n    },\r\n    'bpmn:TextAnnotation': function(p, element) {\r\n      var style = {\r\n        'fill': 'none',\r\n        'stroke': 'none'\r\n      };\r\n      var textElement = drawRect(p, element.width, element.width, 0, 0, style);\r\n      var textPathData = pathMap.getScaledPath('TEXT_ANNOTATION', {\r\n        xScaleFactor: 1,\r\n        yScaleFactor: 1,\r\n        containerWidth: element.width,\r\n        containerHeight: element.height,\r\n        position: {\r\n          mx: 0.0,\r\n          my: 0.0\r\n        }\r\n      });\r\n      drawPath(p, textPathData);\r\n\r\n      var text = getSemantic(element).text || '';\r\n      renderLabel(p, text, { box: element, align: 'left-middle' });\r\n\r\n      return textElement;\r\n    },\r\n    'ParticipantMultiplicityMarker': function(p, element) {\r\n      var subProcessPath = pathMap.getScaledPath('MARKER_PARALLEL', {\r\n        xScaleFactor: 1,\r\n        yScaleFactor: 1,\r\n        containerWidth: element.width,\r\n        containerHeight: element.height,\r\n        position: {\r\n          mx: ((element.width / 2) / element.width),\r\n          my: (element.height - 15) / element.height\r\n        }\r\n      });\r\n\r\n      drawPath(p, subProcessPath);\r\n    },\r\n    'SubProcessMarker': function(p, element) {\r\n      var markerRect = drawRect(p, 14, 14, 0, {\r\n        strokeWidth: 1\r\n      });\r\n\r\n      // Process marker is placed in the middle of the box\r\n      // therefore fixed values can be used here\r\n      markerRect.transform('translate(' + (element.width / 2 - 7.5) + ',' + (element.height - 20) + ')');\r\n\r\n      var subProcessPath = pathMap.getScaledPath('MARKER_SUB_PROCESS', {\r\n        xScaleFactor: 1.5,\r\n        yScaleFactor: 1.5,\r\n        containerWidth: element.width,\r\n        containerHeight: element.height,\r\n        position: {\r\n          mx: (element.width / 2 - 7.5) / element.width,\r\n          my: (element.height - 20) / element.height\r\n        }\r\n      });\r\n\r\n      drawPath(p, subProcessPath);\r\n    },\r\n    'ParallelMarker': function(p, element, position) {\r\n      var subProcessPath = pathMap.getScaledPath('MARKER_PARALLEL', {\r\n        xScaleFactor: 1,\r\n        yScaleFactor: 1,\r\n        containerWidth: element.width,\r\n        containerHeight: element.height,\r\n        position: {\r\n          mx: ((element.width / 2 + position.parallel) / element.width),\r\n          my: (element.height - 20) / element.height\r\n        }\r\n      });\r\n      drawPath(p, subProcessPath);\r\n    },\r\n    'SequentialMarker': function(p, element, position) {\r\n      var sequentialPath = pathMap.getScaledPath('MARKER_SEQUENTIAL', {\r\n        xScaleFactor: 1,\r\n        yScaleFactor: 1,\r\n        containerWidth: element.width,\r\n        containerHeight: element.height,\r\n        position: {\r\n          mx: ((element.width / 2 + position.seq) / element.width),\r\n          my: (element.height - 19) / element.height\r\n        }\r\n      });\r\n      drawPath(p, sequentialPath);\r\n    },\r\n    'CompensationMarker': function(p, element, position) {\r\n      var compensationPath = pathMap.getScaledPath('MARKER_COMPENSATION', {\r\n        xScaleFactor: 1,\r\n        yScaleFactor: 1,\r\n        containerWidth: element.width,\r\n        containerHeight: element.height,\r\n        position: {\r\n          mx: ((element.width / 2 + position.compensation) / element.width),\r\n          my: (element.height - 13) / element.height\r\n        }\r\n      });\r\n      drawPath(p, compensationPath, { strokeWidth: 1 });\r\n    },\r\n    'LoopMarker': function(p, element, position) {\r\n      var loopPath = pathMap.getScaledPath('MARKER_LOOP', {\r\n        xScaleFactor: 1,\r\n        yScaleFactor: 1,\r\n        containerWidth: element.width,\r\n        containerHeight: element.height,\r\n        position: {\r\n          mx: ((element.width / 2 + position.loop) / element.width),\r\n          my: (element.height - 7) / element.height\r\n        }\r\n      });\r\n\r\n      drawPath(p, loopPath, {\r\n        strokeWidth: 1,\r\n        fill: 'none',\r\n        strokeLinecap: 'round',\r\n        strokeMiterlimit: 0.5\r\n      });\r\n    },\r\n    'AdhocMarker': function(p, element, position) {\r\n      var loopPath = pathMap.getScaledPath('MARKER_ADHOC', {\r\n        xScaleFactor: 1,\r\n        yScaleFactor: 1,\r\n        containerWidth: element.width,\r\n        containerHeight: element.height,\r\n        position: {\r\n          mx: ((element.width / 2 + position.adhoc) / element.width),\r\n          my: (element.height - 15) / element.height\r\n        }\r\n      });\r\n\r\n      drawPath(p, loopPath, {\r\n        strokeWidth: 1,\r\n        fill: 'black'\r\n      });\r\n    }\r\n  };\r\n\r\n  function attachTaskMarkers(p, element, taskMarkers) {\r\n    var obj = getSemantic(element);\r\n\r\n    var subprocess = _.contains(taskMarkers, 'SubProcessMarker');\r\n    var position;\r\n\r\n    if (subprocess) {\r\n      position = {\r\n        seq: -21,\r\n        parallel: -22,\r\n        compensation: -42,\r\n        loop: -18,\r\n        adhoc: 10\r\n      };\r\n    } else {\r\n      position = {\r\n        seq: -3,\r\n        parallel: -6,\r\n        compensation: -27,\r\n        loop: 0,\r\n        adhoc: 10\r\n      };\r\n    }\r\n\r\n    _.forEach(taskMarkers, function(marker) {\r\n      renderer(marker)(p, element, position);\r\n    });\r\n\r\n    if (obj.$type === 'bpmn:AdHocSubProcess') {\r\n      renderer('AdhocMarker')(p, element, position);\r\n    }\r\n    if (obj.loopCharacteristics && obj.loopCharacteristics.isSequential === undefined) {\r\n      renderer('LoopMarker')(p, element, position);\r\n      return;\r\n    }\r\n    if (obj.loopCharacteristics &&\r\n      obj.loopCharacteristics.isSequential !== undefined &&\r\n      !obj.loopCharacteristics.isSequential) {\r\n      renderer('ParallelMarker')(p, element, position);\r\n    }\r\n    if (obj.loopCharacteristics && !!obj.loopCharacteristics.isSequential) {\r\n      renderer('SequentialMarker')(p, element, position);\r\n    }\r\n    if (!!obj.isForCompensation) {\r\n      renderer('CompensationMarker')(p, element, position);\r\n    }\r\n  }\r\n\r\n  function drawShape(parent, element) {\r\n    var type = element.type;\r\n    var h = handlers[type];\r\n\r\n    /* jshint -W040 */\r\n    if (!h) {\r\n      return DefaultRenderer.prototype.drawShape.apply(this, [ parent, element ]);\r\n    } else {\r\n      return h(parent, element);\r\n    }\r\n  }\r\n\r\n  function drawConnection(parent, element) {\r\n    var type = element.type;\r\n    var h = handlers[type];\r\n\r\n    /* jshint -W040 */\r\n    if (!h) {\r\n      return DefaultRenderer.prototype.drawConnection.apply(this, [ parent, element ]);\r\n    } else {\r\n      return h(parent, element);\r\n    }\r\n  }\r\n\r\n  function renderDataItemCollection(p, element) {\r\n\r\n    var yPosition = (element.height - 16) / element.height;\r\n\r\n    var pathData = pathMap.getScaledPath('DATA_OBJECT_COLLECTION_PATH', {\r\n      xScaleFactor: 1,\r\n      yScaleFactor: 1,\r\n      containerWidth: element.width,\r\n      containerHeight: element.height,\r\n      position: {\r\n        mx: 0.451,\r\n        my: yPosition\r\n      }\r\n    });\r\n\r\n    var collectionPath = drawPath(p, pathData, {\r\n      strokeWidth: 2\r\n    });\r\n  }\r\n\r\n  function isCollection(element, filter) {\r\n    return element.isCollection ||\r\n           (element.elementObjectRef && element.elementObjectRef.isCollection);\r\n  }\r\n\r\n  function getDi(element) {\r\n    return element.businessObject.di;\r\n  }\r\n\r\n  function getSemantic(element) {\r\n    return element.businessObject;\r\n  }\r\n\r\n  /**\r\n   * Checks if eventDefinition of the given element matches with semantic type.\r\n   *\r\n   * @return {boolean} true if element is of the given semantic type\r\n   */\r\n  function isTypedEvent(event, eventDefinitionType, filter) {\r\n\r\n    function matches(definition, filter) {\r\n      return _.all(filter, function(val, key) {\r\n\r\n        // we want a == conversion here, to be able to catch\r\n        // undefined == false and friends\r\n        /* jshint -W116 */\r\n        return definition[key] == val;\r\n      });\r\n    }\r\n\r\n    return _.any(event.eventDefinitions, function(definition) {\r\n      return definition.$type === eventDefinitionType && matches(event, filter);\r\n    });\r\n  }\r\n\r\n  function isThrowEvent(event) {\r\n    return (event.$type === 'bpmn:IntermediateThrowEvent') || (event.$type === 'bpmn:EndEvent');\r\n  }\r\n\r\n  // hook onto canvas init event to initialize\r\n  // connection start/end markers on paper\r\n  events.on('canvas.init', function(event) {\r\n    var paper = event.paper;\r\n\r\n    initMarkers(paper);\r\n  });\r\n\r\n  this.drawShape = drawShape;\r\n  this.drawConnection = drawConnection;\r\n}\r\n\r\nBpmnRenderer.prototype = Object.create(DefaultRenderer.prototype);\r\n\r\n\r\nBpmnRenderer.$inject = [ 'eventBus', 'styles', 'pathMap' ];\r\n\r\nmodule.exports = BpmnRenderer;\n},{\"../util/Di\":9,\"diagram-js/lib/draw/Renderer\":49,\"diagram-js/lib/util/LabelUtil\":67}],5:[function(_dereq_,module,exports){\n'use strict';\r\n\r\n/**\r\n * Map containing SVG paths needed by BpmnRenderer.\r\n */\r\n\r\nfunction PathMap(Snap) {\r\n\r\n  /**\r\n   * Contains a map of path elements\r\n   *\r\n   * <h1>Path definition</h1>\r\n   * A parameterized path is defined like this:\r\n   * <pre>\r\n   * 'GATEWAY_PARALLEL': {\r\n   *   d: 'm {mx},{my} {e.x0},0 0,{e.x1} {e.x1},0 0,{e.y0} -{e.x1},0 0,{e.y1} ' +\r\n          '-{e.x0},0 0,-{e.y1} -{e.x1},0 0,-{e.y0} {e.x1},0 z',\r\n   *   height: 17.5,\r\n   *   width:  17.5,\r\n   *   heightElements: [2.5, 7.5],\r\n   *   widthElements: [2.5, 7.5]\r\n   * }\r\n   * </pre>\r\n   * <p>It's important to specify a correct <b>height and width</b> for the path as the scaling\r\n   * is based on the ratio between the specified height and width in this object and the\r\n   * height and width that is set as scale target (Note x,y coordinates will be scaled with\r\n   * individual ratios).</p>\r\n   * <p>The '<b>heightElements</b>' and '<b>widthElements</b>' array must contain the values that will be scaled.\r\n   * The scaling is based on the computed ratios.\r\n   * Coordinates on the y axis should be in the <b>heightElement</b>'s array, they will be scaled using\r\n   * the computed ratio coefficient.\r\n   * In the parameterized path the scaled values can be accessed through the 'e' object in {} brackets.\r\n   *   <ul>\r\n   *    <li>The values for the y axis can be accessed in the path string using {e.y0}, {e.y1}, ....</li>\r\n   *    <li>The values for the x axis can be accessed in the path string using {e.x0}, {e.x1}, ....</li>\r\n   *   </ul>\r\n   *   The numbers x0, x1 respectively y0, y1, ... map to the corresponding array index.\r\n   * </p>\r\n   */\r\n  this.pathMap = {\r\n    'EVENT_MESSAGE': {\r\n      d: 'm {mx},{my} l 0,{e.y1} l {e.x1},0 l 0,-{e.y1} z l {e.x0},{e.y0} l {e.x0},-{e.y0}',\r\n      height: 36,\r\n      width:  36,\r\n      heightElements: [6, 14],\r\n      widthElements: [10.5, 21]\r\n    },\r\n    'EVENT_SIGNAL': {\r\n      d: 'M {mx},{my} l {e.x0},{e.y0} l -{e.x1},0 Z',\r\n      height: 36,\r\n      width: 36,\r\n      heightElements: [18],\r\n      widthElements: [10, 20]\r\n    },\r\n    'EVENT_ESCALATION': {\r\n      d: 'm {mx},{my} c -{e.x1},{e.y0} -{e.x3},{e.y1} -{e.x5},{e.y4} {e.x1},-{e.y3} {e.x3},-{e.y5} {e.x5},-{e.y6} ' +\r\n        '{e.x0},{e.y3} {e.x2},{e.y5} {e.x4},{e.y6} -{e.x0},-{e.y0} -{e.x2},-{e.y1} -{e.x4},-{e.y4} z',\r\n      height: 36,\r\n      width: 36,\r\n      heightElements: [2.382, 4.764, 4.926, 6.589333, 7.146, 13.178667, 19.768],\r\n      widthElements: [2.463, 2.808, 4.926, 5.616, 7.389, 8.424]\r\n    },\r\n    'EVENT_CONDITIONAL': {\r\n      d: 'M {e.x0},{e.y0} l {e.x1},0 l 0,{e.y2} l -{e.x1},0 Z ' +\r\n         'M {e.x2},{e.y3} l {e.x0},0 ' +\r\n         'M {e.x2},{e.y4} l {e.x0},0 ' +\r\n         'M {e.x2},{e.y5} l {e.x0},0 ' +\r\n         'M {e.x2},{e.y6} l {e.x0},0 ' +\r\n         'M {e.x2},{e.y7} l {e.x0},0 ' +\r\n         'M {e.x2},{e.y8} l {e.x0},0 ',\r\n      height: 36,\r\n      width:  36,\r\n      heightElements: [8.5, 14.5, 18, 11.5, 14.5, 17.5, 20.5, 23.5, 26.5],\r\n      widthElements:  [10.5, 14.5, 12.5]\r\n    },\r\n    'EVENT_LINK': {\r\n      d: 'm {mx},{my} 0,{e.y0} -{e.x1},0 0,{e.y1} {e.x1},0 0,{e.y0} {e.x0},-{e.y2} -{e.x0},-{e.y2} z',\r\n      height: 36,\r\n      width: 36,\r\n      heightElements: [4.4375, 6.75, 7.8125],\r\n      widthElements: [9.84375, 13.5]\r\n    },\r\n    'EVENT_ERROR': {\r\n      d: 'm {mx},{my} {e.x0},-{e.y0} {e.x1},-{e.y1} {e.x2},{e.y2} {e.x3},-{e.y3} -{e.x4},{e.y4} -{e.x5},-{e.y5} z',\r\n      height: 36,\r\n      width: 36,\r\n      heightElements: [0.023, 8.737, 8.151, 16.564, 10.591, 8.714],\r\n      widthElements: [0.085, 6.672, 6.97, 4.273, 5.337, 6.636]\r\n    },\r\n    'EVENT_CANCEL_45': {\r\n      d: 'm {mx},{my} -{e.x1},0 0,{e.x0} {e.x1},0 0,{e.y1} {e.x0},0 ' +\r\n        '0,-{e.y1} {e.x1},0 0,-{e.y0} -{e.x1},0 0,-{e.y1} -{e.x0},0 z',\r\n      height: 36,\r\n      width: 36,\r\n      heightElements: [4.75, 8.5],\r\n      widthElements: [4.75, 8.5]\r\n    },\r\n    'EVENT_COMPENSATION': {\r\n      d: 'm {mx},{my} {e.x0},-{e.y0} 0,{e.y1} z m {e.x0},0 {e.x0},-{e.y0} 0,{e.y1} z',\r\n      height: 36,\r\n      width: 36,\r\n      heightElements: [5, 10],\r\n      widthElements: [10]\r\n    },\r\n    'EVENT_TIMER_WH': {\r\n      d: 'M {mx},{my} m -{e.x1},-{e.y1} l {e.x1},{e.y1} l {e.x0},-{e.y0}',\r\n      height: 36,\r\n      width:  36,\r\n      heightElements: [3.5,4],\r\n      widthElements: [8.75,10.5]\r\n    },\r\n    'EVENT_MULTIPLE': {\r\n      d:'m {mx},{my} {e.x1},-{e.y0} {e.x1},{e.y0} -{e.x0},{e.y1} -{e.x2},0 z',\r\n      height: 36,\r\n      width:  36,\r\n      heightElements: [6.28099, 12.56199],\r\n      widthElements: [3.1405, 9.42149, 12.56198]\r\n    },\r\n    'EVENT_PARALLEL_MULTIPLE': {\r\n      d:'m {mx},{my} {e.x0},0 0,{e.y1} {e.x1},0 0,{e.y0} -{e.x1},0 0,{e.y1} ' +\r\n        '-{e.x0},0 0,-{e.y1} -{e.x1},0 0,-{e.y0} {e.x1},0 z',\r\n      height: 36,\r\n      width:  36,\r\n      heightElements: [2.56228, 7.68683],\r\n      widthElements: [2.56228, 7.68683]\r\n    },\r\n    'GATEWAY_EXCLUSIVE': {\r\n      d:'m {mx},{my} {e.x0},{e.y0} {e.x1},{e.y0} {e.x2},0 {e.x4},{e.y2} ' +\r\n                    '{e.x4},{e.y1} {e.x2},0 {e.x1},{e.y3} {e.x0},{e.y3} ' +\r\n                    '{e.x3},0 {e.x5},{e.y1} {e.x5},{e.y2} {e.x3},0 z',\r\n      height: 17.5,\r\n      width:  17.5,\r\n      heightElements: [8.5, 6.5312, -6.5312, -8.5],\r\n      widthElements:  [6.5, -6.5, 3, -3, 5, -5]\r\n    },\r\n    'GATEWAY_PARALLEL': {\r\n      d:'m {mx},{my} 0,{e.y1} -{e.x1},0 0,{e.y0} {e.x1},0 0,{e.y1} {e.x0},0 ' +\r\n        '0,-{e.y1} {e.x1},0 0,-{e.y0} -{e.x1},0 0,-{e.y1} -{e.x0},0 z',\r\n      height: 30,\r\n      width:  30,\r\n      heightElements: [5, 12.5],\r\n      widthElements: [5, 12.5]\r\n    },\r\n    'GATEWAY_EVENT_BASED': {\r\n      d:'m {mx},{my} {e.x0},{e.y0} {e.x0},{e.y1} {e.x1},{e.y2} {e.x2},0 z',\r\n      height: 11,\r\n      width:  11,\r\n      heightElements: [-6, 6, 12, -12],\r\n      widthElements: [9, -3, -12]\r\n    },\r\n    'GATEWAY_COMPLEX': {\r\n      d:'m {mx},{my} 0,{e.y0} -{e.x0},-{e.y1} -{e.x1},{e.y2} {e.x0},{e.y1} -{e.x2},0 0,{e.y3} ' +\r\n        '{e.x2},0  -{e.x0},{e.y1} l {e.x1},{e.y2} {e.x0},-{e.y1} 0,{e.y0} {e.x3},0 0,-{e.y0} {e.x0},{e.y1} ' +\r\n        '{e.x1},-{e.y2} -{e.x0},-{e.y1} {e.x2},0 0,-{e.y3} -{e.x2},0 {e.x0},-{e.y1} -{e.x1},-{e.y2} ' +\r\n        '-{e.x0},{e.y1} 0,-{e.y0} -{e.x3},0 z',\r\n      height: 17.125,\r\n      width:  17.125,\r\n      heightElements: [4.875, 3.4375, 2.125, 3],\r\n      widthElements: [3.4375, 2.125, 4.875, 3]\r\n    },\r\n    'DATA_OBJECT_PATH': {\r\n      d:'m 0,0 {e.x1},0 {e.x0},{e.y0} 0,{e.y1} -{e.x2},0 0,-{e.y2} {e.x1},0 0,{e.y0} {e.x0},0',\r\n      height: 61,\r\n      width:  51,\r\n      heightElements: [10, 50, 60],\r\n      widthElements: [10, 40, 50, 60]\r\n    },\r\n    'DATA_OBJECT_COLLECTION_PATH': {\r\n      d:'m {mx}, {my} ' +\r\n        'm  0 15  l 0 -15 ' +\r\n        'm  4 15  l 0 -15 ' +\r\n        'm  4 15  l 0 -15 ',\r\n      height: 61,\r\n      width:  51,\r\n      heightElements: [12],\r\n      widthElements: [1, 6, 12, 15]\r\n    },\r\n    'DATA_ARROW': {\r\n      d:'m 5,9 9,0 0,-3 5,5 -5,5 0,-3 -9,0 z',\r\n      height: 61,\r\n      width:  51,\r\n      heightElements: [],\r\n      widthElements: []\r\n    },\r\n    'DATA_STORE': {\r\n      d:'m  {mx},{my} ' +\r\n        'l  0,{e.y2} ' +\r\n        'c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0 ' +\r\n        'l  0,-{e.y2} ' +\r\n        'c -{e.x0},-{e.y1} -{e.x1},-{e.y1} -{e.x2},0' +\r\n        'c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0 ' +\r\n        'm  0,{e.y0}' +\r\n        'c -{e.x0},{e.y1} -{e.x1},{e.y1} -{e.x2},0' +\r\n        'm  0,{e.y0}' +\r\n        'c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0',\r\n      height: 61,\r\n      width:  61,\r\n      heightElements: [7, 10, 45],\r\n      widthElements:  [2, 58, 60]\r\n    },\r\n    'TEXT_ANNOTATION': {\r\n      d: 'm {mx}, {my} m 10,0 l -10,0 l 0,{e.y0} l 10,0',\r\n      height: 30,\r\n      width: 10,\r\n      heightElements: [30],\r\n      widthElements: [10]\r\n    },\r\n    'MARKER_SUB_PROCESS': {\r\n      d: 'm{mx},{my} m 7,2 l 0,10 m -5,-5 l 10,0',\r\n      height: 10,\r\n      width: 10,\r\n      heightElements: [],\r\n      widthElements: []\r\n    },\r\n    'MARKER_PARALLEL': {\r\n      d: 'm{mx},{my} m 3,2 l 0,10 m 3,-10 l 0,10 m 3,-10 l 0,10',\r\n      height: 10,\r\n      width: 10,\r\n      heightElements: [],\r\n      widthElements: []\r\n    },\r\n    'MARKER_SEQUENTIAL': {\r\n      d: 'm{mx},{my} m 0,3 l 10,0 m -10,3 l 10,0 m -10,3 l 10,0',\r\n      height: 10,\r\n      width: 10,\r\n      heightElements: [],\r\n      widthElements: []\r\n    },\r\n    'MARKER_COMPENSATION': {\r\n      d: 'm {mx},{my} 8,-5 0,10 z m 9,0 8,-5 0,10 z',\r\n      height: 10,\r\n      width: 21,\r\n      heightElements: [],\r\n      widthElements: []\r\n    },\r\n    'MARKER_LOOP': {\r\n      d: 'm {mx},{my} c 3.526979,0 6.386161,-2.829858 6.386161,-6.320661 0,-3.490806 -2.859182,-6.320661 ' +\r\n        '-6.386161,-6.320661 -3.526978,0 -6.38616,2.829855 -6.38616,6.320661 0,1.745402 ' +\r\n        '0.714797,3.325567 1.870463,4.469381 0.577834,0.571908 1.265885,1.034728 2.029916,1.35457 ' +\r\n        'l -0.718163,-3.909793 m 0.718163,3.909793 -3.885211,0.802902',\r\n      height: 13.9,\r\n      width: 13.7,\r\n      heightElements: [],\r\n      widthElements: []\r\n    },\r\n    'MARKER_ADHOC': {\r\n      d: 'm {mx},{my} m 0.84461,2.64411 c 1.05533,-1.23780996 2.64337,-2.07882 4.29653,-1.97997996 2.05163,0.0805 ' +\r\n        '3.85579,1.15803 5.76082,1.79107 1.06385,0.34139996 2.24454,0.1438 3.18759,-0.43767 0.61743,-0.33642 ' +\r\n        '1.2775,-0.64078 1.7542,-1.17511 0,0.56023 0,1.12046 0,1.6807 -0.98706,0.96237996 -2.29792,1.62393996 ' +\r\n        '-3.6918,1.66181996 -1.24459,0.0927 -2.46671,-0.2491 -3.59505,-0.74812 -1.35789,-0.55965 ' +\r\n        '-2.75133,-1.33436996 -4.27027,-1.18121996 -1.37741,0.14601 -2.41842,1.13685996 -3.44288,1.96782996 z',\r\n      height: 4,\r\n      width: 15,\r\n      heightElements: [],\r\n      widthElements: []\r\n    },\r\n    'TASK_TYPE_SEND': {\r\n      d: 'm {mx},{my} l 0,{e.y1} l {e.x1},0 l 0,-{e.y1} z l {e.x0},{e.y0} l {e.x0},-{e.y0}',\r\n      height: 14,\r\n      width:  21,\r\n      heightElements: [6, 14],\r\n      widthElements: [10.5, 21]\r\n    },\r\n    'TASK_TYPE_SCRIPT': {\r\n      d: 'm {mx},{my} c 9.966553,-6.27276 -8.000926,-7.91932 2.968968,-14.938 l -8.802728,0 ' +\r\n        'c -10.969894,7.01868 6.997585,8.66524 -2.968967,14.938 z ' +\r\n        'm -7,-12 l 5,0 ' +\r\n        'm -4.5,3 l 4.5,0 ' +\r\n        'm -3,3 l 5,0' +\r\n        'm -4,3 l 5,0',\r\n      height: 15,\r\n      width:  12.6,\r\n      heightElements: [6, 14],\r\n      widthElements: [10.5, 21]\r\n    },\r\n    'TASK_TYPE_USER_1': {\r\n      d: 'm {mx},{my} c 0.909,-0.845 1.594,-2.049 1.594,-3.385 0,-2.554 -1.805,-4.62199999 ' +\r\n        '-4.357,-4.62199999 -2.55199998,0 -4.28799998,2.06799999 -4.28799998,4.62199999 0,1.348 ' +\r\n        '0.974,2.562 1.89599998,3.405 -0.52899998,0.187 -5.669,2.097 -5.794,4.7560005 v 6.718 ' +\r\n        'h 17 v -6.718 c 0,-2.2980005 -5.5279996,-4.5950005 -6.0509996,-4.7760005 z' +\r\n        'm -8,6 l 0,5.5 m 11,0 l 0,-5'\r\n    },\r\n    'TASK_TYPE_USER_2': {\r\n      d: 'm {mx},{my} m 2.162,1.009 c 0,2.4470005 -2.158,4.4310005 -4.821,4.4310005 ' +\r\n        '-2.66499998,0 -4.822,-1.981 -4.822,-4.4310005 '\r\n    },\r\n    'TASK_TYPE_USER_3': {\r\n      d: 'm {mx},{my} m -6.9,-3.80 c 0,0 2.25099998,-2.358 4.27399998,-1.177 2.024,1.181 4.221,1.537 ' +\r\n        '4.124,0.965 -0.098,-0.57 -0.117,-3.79099999 -4.191,-4.13599999 -3.57499998,0.001 ' +\r\n        '-4.20799998,3.36699999 -4.20699998,4.34799999 z'\r\n    },\r\n    'TASK_TYPE_MANUAL': {\r\n      d: 'm {mx},{my} c 0.234,-0.01 5.604,0.008 8.029,0.004 0.808,0 1.271,-0.172 1.417,-0.752 0.227,-0.898 ' +\r\n        '-0.334,-1.314 -1.338,-1.316 -2.467,-0.01 -7.886,-0.004 -8.108,-0.004 -0.014,-0.079 0.016,-0.533 0,-0.61 ' +\r\n        '0.195,-0.042 8.507,0.006 9.616,0.002 0.877,-0.007 1.35,-0.438 1.353,-1.208 0.003,-0.768 -0.479,-1.09 ' +\r\n        '-1.35,-1.091 -2.968,-0.002 -9.619,-0.013 -9.619,-0.013 v -0.591 c 0,0 5.052,-0.016 7.225,-0.016 ' +\r\n        '0.888,-0.002 1.354,-0.416 1.351,-1.193 -0.006,-0.761 -0.492,-1.196 -1.361,-1.196 -3.473,-0.005 ' +\r\n        '-10.86,-0.003 -11.0829995,-0.003 -0.022,-0.047 -0.045,-0.094 -0.069,-0.139 0.3939995,-0.319 ' +\r\n        '2.0409995,-1.626 2.4149995,-2.017 0.469,-0.4870005 0.519,-1.1650005 0.162,-1.6040005 -0.414,-0.511 ' +\r\n        '-0.973,-0.5 -1.48,-0.236 -1.4609995,0.764 -6.5999995,3.6430005 -7.7329995,4.2710005 -0.9,0.499 ' +\r\n        '-1.516,1.253 -1.882,2.19 -0.37000002,0.95 -0.17,2.01 -0.166,2.979 0.004,0.718 -0.27300002,1.345 ' +\r\n        '-0.055,2.063 0.629,2.087 2.425,3.312 4.859,3.318 4.6179995,0.014 9.2379995,-0.139 13.8569995,-0.158 ' +\r\n        '0.755,-0.004 1.171,-0.301 1.182,-1.033 0.012,-0.754 -0.423,-0.969 -1.183,-0.973 -1.778,-0.01 ' +\r\n        '-5.824,-0.004 -6.04,-0.004 10e-4,-0.084 0.003,-0.586 10e-4,-0.67 z'\r\n    },\r\n    'TASK_TYPE_INSTANTIATING_SEND': {\r\n      d: 'm {mx},{my} l 0,8.4 l 12.6,0 l 0,-8.4 z l 6.3,3.6 l 6.3,-3.6'\r\n    },\r\n    'TASK_TYPE_SERVICE': {\r\n      d: 'm {mx},{my} v -1.71335 c 0.352326,-0.0705 0.703932,-0.17838 1.047628,-0.32133 ' +\r\n        '0.344416,-0.14465 0.665822,-0.32133 0.966377,-0.52145 l 1.19431,1.18005 1.567487,-1.57688 ' +\r\n        '-1.195028,-1.18014 c 0.403376,-0.61394 0.683079,-1.29908 0.825447,-2.01824 l 1.622133,-0.01 ' +\r\n        'v -2.2196 l -1.636514,0.01 c -0.07333,-0.35153 -0.178319,-0.70024 -0.323564,-1.04372 ' +\r\n        '-0.145244,-0.34406 -0.321407,-0.6644 -0.522735,-0.96217 l 1.131035,-1.13631 -1.583305,-1.56293 ' +\r\n        '-1.129598,1.13589 c -0.614052,-0.40108 -1.302883,-0.68093 -2.022633,-0.82247 l 0.0093,-1.61852 ' +\r\n        'h -2.241173 l 0.0042,1.63124 c -0.353763,0.0736 -0.705369,0.17977 -1.049785,0.32371 -0.344415,0.14437 ' +\r\n        '-0.665102,0.32092 -0.9635006,0.52046 l -1.1698628,-1.15823 -1.5667691,1.5792 1.1684265,1.15669 ' +\r\n        'c -0.4026573,0.61283 -0.68308,1.29797 -0.8247287,2.01713 l -1.6588041,0.003 v 2.22174 ' +\r\n        'l 1.6724648,-0.006 c 0.073327,0.35077 0.1797598,0.70243 0.3242851,1.04472 0.1452428,0.34448 ' +\r\n        '0.3214064,0.6644 0.5227339,0.96066 l -1.1993431,1.19723 1.5840256,1.56011 1.1964668,-1.19348 ' +\r\n        'c 0.6140517,0.40346 1.3028827,0.68232 2.0233517,0.82331 l 7.19e-4,1.69892 h 2.226848 z ' +\r\n        'm 0.221462,-3.9957 c -1.788948,0.7502 -3.8576,-0.0928 -4.6097055,-1.87438 -0.7521065,-1.78321 ' +\r\n        '0.090598,-3.84627 1.8802645,-4.59604 1.78823,-0.74936 3.856881,0.0929 4.608987,1.87437 ' +\r\n        '0.752106,1.78165 -0.0906,3.84612 -1.879546,4.59605 z'\r\n    },\r\n    'TASK_TYPE_SERVICE_FILL': {\r\n      d: 'm {mx},{my} c -1.788948,0.7502 -3.8576,-0.0928 -4.6097055,-1.87438 -0.7521065,-1.78321 ' +\r\n        '0.090598,-3.84627 1.8802645,-4.59604 1.78823,-0.74936 3.856881,0.0929 4.608987,1.87437 ' +\r\n        '0.752106,1.78165 -0.0906,3.84612 -1.879546,4.59605 z'\r\n    },\r\n    'TASK_TYPE_BUSINESS_RULE_HEADER': {\r\n      d: 'm {mx},{my} 0,4 20,0 0,-4 z'\r\n    },\r\n    'TASK_TYPE_BUSINESS_RULE_MAIN': {\r\n      d: 'm {mx},{my} 0,12 20,0 0,-12 z' +\r\n        'm 0,8 l 20,0 ' +\r\n        'm -13,-4 l 0,8'\r\n    },\r\n    'MESSAGE_FLOW_MARKER': {\r\n      d: 'm {mx},{my} m -10.5 ,-7 l 0,14 l 21,0 l 0,-14 z l 10.5,6 l 10.5,-6'\r\n    }\r\n  };\r\n\r\n  this.getRawPath = function getRawPath(pathId) {\r\n    return this.pathMap[pathId].d;\r\n  };\r\n\r\n  /**\r\n   * Scales the path to the given height and width.\r\n   * <h1>Use case</h1>\r\n   * <p>Use case is to scale the content of elements (event, gateways) based\r\n   * on the element bounding box's size.\r\n   * </p>\r\n   * <h1>Why not transform</h1>\r\n   * <p>Scaling a path with transform() will also scale the stroke and IE does not support\r\n   * the option 'non-scaling-stroke' to prevent this.\r\n   * Also there are use cases where only some parts of a path should be\r\n   * scaled.</p>\r\n   *\r\n   * @param {String} pathId The ID of the path.\r\n   * @param {Object} param <p>\r\n   *   Example param object scales the path to 60% size of the container (data.width, data.height).\r\n   *   <pre>\r\n   *   {\r\n   *     xScaleFactor: 0.6,\r\n   *     yScaleFactor:0.6,\r\n   *     containerWidth: data.width,\r\n   *     containerHeight: data.height,\r\n   *     position: {\r\n   *       mx: 0.46,\r\n   *       my: 0.2,\r\n   *     }\r\n   *   }\r\n   *   </pre>\r\n   *   <ul>\r\n   *    <li>targetpathwidth = xScaleFactor * containerWidth</li>\r\n   *    <li>targetpathheight = yScaleFactor * containerHeight</li>\r\n   *    <li>Position is used to set the starting coordinate of the path. M is computed:\r\n    *    <ul>\r\n    *      <li>position.x * containerWidth</li>\r\n    *      <li>position.y * containerHeight</li>\r\n    *    </ul>\r\n    *    Center of the container <pre> position: {\r\n   *       mx: 0.5,\r\n   *       my: 0.5,\r\n   *     }</pre>\r\n   *     Upper left corner of the container\r\n   *     <pre> position: {\r\n   *       mx: 0.0,\r\n   *       my: 0.0,\r\n   *     }</pre>\r\n   *    </li>\r\n   *   </ul>\r\n   * </p>\r\n   *\r\n   */\r\n  this.getScaledPath = function getScaledPath(pathId, param) {\r\n    var rawPath = this.pathMap[pathId];\r\n\r\n    // positioning\r\n    // compute the start point of the path\r\n    var mx, my;\r\n\r\n    if(!!param.abspos) {\r\n      mx = param.abspos.x;\r\n      my = param.abspos.y;\r\n    } else {\r\n      mx = param.containerWidth * param.position.mx;\r\n      my = param.containerHeight * param.position.my;\r\n    }\r\n\r\n    var coordinates = {}; //map for the scaled coordinates\r\n    if(param.position) {\r\n\r\n      // path\r\n      var heightRatio = (param.containerHeight / rawPath.height) * param.yScaleFactor;\r\n      var widthRatio = (param.containerWidth / rawPath.width) * param.xScaleFactor;\r\n\r\n\r\n      //Apply height ratio\r\n      for (var heightIndex = 0; heightIndex < rawPath.heightElements.length; heightIndex++) {\r\n        coordinates['y' + heightIndex] = rawPath.heightElements[heightIndex] * heightRatio;\r\n      }\r\n\r\n      //Apply width ratio\r\n      for (var widthIndex = 0; widthIndex < rawPath.widthElements.length; widthIndex++) {\r\n        coordinates['x' + widthIndex] = rawPath.widthElements[widthIndex] * widthRatio;\r\n      }\r\n    }\r\n\r\n    //Apply value to raw path\r\n    var path = Snap.format(\r\n      rawPath.d, {\r\n        mx: mx,\r\n        my: my,\r\n        e: coordinates\r\n      }\r\n    );\r\n    return path;\r\n  };\r\n}\r\n\r\n\r\nPathMap.$inject = [ 'snap' ];\r\n\r\nmodule.exports = PathMap;\n},{}],6:[function(_dereq_,module,exports){\nmodule.exports = {\r\n  __depends__: [ _dereq_('../core') ],\r\n  renderer: [ 'type', _dereq_('./BpmnRenderer') ],\r\n  pathMap: [ 'type', _dereq_('./PathMap') ]\r\n};\n},{\"../core\":3,\"./BpmnRenderer\":4,\"./PathMap\":5}],7:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nvar _ = (window._);\r\n\r\nvar Refs = _dereq_('object-refs');\r\n\r\nvar diRefs = new Refs({ name: 'bpmnElement', enumerable: true }, { name: 'di' });\r\n\r\n\r\nfunction BpmnTreeWalker(handler) {\r\n\r\n  // list of containers already walked\r\n  var handledProcesses = [];\r\n\r\n  // list of elements to handle deferred to ensure\r\n  // prerequisites are drawn\r\n  var deferred = [];\r\n\r\n  ///// Helpers /////////////////////////////////\r\n\r\n  function contextual(fn, ctx) {\r\n    return function(e) {\r\n      fn(e, ctx);\r\n    };\r\n  }\r\n\r\n  function is(element, type) {\r\n    return element.$instanceOf(type);\r\n  }\r\n\r\n  function visit(element, ctx) {\r\n\r\n    var gfx = element.gfx;\r\n\r\n    // avoid multiple rendering of elements\r\n    if (gfx) {\r\n      throw new Error('already rendered <' + element.id + '>');\r\n    }\r\n\r\n    // call handler\r\n    return handler.element(element, ctx);\r\n  }\r\n\r\n  function visitRoot(element, diagram) {\r\n    return handler.root(element, diagram);\r\n  }\r\n\r\n  function visitIfDi(element, ctx) {\r\n    try {\r\n      if (element.di) {\r\n        return visit(element, ctx);\r\n      }\r\n    } catch (e) {\r\n      logError(e.message, { element: element, error: e });\r\n    }\r\n  }\r\n\r\n  function logError(message, context) {\r\n    handler.error(message, context);\r\n  }\r\n\r\n  ////// DI handling ////////////////////////////\r\n\r\n  function registerDi(di) {\r\n    var bpmnElement = di.bpmnElement;\r\n\r\n    if (bpmnElement) {\r\n      diRefs.bind(bpmnElement, 'di');\r\n      bpmnElement.di = di;\r\n    } else {\r\n      logError('no bpmnElement for <' + di.$type + '#' + di.id + '>', { element: di });\r\n    }\r\n  }\r\n\r\n  function handleDiagram(diagram) {\r\n    handlePlane(diagram.plane);\r\n  }\r\n\r\n  function handlePlane(plane) {\r\n    registerDi(plane);\r\n\r\n    _.forEach(plane.planeElement, handlePlaneElement);\r\n  }\r\n\r\n  function handlePlaneElement(planeElement) {\r\n    registerDi(planeElement);\r\n  }\r\n\r\n\r\n  ////// Semantic handling //////////////////////\r\n\r\n  function handleDefinitions(definitions, diagram) {\r\n    // make sure we walk the correct bpmnElement\r\n\r\n    var diagrams = definitions.diagrams;\r\n\r\n    if (diagram && diagrams.indexOf(diagram) === -1) {\r\n      throw new Error('diagram not part of bpmn:Definitions');\r\n    }\r\n\r\n    if (!diagram && diagrams && diagrams.length) {\r\n      diagram = diagrams[0];\r\n    }\r\n\r\n    // no diagram -> nothing to import\r\n    if (!diagram) {\r\n      return;\r\n    }\r\n\r\n    // load DI from selected diagram only\r\n    handleDiagram(diagram);\r\n\r\n    var plane = diagram.plane,\r\n        rootElement = plane.bpmnElement;\r\n\r\n    if (!rootElement) {\r\n      throw new Error('no rootElement referenced in BPMNPlane <' + diagram.plane.id + '>');\r\n    }\r\n\r\n\r\n    var ctx = visitRoot(rootElement, plane);\r\n\r\n    if (is(rootElement, 'bpmn:Process')) {\r\n      handleProcess(rootElement, ctx);\r\n    } else if (is(rootElement, 'bpmn:Collaboration')) {\r\n      handleCollaboration(rootElement, ctx);\r\n\r\n      // force drawing of everything not yet drawn that is part of the target DI\r\n      handleUnhandledProcesses(definitions.rootElements, ctx);\r\n    } else {\r\n      throw new Error('unsupported root element for bpmndi:Diagram <' + rootElement.$type + '>');\r\n    }\r\n\r\n    // handle all deferred elements\r\n    handleDeferred(deferred);\r\n  }\r\n\r\n  function handleDeferred(deferred) {\r\n    _.forEach(deferred, function(d) { d(); });\r\n  }\r\n\r\n  function handleProcess(process, context) {\r\n    handleFlowElementsContainer(process, context);\r\n    handleIoSpecification(process.ioSpecification, context);\r\n\r\n    handleArtifacts(process.artifacts, context);\r\n\r\n    // log process handled\r\n    handledProcesses.push(process);\r\n  }\r\n\r\n  function handleUnhandledProcesses(rootElements) {\r\n\r\n    // walk through all processes that have not yet been drawn and draw them\r\n    // if they contain lanes with DI information.\r\n    // we do this to pass the free-floating lane test cases in the MIWG test suite\r\n    var processes = _.filter(rootElements, function(e) {\r\n      return is(e, 'bpmn:Process') && e.laneSets && handledProcesses.indexOf(e) === -1;\r\n    });\r\n\r\n    processes.forEach(contextual(handleProcess));\r\n  }\r\n\r\n  function handleMessageFlow(messageFlow, context) {\r\n    visitIfDi(messageFlow, context);\r\n  }\r\n\r\n  function handleMessageFlows(messageFlows, context) {\r\n    if (messageFlows) {\r\n      _.forEach(messageFlows, contextual(handleMessageFlow, context));\r\n    }\r\n  }\r\n\r\n  function handleDataAssociation(association, context) {\r\n    visitIfDi(association, context);\r\n  }\r\n\r\n  function handleDataInput(dataInput, context) {\r\n    visitIfDi(dataInput, context);\r\n  }\r\n\r\n  function handleDataOutput(dataOutput, context) {\r\n    visitIfDi(dataOutput, context);\r\n  }\r\n\r\n  function handleArtifact(artifact, context) {\r\n\r\n    // bpmn:TextAnnotation\r\n    // bpmn:Group\r\n    // bpmn:Association\r\n\r\n    visitIfDi(artifact, context);\r\n  }\r\n\r\n  function handleArtifacts(artifacts, context) {\r\n    _.forEach(artifacts, contextual(handleArtifact, context));\r\n  }\r\n\r\n  function handleIoSpecification(ioSpecification, context) {\r\n\r\n    if (!ioSpecification) {\r\n      return;\r\n    }\r\n\r\n    _.forEach(ioSpecification.dataInputs, contextual(handleDataInput, context));\r\n    _.forEach(ioSpecification.dataOutputs, contextual(handleDataOutput, context));\r\n  }\r\n\r\n  function handleSubProcess(subProcess, context) {\r\n    handleFlowElementsContainer(subProcess, context);\r\n    handleArtifacts(subProcess.artifacts, context);\r\n  }\r\n\r\n  function handleFlowNode(flowNode, context) {\r\n    var childCtx = visitIfDi(flowNode, context);\r\n\r\n    if (is(flowNode, 'bpmn:SubProcess')) {\r\n      handleSubProcess(flowNode, childCtx || context);\r\n    }\r\n  }\r\n\r\n  function handleSequenceFlow(sequenceFlow, context) {\r\n    visitIfDi(sequenceFlow, context);\r\n  }\r\n\r\n  function handleDataElement(dataObject, context) {\r\n    visitIfDi(dataObject, context);\r\n  }\r\n\r\n  function handleBoundaryEvent(dataObject, context) {\r\n    visitIfDi(dataObject, context);\r\n  }\r\n\r\n  function handleLane(lane, context) {\r\n    var newContext = visitIfDi(lane, context);\r\n\r\n    if (lane.childLaneSet) {\r\n      handleLaneSet(lane.childLaneSet, newContext || context);\r\n    } else {\r\n      var filterList = _.filter(lane.flowNodeRef, function(e) {\r\n        return e.$type !== 'bpmn:BoundaryEvent';\r\n      });\r\n      handleFlowElements(filterList, newContext || context);\r\n    }\r\n  }\r\n\r\n  function handleLaneSet(laneSet, context) {\r\n    _.forEach(laneSet.lanes, contextual(handleLane, context));\r\n  }\r\n\r\n  function handleLaneSets(laneSets, context) {\r\n    _.forEach(laneSets, contextual(handleLaneSet, context));\r\n  }\r\n\r\n  function handleFlowElementsContainer(container, context) {\r\n\r\n    if (container.laneSets) {\r\n      handleLaneSets(container.laneSets, context);\r\n      handleNonFlowNodes(container.flowElements);\r\n    } else {\r\n      handleFlowElements(container.flowElements, context);\r\n    }\r\n  }\r\n\r\n  function handleNonFlowNodes(flowElements, context) {\r\n    _.forEach(flowElements, function(e) {\r\n      if (is(e, 'bpmn:SequenceFlow')) {\r\n        deferred.push(function() {\r\n          handleSequenceFlow(e, context);\r\n        });\r\n      } else if (is(e, 'bpmn:BoundaryEvent')) {\r\n        deferred.unshift(function() {\r\n          handleBoundaryEvent(e, context);\r\n        });\r\n      } else if (is(e, 'bpmn:DataObject')) {\r\n        // SKIP (assume correct referencing via DataObjectReference)\r\n      } else if (is(e, 'bpmn:DataStoreReference')) {\r\n        handleDataElement(e, context);\r\n      } else if (is(e, 'bpmn:DataObjectReference')) {\r\n        handleDataElement(e, context);\r\n      }\r\n    });\r\n  }\r\n\r\n  function handleFlowElements(flowElements, context) {\r\n    _.forEach(flowElements, function(e) {\r\n      if (is(e, 'bpmn:SequenceFlow')) {\r\n        deferred.push(function() {\r\n          handleSequenceFlow(e, context);\r\n        });\r\n      } else if (is(e, 'bpmn:BoundaryEvent')) {\r\n        deferred.unshift(function() {\r\n          handleBoundaryEvent(e, context);\r\n        });\r\n      } else if (is(e, 'bpmn:FlowNode')) {\r\n        handleFlowNode(e, context);\r\n\r\n        if (is(e, 'bpmn:Activity')) {\r\n\r\n          handleIoSpecification(e.ioSpecification, context);\r\n\r\n          // defer handling of associations\r\n          deferred.push(function() {\r\n            _.forEach(e.dataInputAssociations, contextual(handleDataAssociation, context));\r\n            _.forEach(e.dataOutputAssociations, contextual(handleDataAssociation, context));\r\n          });\r\n        }\r\n      } else if (is(e, 'bpmn:DataObject')) {\r\n        // SKIP (assume correct referencing via DataObjectReference)\r\n      } else if (is(e, 'bpmn:DataStoreReference')) {\r\n        handleDataElement(e, context);\r\n      } else if (is(e, 'bpmn:DataObjectReference')) {\r\n        handleDataElement(e, context);\r\n      } else {\r\n        logError(\r\n          'unrecognized flowElement <' + e.$type + '> in context ' + (context ? context.id : null),\r\n          { element: e, context: context });\r\n      }\r\n    });\r\n  }\r\n\r\n  function handleParticipant(participant, context) {\r\n    var newCtx = visitIfDi(participant, context);\r\n\r\n    var process = participant.processRef;\r\n    if (process) {\r\n      handleProcess(process, newCtx || context);\r\n    }\r\n  }\r\n\r\n  function handleCollaboration(collaboration) {\r\n\r\n    _.forEach(collaboration.participants, contextual(handleParticipant));\r\n\r\n    handleArtifacts(collaboration.artifacts);\r\n\r\n    handleMessageFlows(collaboration.messageFlows);\r\n  }\r\n\r\n\r\n  ///// API ////////////////////////////////\r\n\r\n  return {\r\n    handleDefinitions: handleDefinitions\r\n  };\r\n}\r\n\r\nmodule.exports = BpmnTreeWalker;\n},{\"object-refs\":75}],8:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nvar BpmnTreeWalker = _dereq_('./BpmnTreeWalker');\r\n\r\n\r\n/**\r\n * Import the definitions into a diagram.\r\n *\r\n * Errors and warnings are reported through the specified callback.\r\n *\r\n * @param  {Diagram} diagram\r\n * @param  {ModdleElement} definitions\r\n * @param  {Function} done the callback, invoked with (err, [ warning ]) once the import is done\r\n */\r\nfunction importBpmnDiagram(diagram, definitions, done) {\r\n\r\n  var importer = diagram.get('bpmnImporter'),\r\n      eventBus = diagram.get('eventBus');\r\n\r\n  var warnings = [];\r\n\r\n  var visitor = {\r\n\r\n    root: function(element) {\r\n      return importer.add(element);\r\n    },\r\n\r\n    element: function(element, parentShape) {\r\n      return importer.add(element, parentShape);\r\n    },\r\n\r\n    error: function(message, context) {\r\n      warnings.push({ message: message, context: context });\r\n    }\r\n  };\r\n\r\n  var walker = new BpmnTreeWalker(visitor);\r\n\r\n  try {\r\n    eventBus.fire('import.start');\r\n\r\n    // import\r\n    walker.handleDefinitions(definitions);\r\n\r\n    eventBus.fire('import.success', warnings);\r\n\r\n    done(null, warnings);\r\n  } catch (e) {\r\n    eventBus.fire('import.error', e);\r\n    done(e);\r\n  }\r\n}\r\n\r\nmodule.exports.importBpmnDiagram = importBpmnDiagram;\n},{\"./BpmnTreeWalker\":7}],9:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nmodule.exports.isExpandedPool = function(semantic) {\r\n  return !!semantic.processRef;\r\n};\r\n\r\nmodule.exports.isExpanded = function(semantic) {\r\n  return !semantic.$instanceOf('bpmn:SubProcess') || semantic.di.isExpanded;\r\n};\n},{}],10:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nvar _ = (window._);\r\n\r\n\r\nvar DEFAULT_LABEL_SIZE = module.exports.DEFAULT_LABEL_SIZE = {\r\n  width: 90,\r\n  height: 50\r\n};\r\n\r\n\r\n/**\r\n * Returns true if the given semantic has an external label\r\n *\r\n * @param {BpmnElement} semantic\r\n * @return {Boolean} true if has label\r\n */\r\nmodule.exports.hasExternalLabel = function(semantic) {\r\n\r\n  return semantic.$instanceOf('bpmn:Event') ||\r\n         semantic.$instanceOf('bpmn:Gateway') ||\r\n         semantic.$instanceOf('bpmn:DataStoreReference') ||\r\n         semantic.$instanceOf('bpmn:DataObjectReference') ||\r\n         semantic.$instanceOf('bpmn:SequenceFlow') ||\r\n         semantic.$instanceOf('bpmn:MessageFlow');\r\n};\r\n\r\n\r\n/**\r\n * Get the middle of a number of waypoints\r\n *\r\n * @param  {Array<Point>} waypoints\r\n * @return {Point} the mid point\r\n */\r\nvar getWaypointsMid = module.exports.getWaypointsMid = function(waypoints) {\r\n\r\n  var mid = waypoints.length / 2 - 1;\r\n\r\n  var first = waypoints[Math.floor(mid)];\r\n  var second = waypoints[Math.ceil(mid + 0.01)];\r\n\r\n  return {\r\n    x: first.x + (second.x - first.x) / 2,\r\n    y: first.y + (second.y - first.y) / 2\r\n  };\r\n};\r\n\r\n\r\nvar getExternalLabelMid = module.exports.getExternalLabelMid = function(element) {\r\n\r\n  if (element.waypoints) {\r\n    return getWaypointsMid(element.waypoints);\r\n  } else {\r\n    return {\r\n      x: element.x + element.width / 2,\r\n      y: element.y + element.height + DEFAULT_LABEL_SIZE.height / 2 - 5\r\n    };\r\n  }\r\n};\r\n\r\n/**\r\n * Returns the bounds of an elements label, parsed from the elements DI or\r\n * generated from its bounds.\r\n *\r\n * @param {BpmnElement} semantic\r\n * @param {djs.model.Base} element\r\n */\r\nmodule.exports.getExternalLabelBounds = function(semantic, element) {\r\n\r\n  var mid,\r\n      size,\r\n      bounds,\r\n      di = semantic.di,\r\n      label = di.label;\r\n\r\n  if (label && label.bounds) {\r\n    bounds = label.bounds;\r\n\r\n    size = {\r\n      width: Math.max(150, bounds.width),\r\n      height: bounds.height\r\n    };\r\n\r\n    mid = {\r\n      x: bounds.x + bounds.width / 2,\r\n      y: bounds.y\r\n    };\r\n  } else {\r\n\r\n    mid = getExternalLabelMid(element);\r\n\r\n    size = DEFAULT_LABEL_SIZE;\r\n  }\r\n\r\n  return _.extend({\r\n    x: mid.x - size.width / 2,\r\n    y: mid.y\r\n  }, size);\r\n};\n},{}],11:[function(_dereq_,module,exports){\nmodule.exports = _dereq_('./lib/simple');\n},{\"./lib/simple\":13}],12:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nvar _ = (window._);\r\n\r\nvar Moddle = _dereq_('moddle'),\r\n    ModdleXml = _dereq_('moddle-xml');\r\n\r\n\r\nfunction createModel(packages) {\r\n  return new Moddle(packages);\r\n}\r\n\r\n/**\r\n * A sub class of {@link Moddle} with support for import and export of BPMN 2.0 xml files.\r\n *\r\n * @class BpmnModdle\r\n * @extends Moddle\r\n *\r\n * @param {Object|Array} packages to use for instantiating the model\r\n * @param {Object} [options] additional options to pass over\r\n */\r\nfunction BpmnModdle(packages, options) {\r\n  Moddle.call(this, packages, options);\r\n}\r\n\r\nBpmnModdle.prototype = Object.create(Moddle.prototype);\r\n\r\nmodule.exports = BpmnModdle;\r\n\r\n\r\n/**\r\n * Instantiates a BPMN model tree from a given xml string.\r\n *\r\n * @param {String}   xmlStr\r\n * @param {String}   [typeName]   name of the root element, defaults to 'bpmn:Definitions'\r\n * @param {Object}   [options]    options to pass to the underlying reader\r\n * @param {Function} done         callback that is invoked with (err, result, parseContext) once the import completes\r\n */\r\nBpmnModdle.prototype.fromXML = function(xmlStr, typeName, options, done) {\r\n\r\n  if (!_.isString(typeName)) {\r\n    done = options;\r\n    options = typeName;\r\n    typeName = 'bpmn:Definitions';\r\n  }\r\n\r\n  if (_.isFunction(options)) {\r\n    done = options;\r\n    options = {};\r\n  }\r\n\r\n  var reader = new ModdleXml.Reader(this, options);\r\n  var rootHandler = reader.handler(typeName);\r\n\r\n  reader.fromXML(xmlStr, rootHandler, function(err, result) {\r\n    done(err, result, rootHandler.context);\r\n  });\r\n};\r\n\r\n\r\n/**\r\n * Serializes a BPMN 2.0 object tree to XML.\r\n *\r\n * @param {String}   element    the root element, typically an instance of `bpmn:Definitions`\r\n * @param {Object}   [options]  to pass to the underlying writer\r\n * @param {Function} done       callback invoked with (err, xmlStr) once the import completes\r\n */\r\nBpmnModdle.prototype.toXML = function(element, options, done) {\r\n\r\n  if (_.isFunction(options)) {\r\n    done = options;\r\n    options = {};\r\n  }\r\n\r\n  var writer = new ModdleXml.Writer(options);\r\n  try {\r\n    var result = writer.toXML(element);\r\n    done(null, result);\r\n  } catch (e) {\r\n    done(e);\r\n  }\r\n};\r\n\n},{\"moddle\":28,\"moddle-xml\":14}],13:[function(_dereq_,module,exports){\nvar BpmnModdle = _dereq_('./bpmn-moddle');\r\n\r\nvar packages = {\r\n  bpmn: _dereq_('../resources/bpmn/json/bpmn.json'),\r\n  bpmndi: _dereq_('../resources/bpmn/json/bpmndi.json'),\r\n  dc: _dereq_('../resources/bpmn/json/dc.json'),\r\n  di: _dereq_('../resources/bpmn/json/di.json')\r\n};\r\n\r\nmodule.exports = function() {\r\n  return new BpmnModdle(packages);\r\n};\n},{\"../resources/bpmn/json/bpmn.json\":37,\"../resources/bpmn/json/bpmndi.json\":38,\"../resources/bpmn/json/dc.json\":39,\"../resources/bpmn/json/di.json\":40,\"./bpmn-moddle\":12}],14:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nmodule.exports.Reader = _dereq_('./lib/Reader');\r\nmodule.exports.Writer = _dereq_('./lib/Writer');\n},{\"./lib/Reader\":15,\"./lib/Writer\":16}],15:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nvar sax = (window.sax),\r\n    _ = (window._);\r\n\r\nvar common = _dereq_('./common'),\r\n    Types = _dereq_('moddle').types,\r\n    Stack = _dereq_('tiny-stack'),\r\n    parseNameNs = _dereq_('moddle').ns.parseName,\r\n    aliasToName = common.aliasToName;\r\n\r\n\r\nfunction parseNodeAttributes(node) {\r\n  var nodeAttrs = node.attributes;\r\n\r\n  return _.reduce(nodeAttrs, function(result, v, k) {\r\n    var name, ns;\r\n\r\n    if (!v.local) {\r\n      name = v.prefix;\r\n    } else {\r\n      ns = parseNameNs(v.name, v.prefix);\r\n      name = ns.name;\r\n    }\r\n\r\n    result[name] = v.value;\r\n    return result;\r\n  }, {});\r\n}\r\n\r\n/**\r\n * Normalizes namespaces for a node given an optional default namespace and a\r\n * number of mappings from uris to default prefixes.\r\n *\r\n * @param  {XmlNode} node\r\n * @param  {Model} model the model containing all registered namespaces\r\n * @param  {Uri} defaultNsUri\r\n */\r\nfunction normalizeNamespaces(node, model, defaultNsUri) {\r\n  var uri, childUri, prefix;\r\n\r\n  uri = node.uri || defaultNsUri;\r\n\r\n  if (uri) {\r\n    var pkg = model.getPackage(uri);\r\n\r\n    if (pkg) {\r\n      prefix = pkg.prefix;\r\n    } else {\r\n      prefix = node.prefix;\r\n    }\r\n\r\n    node.prefix = prefix;\r\n    node.uri = uri;\r\n  }\r\n\r\n  _.forEach(node.attributes, function(attr) {\r\n    normalizeNamespaces(attr, model, null);\r\n  });\r\n}\r\n\r\n/**\r\n * A parse context.\r\n *\r\n * @class\r\n *\r\n * @param {ElementHandler} parseRoot the root handler for parsing a document\r\n */\r\nfunction Context(parseRoot) {\r\n\r\n  var elementsById = {};\r\n  var references = [];\r\n\r\n  var warnings = [];\r\n\r\n  this.addReference = function(reference) {\r\n    references.push(reference);\r\n  };\r\n\r\n  this.addElement = function(id, element) {\r\n\r\n    if (!id || !element) {\r\n      throw new Error('[xml-reader] id or ctx must not be null');\r\n    }\r\n\r\n    elementsById[id] = element;\r\n  };\r\n\r\n  this.addWarning = function (w) {\r\n    warnings.push(w);\r\n  };\r\n\r\n  this.warnings = warnings;\r\n  this.references = references;\r\n\r\n  this.elementsById = elementsById;\r\n\r\n  this.parseRoot = parseRoot;\r\n}\r\n\r\n\r\nfunction BaseHandler() {}\r\n\r\nBaseHandler.prototype.handleEnd = function() {};\r\nBaseHandler.prototype.handleText = function() {};\r\nBaseHandler.prototype.handleNode = function() {};\r\nBaseHandler.prototype.getElement = function() {\r\n  return this.element;\r\n};\r\n\r\nfunction BodyHandler() {}\r\n\r\nBodyHandler.prototype = new BaseHandler();\r\n\r\nBodyHandler.prototype.handleText = function(text) {\r\n  this.body = (this.body || '') + text;\r\n};\r\n\r\nfunction ReferenceHandler(property, context) {\r\n  this.property = property;\r\n  this.context = context;\r\n}\r\n\r\nReferenceHandler.prototype = new BodyHandler();\r\n\r\nReferenceHandler.prototype.handleNode = function(node) {\r\n\r\n  if (this.element) {\r\n    throw new Error('expected no sub nodes');\r\n  } else {\r\n    this.element = this.createReference(node);\r\n  }\r\n\r\n  return this;\r\n};\r\n\r\nReferenceHandler.prototype.handleEnd = function() {\r\n  this.element.id = this.body;\r\n};\r\n\r\nReferenceHandler.prototype.createReference = function() {\r\n  return {\r\n    property: this.property.ns.name,\r\n    id: ''\r\n  };\r\n};\r\n\r\nfunction ValueHandler(propertyDesc, element) {\r\n  this.element = element;\r\n  this.propertyDesc = propertyDesc;\r\n}\r\n\r\nValueHandler.prototype = new BodyHandler();\r\n\r\nValueHandler.prototype.handleEnd = function() {\r\n\r\n  var value = this.body,\r\n      element = this.element,\r\n      propertyDesc = this.propertyDesc;\r\n\r\n  value = Types.coerceType(propertyDesc.type, value);\r\n\r\n  if (propertyDesc.isMany) {\r\n    element.get(propertyDesc.name).push(value);\r\n  } else {\r\n    element.set(propertyDesc.name, value);\r\n  }\r\n};\r\n\r\n\r\nfunction BaseElementHandler() {}\r\n\r\nBaseElementHandler.prototype = Object.create(BodyHandler.prototype);\r\n\r\nBaseElementHandler.prototype.handleNode = function(node) {\r\n  var parser = this;\r\n\r\n  if (!this.element) {\r\n    this.element = this.createElement(node);\r\n    var id = this.element.id;\r\n\r\n    if (id) {\r\n      this.context.addElement(id, this.element);\r\n    }\r\n  } else {\r\n    parser = this.handleChild(node);\r\n  }\r\n\r\n  return parser;\r\n};\r\n\r\n/**\r\n * @class XMLReader.ElementHandler\r\n *\r\n */\r\nfunction ElementHandler(model, type, context) {\r\n  this.model = model;\r\n  this.type = model.getType(type);\r\n  this.context = context;\r\n}\r\n\r\nElementHandler.prototype = new BaseElementHandler();\r\n\r\nElementHandler.prototype.addReference = function(reference) {\r\n  this.context.addReference(reference);\r\n};\r\n\r\nElementHandler.prototype.handleEnd = function() {\r\n\r\n  var value = this.body,\r\n      element = this.element,\r\n      descriptor = element.$descriptor,\r\n      bodyProperty = descriptor.bodyProperty;\r\n\r\n  if (bodyProperty && value !== undefined) {\r\n    value = Types.coerceType(bodyProperty.type, value);\r\n    element.set(bodyProperty.name, value);\r\n  }\r\n};\r\n\r\n/**\r\n * Create an instance of the model from the given node.\r\n *\r\n * @param  {Element} node the xml node\r\n */\r\nElementHandler.prototype.createElement = function(node) {\r\n  var attributes = parseNodeAttributes(node),\r\n      Type = this.type,\r\n      descriptor = Type.$descriptor,\r\n      context = this.context,\r\n      instance = new Type({});\r\n\r\n  _.forEach(attributes, function(value, name) {\r\n\r\n    var prop = descriptor.propertiesByName[name];\r\n\r\n    if (prop && prop.isReference) {\r\n      context.addReference({\r\n        element: instance,\r\n        property: prop.ns.name,\r\n        id: value\r\n      });\r\n    } else {\r\n      if (prop) {\r\n        value = Types.coerceType(prop.type, value);\r\n      }\r\n\r\n      instance.set(name, value);\r\n    }\r\n  });\r\n\r\n  return instance;\r\n};\r\n\r\nElementHandler.prototype.getPropertyForElement = function(nameNs) {\r\n  if (_.isString(nameNs)) {\r\n    nameNs = parseNameNs(nameNs);\r\n  }\r\n\r\n  var type = this.type,\r\n      model = this.model,\r\n      descriptor = type.$descriptor;\r\n\r\n  var propertyName = nameNs.name;\r\n\r\n  var property = descriptor.propertiesByName[propertyName];\r\n\r\n  // search for properties by name first\r\n  if (property) {\r\n    return property;\r\n  }\r\n\r\n  var pkg = model.getPackage(nameNs.prefix);\r\n\r\n  if (pkg) {\r\n    var typeName = nameNs.prefix + ':' + aliasToName(nameNs.localName, descriptor.$pkg),\r\n        elementType = model.getType(typeName);\r\n\r\n    // search for collection members later\r\n    property = _.find(descriptor.properties, function(p) {\r\n      return !p.isVirtual && !p.isReference && !p.isAttribute && elementType.hasType(p.type);\r\n    });\r\n\r\n    if (property) {\r\n      return _.extend({}, property, { effectiveType: elementType.$descriptor.name });\r\n    }\r\n  } else {\r\n    // parse unknown element (maybe extension)\r\n    property = _.find(descriptor.properties, function(p) {\r\n      return !p.isReference && !p.isAttribute && p.type === 'Element';\r\n    });\r\n\r\n    if (property) {\r\n      return property;\r\n    }\r\n  }\r\n\r\n  throw new Error('unrecognized element <' + nameNs.name + '>');\r\n};\r\n\r\nElementHandler.prototype.toString = function() {\r\n  return 'ElementDescriptor[' + this.type.$descriptor.name + ']';\r\n};\r\n\r\nElementHandler.prototype.valueHandler = function(propertyDesc, element) {\r\n  return new ValueHandler(propertyDesc, element);\r\n};\r\n\r\nElementHandler.prototype.referenceHandler = function(propertyDesc) {\r\n  return new ReferenceHandler(propertyDesc, this.context);\r\n};\r\n\r\nElementHandler.prototype.handler = function(type) {\r\n  if (type === 'Element') {\r\n    return new GenericElementHandler(this.model, type, this.context);\r\n  } else {\r\n    return new ElementHandler(this.model, type, this.context);\r\n  }\r\n};\r\n\r\n/**\r\n * Handle the child element parsing\r\n *\r\n * @param  {Element} node the xml node\r\n */\r\nElementHandler.prototype.handleChild = function(node) {\r\n  var nameNs = parseNameNs(node.local, node.prefix);\r\n\r\n  var propertyDesc, type, element, childHandler;\r\n\r\n  propertyDesc = this.getPropertyForElement(nameNs);\r\n  element = this.element;\r\n\r\n  type = propertyDesc.effectiveType || propertyDesc.type;\r\n\r\n  if (Types.isSimple(propertyDesc.type)) {\r\n    return this.valueHandler(propertyDesc, element);\r\n  }\r\n\r\n  if (propertyDesc.isReference) {\r\n    childHandler = this.referenceHandler(propertyDesc).handleNode(node);\r\n  } else {\r\n    childHandler = this.handler(type).handleNode(node);\r\n  }\r\n\r\n  var newElement = childHandler.getElement();\r\n\r\n  // child handles may decide to skip elements\r\n  // by not returning anything\r\n  if (newElement !== undefined) {\r\n\r\n    if (propertyDesc.isMany) {\r\n      element.get(propertyDesc.name).push(newElement);\r\n    } else {\r\n      element.set(propertyDesc.name, newElement);\r\n    }\r\n\r\n    if (propertyDesc.isReference) {\r\n      _.extend(newElement, {\r\n        element: element\r\n      });\r\n\r\n      this.context.addReference(newElement);\r\n    } else {\r\n      // establish child -> parent relationship\r\n      newElement.$parent = element;\r\n    }\r\n  }\r\n\r\n  return childHandler;\r\n};\r\n\r\n\r\nfunction GenericElementHandler(model, type, context) {\r\n  this.model = model;\r\n  this.context = context;\r\n}\r\n\r\nGenericElementHandler.prototype = new BaseElementHandler();\r\n\r\nGenericElementHandler.prototype.createElement = function(node) {\r\n\r\n  var name = node.name,\r\n      prefix = node.prefix,\r\n      uri = node.ns[prefix],\r\n      attributes = node.attributes;\r\n\r\n  return this.model.createAny(name, uri, attributes);\r\n};\r\n\r\nGenericElementHandler.prototype.handleChild = function(node) {\r\n\r\n  var handler = new GenericElementHandler(this.model, 'Element', this.context).handleNode(node),\r\n      element = this.element;\r\n\r\n  var newElement = handler.getElement(),\r\n      children;\r\n\r\n  if (newElement !== undefined) {\r\n    children = element.$children = element.$children || [];\r\n    children.push(newElement);\r\n\r\n    // establish child -> parent relationship\r\n    newElement.$parent = element;\r\n  }\r\n\r\n  return handler;\r\n};\r\n\r\nGenericElementHandler.prototype.handleText = function(text) {\r\n  this.body = this.body || '' + text;\r\n};\r\n\r\nGenericElementHandler.prototype.handleEnd = function() {\r\n  if (this.body) {\r\n    this.element.$body = this.body;\r\n  }\r\n};\r\n\r\n/**\r\n * A reader for a meta-model\r\n *\r\n * @class XMLReader\r\n *\r\n * @param {Model} model used to read xml files\r\n */\r\nfunction XMLReader(model) {\r\n\r\n  function resolveReferences(context) {\r\n\r\n    var elementsById = context.elementsById;\r\n    var references = context.references;\r\n\r\n    _.forEach(references, function(r) {\r\n      var element = r.element;\r\n      var reference = elementsById[r.id];\r\n      var property = element.$descriptor.propertiesByName[r.property];\r\n\r\n      if (!reference) {\r\n        context.addWarning({\r\n          message: 'unresolved reference <' + r.id + '>',\r\n          element: r.element,\r\n          property: r.property,\r\n          value: r.id\r\n        });\r\n      }\r\n\r\n      if (property.isMany) {\r\n        var collection = element.get(property.name),\r\n            idx = collection.indexOf(r);\r\n\r\n        if (!reference) {\r\n          // remove unresolvable reference\r\n          collection.splice(idx, 1);\r\n        } else {\r\n          // update reference\r\n          collection[idx] = reference;\r\n        }\r\n      } else {\r\n        element.set(property.name, reference);\r\n      }\r\n    });\r\n  }\r\n\r\n  function fromXML(xml, rootHandler, done) {\r\n\r\n    var context = new Context(rootHandler);\r\n\r\n    var parser = sax.parser(true, { xmlns: true, trim: true }),\r\n        stack = new Stack();\r\n\r\n    rootHandler.context = context;\r\n\r\n    // push root handler\r\n    stack.push(rootHandler);\r\n\r\n    // error handling\r\n    parser.onerror = function (e) {\r\n      // just throw\r\n      throw e;\r\n    };\r\n\r\n    parser.onopentag = function(node) {\r\n      var handler = stack.peek();\r\n\r\n      normalizeNamespaces(node, model);\r\n\r\n      try {\r\n        stack.push(handler.handleNode(node));\r\n      } catch (e) {\r\n\r\n        var line = this.line,\r\n            column = this.column;\r\n\r\n        throw new Error(\r\n          'unparsable content <' + node.name + '> detected\\n\\t' +\r\n            'line: ' + line + '\\n\\t' +\r\n            'column: ' + column + '\\n\\t' +\r\n            'nested error: ' + e.message);\r\n      }\r\n    };\r\n\r\n    parser.ontext = parser.oncdata = function(text) {\r\n      var handler = stack.peek();\r\n      handler.handleText(text);\r\n    };\r\n\r\n    parser.onclosetag = function(tagName) {\r\n      var old = stack.pop();\r\n      old.handleEnd();\r\n    };\r\n\r\n    parser.onend = function () {\r\n      resolveReferences(context);\r\n      done(null, rootHandler.getElement(), context);\r\n    };\r\n\r\n    try {\r\n      parser.write(xml).close();\r\n    } catch (e) {\r\n      // handle errors\r\n      done(e, undefined, context);\r\n    }\r\n  }\r\n\r\n  return {\r\n    fromXML: fromXML,\r\n\r\n    handler: function(name) {\r\n      return new ElementHandler(model, name);\r\n    }\r\n  };\r\n}\r\n\r\nmodule.exports = XMLReader;\r\nmodule.exports.ElementHandler = ElementHandler;\n},{\"./common\":17,\"moddle\":18,\"tiny-stack\":27}],16:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nvar _ = (window._);\r\n\r\nvar Types = _dereq_('moddle').types,\r\n    common = _dereq_('./common'),\r\n    parseNameNs = _dereq_('moddle').ns.parseName,\r\n    nameToAlias = common.nameToAlias;\r\n\r\nvar XML_PREAMBLE = '<?xml version=\"1.0\" encoding=\"UTF-8\"?>\\n';\r\n\r\nvar CDATA_ESCAPE = /[<>\"&]+/;\r\n\r\nvar DEFAULT_NS_MAP = common.DEFAULT_NS_MAP;\r\n\r\n\r\nfunction nsName(ns) {\r\n  if (_.isString(ns)) {\r\n    return ns;\r\n  } else {\r\n    return (ns.prefix ? ns.prefix + ':' : '') + ns.localName;\r\n  }\r\n}\r\n\r\nfunction getElementNs(ns, descriptor) {\r\n  if (descriptor.isGeneric) {\r\n    return descriptor.name;\r\n  } else {\r\n    return _.extend({ localName: nameToAlias(descriptor.ns.localName, descriptor.$pkg) }, ns);\r\n  }\r\n}\r\n\r\nfunction getPropertyNs(ns, descriptor) {\r\n  return _.extend({ localName: descriptor.ns.localName }, ns);\r\n}\r\n\r\nfunction getSerializableProperties(element) {\r\n  var descriptor = element.$descriptor;\r\n\r\n  return _.filter(descriptor.properties, function(p) {\r\n    var name = p.name;\r\n\r\n    // do not serialize defaults\r\n    if (!element.hasOwnProperty(name)) {\r\n      return false;\r\n    }\r\n\r\n    var value = element[name];\r\n\r\n    // do not serialize default equals\r\n    if (value === p.default) {\r\n      return false;\r\n    }\r\n\r\n    return p.isMany ? value.length : true;\r\n  });\r\n}\r\n\r\n/**\r\n * Escape a string attribute to not contain any bad values (line breaks, '\"', ...)\r\n *\r\n * @param {String} str the string to escape\r\n * @return {String} the escaped string\r\n */\r\nfunction escapeAttr(str) {\r\n  var escapeMap = {\r\n    '\\n': '&#10;',\r\n    '\\n\\r': '&#10;',\r\n    '\"': '&quot;'\r\n  };\r\n\r\n  // ensure we are handling strings here\r\n  str = _.isString(str) ? str : '' + str;\r\n\r\n  return str.replace(/(\\n|\\n\\r|\")/g, function(str) {\r\n    return escapeMap[str];\r\n  });\r\n}\r\n\r\nfunction filterAttributes(props) {\r\n  return _.filter(props, function(p) { return p.isAttr; });\r\n}\r\n\r\nfunction filterContained(props) {\r\n  return _.filter(props, function(p) { return !p.isAttr; });\r\n}\r\n\r\n\r\nfunction ReferenceSerializer(parent, ns) {\r\n  this.ns = ns;\r\n}\r\n\r\nReferenceSerializer.prototype.build = function(element) {\r\n  this.element = element;\r\n  return this;\r\n};\r\n\r\nReferenceSerializer.prototype.serializeTo = function(writer) {\r\n  writer\r\n    .appendIndent()\r\n    .append('<' + nsName(this.ns) + '>' + this.element.id + '</' + nsName(this.ns) + '>')\r\n    .appendNewLine();\r\n};\r\n\r\nfunction BodySerializer() {}\r\n\r\nBodySerializer.prototype.serializeValue = BodySerializer.prototype.serializeTo = function(writer) {\r\n  var value = this.value,\r\n      escape = this.escape;\r\n\r\n  if (escape) {\r\n    writer.append('<![CDATA[');\r\n  }\r\n\r\n  writer.append(this.value);\r\n\r\n  if (escape) {\r\n    writer.append(']]>');\r\n  }\r\n};\r\n\r\nBodySerializer.prototype.build = function(prop, value) {\r\n  this.value = value;\r\n\r\n  if (prop.type === 'String' && CDATA_ESCAPE.test(value)) {\r\n    this.escape = true;\r\n  }\r\n\r\n  return this;\r\n};\r\n\r\nfunction ValueSerializer(ns) {\r\n  this.ns = ns;\r\n}\r\n\r\nValueSerializer.prototype = new BodySerializer();\r\n\r\nValueSerializer.prototype.serializeTo = function(writer) {\r\n\r\n  writer\r\n    .appendIndent()\r\n    .append('<' + nsName(this.ns) + '>');\r\n\r\n  this.serializeValue(writer);\r\n\r\n  writer\r\n    .append( '</' + nsName(this.ns) + '>')\r\n    .appendNewLine();\r\n};\r\n\r\nfunction ElementSerializer(parent, ns) {\r\n  this.body = [];\r\n  this.attrs = [];\r\n\r\n  this.parent = parent;\r\n  this.ns = ns;\r\n}\r\n\r\nElementSerializer.prototype.build = function(element) {\r\n  this.element = element;\r\n\r\n  var otherAttrs = this.parseNsAttributes(element);\r\n\r\n  if (!this.ns) {\r\n    this.ns = this.nsTagName(element.$descriptor);\r\n  }\r\n\r\n  if (element.$descriptor.isGeneric) {\r\n    this.parseGeneric(element);\r\n  } else {\r\n    var properties = getSerializableProperties(element);\r\n\r\n    this.parseAttributes(filterAttributes(properties));\r\n    this.parseContainments(filterContained(properties));\r\n\r\n    this.parseGenericAttributes(element, otherAttrs);\r\n  }\r\n\r\n  return this;\r\n};\r\n\r\nElementSerializer.prototype.nsTagName = function(descriptor) {\r\n  var effectiveNs = this.logNamespaceUsed(descriptor.ns);\r\n  return getElementNs(effectiveNs, descriptor);\r\n};\r\n\r\nElementSerializer.prototype.nsPropertyTagName = function(descriptor) {\r\n  var effectiveNs = this.logNamespaceUsed(descriptor.ns);\r\n  return getPropertyNs(effectiveNs, descriptor);\r\n};\r\n\r\nElementSerializer.prototype.isLocalNs = function(ns) {\r\n  return ns.uri === this.ns.uri;\r\n};\r\n\r\nElementSerializer.prototype.nsAttributeName = function(element) {\r\n\r\n  var ns;\r\n\r\n  if (_.isString(element)) {\r\n    ns = parseNameNs(element);\r\n  } else\r\n  if (element.ns) {\r\n    ns = element.ns;\r\n  }\r\n\r\n  var effectiveNs = this.logNamespaceUsed(ns);\r\n\r\n  // strip prefix if same namespace like parent\r\n  if (this.isLocalNs(effectiveNs)) {\r\n    return { localName: ns.localName };\r\n  } else {\r\n    return _.extend({ localName: ns.localName }, effectiveNs);\r\n  }\r\n};\r\n\r\nElementSerializer.prototype.parseGeneric = function(element) {\r\n\r\n  var self = this,\r\n      body = this.body,\r\n      attrs = this.attrs;\r\n\r\n  _.forEach(element, function(val, key) {\r\n\r\n    if (key === '$body') {\r\n      body.push(new BodySerializer().build({ type: 'String' }, val));\r\n    } else\r\n    if (key === '$children') {\r\n      _.forEach(val, function(child) {\r\n        body.push(new ElementSerializer(self).build(child));\r\n      });\r\n    } else\r\n    if (key.indexOf('$') !== 0) {\r\n      attrs.push({ name: key, value: escapeAttr(val) });\r\n    }\r\n  });\r\n};\r\n\r\n/**\r\n * Parse namespaces and return a list of left over generic attributes\r\n *\r\n * @param  {Object} element\r\n * @return {Array<Object>}\r\n */\r\nElementSerializer.prototype.parseNsAttributes = function(element) {\r\n  var self = this;\r\n\r\n  var genericAttrs = element.$attrs;\r\n\r\n  var attributes = [];\r\n\r\n  // parse namespace attributes first\r\n  // and log them. push non namespace attributes to a list\r\n  // and process them later\r\n  _.forEach(genericAttrs, function(value, name) {\r\n    var nameNs = parseNameNs(name);\r\n\r\n    if (nameNs.prefix === 'xmlns') {\r\n      self.logNamespace({ prefix: nameNs.localName, uri: value });\r\n    } else\r\n    if (!nameNs.prefix && nameNs.localName === 'xmlns') {\r\n      self.logNamespace({ uri: value });\r\n    } else {\r\n      attributes.push({ name: name, value: value });\r\n    }\r\n  });\r\n\r\n  return attributes;\r\n};\r\n\r\nElementSerializer.prototype.parseGenericAttributes = function(element, attributes) {\r\n\r\n  var self = this;\r\n\r\n  _.forEach(attributes, function(attr) {\r\n    try {\r\n      self.addAttribute(self.nsAttributeName(attr.name), attr.value);\r\n    } catch (e) {\r\n      console.warn('[writer] missing namespace information for ', attr.name, '=', attr.value, 'on', element, e);\r\n    }\r\n  });\r\n};\r\n\r\nElementSerializer.prototype.parseContainments = function(properties) {\r\n\r\n  var self = this,\r\n      body = this.body,\r\n      element = this.element,\r\n      typeDesc = element.$descriptor;\r\n\r\n  _.forEach(properties, function(p) {\r\n    var value = element.get(p.name),\r\n        isReference = p.isReference,\r\n        isMany = p.isMany;\r\n\r\n    var ns = self.nsPropertyTagName(p);\r\n\r\n    if (!isMany) {\r\n      value = [ value ];\r\n    }\r\n\r\n    if (p.isBody) {\r\n      body.push(new BodySerializer().build(p, value[0]));\r\n    } else\r\n    if (Types.isSimple(p.type)) {\r\n      _.forEach(value, function(v) {\r\n        body.push(new ValueSerializer(ns).build(p, v));\r\n      });\r\n    } else\r\n    if (isReference) {\r\n      _.forEach(value, function(v) {\r\n        body.push(new ReferenceSerializer(self, ns).build(v));\r\n      });\r\n    } else {\r\n      // allow serialization via type\r\n      // rather than element name\r\n      var asType = p.serialize === 'xsi:type';\r\n\r\n      _.forEach(value, function(v) {\r\n        var serializer;\r\n\r\n        if (asType) {\r\n          serializer = new TypeSerializer(self, ns);\r\n        } else {\r\n          serializer = new ElementSerializer(self);\r\n        }\r\n\r\n        body.push(serializer.build(v));\r\n      });\r\n    }\r\n  });\r\n};\r\n\r\nElementSerializer.prototype.getNamespaces = function() {\r\n  if (!this.parent) {\r\n    if (!this.namespaces) {\r\n      this.namespaces = {\r\n        prefixMap: {},\r\n        uriMap: {},\r\n        used: {}\r\n      };\r\n    }\r\n  } else {\r\n    this.namespaces = this.parent.getNamespaces();\r\n  }\r\n\r\n  return this.namespaces;\r\n};\r\n\r\nElementSerializer.prototype.logNamespace = function(ns) {\r\n  var namespaces = this.getNamespaces();\r\n\r\n  var existing = namespaces.uriMap[ns.uri];\r\n\r\n  if (!existing) {\r\n    namespaces.uriMap[ns.uri] = ns;\r\n  }\r\n\r\n  namespaces.prefixMap[ns.prefix] = ns.uri;\r\n\r\n  return ns;\r\n};\r\n\r\nElementSerializer.prototype.logNamespaceUsed = function(ns) {\r\n  var element = this.element,\r\n      model = element.$model,\r\n      namespaces = this.getNamespaces();\r\n\r\n  // ns may be\r\n  //\r\n  //   * prefix only\r\n  //   * prefix:uri\r\n\r\n  var prefix = ns.prefix;\r\n  var uri = ns.uri || DEFAULT_NS_MAP[prefix] ||\r\n            namespaces.prefixMap[prefix] || (model ? (model.getPackage(prefix) || {}).uri : null);\r\n\r\n  if (!uri) {\r\n    throw new Error('no namespace uri given for prefix <' + ns.prefix + '>');\r\n  }\r\n\r\n  ns = namespaces.uriMap[uri];\r\n\r\n  if (!ns) {\r\n    ns = this.logNamespace({ prefix: prefix, uri: uri });\r\n  }\r\n\r\n  if (!namespaces.used[ns.uri]) {\r\n    namespaces.used[ns.uri] = ns;\r\n  }\r\n\r\n  return ns;\r\n};\r\n\r\nElementSerializer.prototype.parseAttributes = function(properties) {\r\n  var self = this,\r\n      element = this.element;\r\n\r\n  _.forEach(properties, function(p) {\r\n    self.logNamespaceUsed(p.ns);\r\n\r\n    var value = element.get(p.name);\r\n\r\n    if (p.isReference) {\r\n      value = value.id;\r\n    }\r\n\r\n    self.addAttribute(self.nsAttributeName(p), value);\r\n  });\r\n};\r\n\r\nElementSerializer.prototype.addAttribute = function(name, value) {\r\n  var attrs = this.attrs;\r\n\r\n  if (_.isString(value)) {\r\n    value = escapeAttr(value);\r\n  }\r\n\r\n  attrs.push({ name: name, value: value });\r\n};\r\n\r\nElementSerializer.prototype.serializeAttributes = function(writer) {\r\n  var element = this.element,\r\n      attrs = this.attrs,\r\n      root = !this.parent,\r\n      namespaces = this.namespaces;\r\n\r\n  function collectNsAttrs() {\r\n    return _.collect(namespaces.used, function(ns) {\r\n      var name = 'xmlns' + (ns.prefix ? ':' + ns.prefix : '');\r\n      return { name: name, value: ns.uri };\r\n    });\r\n  }\r\n\r\n  if (root) {\r\n    attrs = collectNsAttrs().concat(attrs);\r\n  }\r\n\r\n  _.forEach(attrs, function(a) {\r\n    writer\r\n      .append(' ')\r\n      .append(nsName(a.name)).append('=\"').append(a.value).append('\"');\r\n  });\r\n};\r\n\r\nElementSerializer.prototype.serializeTo = function(writer) {\r\n  var hasBody = this.body.length;\r\n\r\n  writer\r\n    .appendIndent()\r\n    .append('<' + nsName(this.ns));\r\n\r\n  this.serializeAttributes(writer);\r\n\r\n  writer\r\n    .append(hasBody ? '>' : ' />')\r\n    .appendNewLine();\r\n\r\n  writer.indent();\r\n\r\n  _.forEach(this.body, function(b) {\r\n    b.serializeTo(writer);\r\n  });\r\n\r\n  writer.unindent();\r\n\r\n  if (hasBody) {\r\n    writer\r\n      .appendIndent()\r\n      .append('</' + nsName(this.ns) + '>')\r\n      .appendNewLine();\r\n  }\r\n};\r\n\r\n/**\r\n * A serializer for types that handles serialization of data types\r\n */\r\nfunction TypeSerializer(parent, ns) {\r\n  ElementSerializer.call(this, parent, ns);\r\n}\r\n\r\nTypeSerializer.prototype = new ElementSerializer();\r\n\r\nTypeSerializer.prototype.build = function(element) {\r\n  this.element = element;\r\n  this.typeNs = this.nsTagName(element.$descriptor);\r\n\r\n  return ElementSerializer.prototype.build.call(this, element);\r\n};\r\n\r\nTypeSerializer.prototype.isLocalNs = function(ns) {\r\n  return ns.uri === this.typeNs.uri;\r\n};\r\n\r\nfunction SavingWriter() {\r\n  this.value = '';\r\n\r\n  this.write = function(str) {\r\n    this.value += str;\r\n  };\r\n}\r\n\r\nfunction FormatingWriter(out, format) {\r\n\r\n  var indent = [''];\r\n\r\n  this.append = function(str) {\r\n    out.write(str);\r\n\r\n    return this;\r\n  };\r\n\r\n  this.appendNewLine = function() {\r\n    if (format) {\r\n      out.write('\\n');\r\n    }\r\n\r\n    return this;\r\n  };\r\n\r\n  this.appendIndent = function() {\r\n    if (format) {\r\n      out.write(indent.join('  '));\r\n    }\r\n\r\n    return this;\r\n  };\r\n\r\n  this.indent = function() {\r\n    indent.push('');\r\n    return this;\r\n  };\r\n\r\n  this.unindent = function() {\r\n    indent.pop();\r\n    return this;\r\n  };\r\n}\r\n\r\n/**\r\n * A writer for meta-model backed document trees\r\n *\r\n * @class XMLWriter\r\n */\r\nfunction XMLWriter(options) {\r\n\r\n  options = _.extend({ format: false, preamble: true }, options || {});\r\n\r\n  function toXML(tree, writer) {\r\n    var internalWriter = writer || new SavingWriter();\r\n    var formatingWriter = new FormatingWriter(internalWriter, options.format);\r\n\r\n    if (options.preamble) {\r\n      formatingWriter.append(XML_PREAMBLE);\r\n    }\r\n\r\n    new ElementSerializer().build(tree).serializeTo(formatingWriter);\r\n\r\n    if (!writer) {\r\n      return internalWriter.value;\r\n    }\r\n  }\r\n\r\n  return {\r\n    toXML: toXML\r\n  };\r\n}\r\n\r\nmodule.exports = XMLWriter;\n},{\"./common\":17,\"moddle\":18}],17:[function(_dereq_,module,exports){\n'use strict';\r\n\r\n\r\nfunction capitalize(string) {\r\n  return string.charAt(0).toUpperCase() + string.slice(1);\r\n}\r\n\r\nfunction lower(string) {\r\n  return string.charAt(0).toLowerCase() + string.slice(1);\r\n}\r\n\r\nfunction hasLowerCaseAlias(pkg) {\r\n  return pkg.xml && pkg.xml.alias === 'lowerCase';\r\n}\r\n\r\n\r\nmodule.exports.aliasToName = function(alias, pkg) {\r\n  if (hasLowerCaseAlias(pkg)) {\r\n    return capitalize(alias);\r\n  } else {\r\n    return alias;\r\n  }\r\n};\r\n\r\nmodule.exports.nameToAlias = function(name, pkg) {\r\n  if (hasLowerCaseAlias(pkg)) {\r\n    return lower(name);\r\n  } else {\r\n    return name;\r\n  }\r\n};\r\n\r\nmodule.exports.DEFAULT_NS_MAP = {\r\n  'xsi': 'http://www.w3.org/2001/XMLSchema-instance'\r\n};\n},{}],18:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nmodule.exports = _dereq_('./lib/moddle');\r\n\r\nmodule.exports.types = _dereq_('./lib/types');\r\n\r\nmodule.exports.ns = _dereq_('./lib/ns');\n},{\"./lib/moddle\":22,\"./lib/ns\":23,\"./lib/types\":26}],19:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nfunction Base() { }\r\n\r\nBase.prototype.get = function(name) {\r\n  return this.$model.properties.get(this, name);\r\n};\r\n\r\nBase.prototype.set = function(name, value) {\r\n  this.$model.properties.set(this, name, value);\r\n};\r\n\r\n\r\nmodule.exports = Base;\n},{}],20:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nvar _ = (window._);\r\n\r\nvar parseNameNs = _dereq_('./ns').parseName;\r\n\r\n\r\nfunction DescriptorBuilder(nameNs) {\r\n  this.ns = nameNs;\r\n  this.name = nameNs.name;\r\n  this.allTypes = [];\r\n  this.properties = [];\r\n  this.propertiesByName = {};\r\n}\r\n\r\nmodule.exports = DescriptorBuilder;\r\n\r\n\r\nDescriptorBuilder.prototype.build = function() {\r\n  return _.pick(this, [ 'ns', 'name', 'allTypes', 'properties', 'propertiesByName', 'bodyProperty' ]);\r\n};\r\n\r\nDescriptorBuilder.prototype.addProperty = function(p, idx) {\r\n  this.addNamedProperty(p, true);\r\n\r\n  var properties = this.properties;\r\n\r\n  if (idx !== undefined) {\r\n    properties.splice(idx, 0, p);\r\n  } else {\r\n    properties.push(p);\r\n  }\r\n};\r\n\r\n\r\nDescriptorBuilder.prototype.replaceProperty = function(oldProperty, newProperty) {\r\n  var oldNameNs = oldProperty.ns;\r\n\r\n  var props = this.properties,\r\n      propertiesByName = this.propertiesByName;\r\n\r\n  if (oldProperty.isBody) {\r\n\r\n    if (!newProperty.isBody) {\r\n      throw new Error(\r\n        'property <' + newProperty.ns.name + '> must be body property ' +\r\n        'to refine <' + oldProperty.ns.name + '>');\r\n    }\r\n\r\n    // TODO: Check compatibility\r\n    this.setBodyProperty(newProperty, false);\r\n  }\r\n\r\n  this.addNamedProperty(newProperty, true);\r\n\r\n  // replace old property at index with new one\r\n  var idx = props.indexOf(oldProperty);\r\n  if (idx === -1) {\r\n    throw new Error('property <' + oldNameNs.name + '> not found in property list');\r\n  }\r\n\r\n  props[idx] = newProperty;\r\n\r\n  // replace propertiesByName entry with new property\r\n  propertiesByName[oldNameNs.name] = propertiesByName[oldNameNs.localName] = newProperty;\r\n};\r\n\r\n\r\nDescriptorBuilder.prototype.redefineProperty = function(p) {\r\n\r\n  var nsPrefix = p.ns.prefix;\r\n  var parts = p.redefines.split('#');\r\n\r\n  var name = parseNameNs(parts[0], nsPrefix);\r\n  var attrName = parseNameNs(parts[1], name.prefix).name;\r\n\r\n  var redefinedProperty = this.propertiesByName[attrName];\r\n  if (!redefinedProperty) {\r\n    throw new Error('refined property <' + attrName + '> not found');\r\n  } else {\r\n    this.replaceProperty(redefinedProperty, p);\r\n  }\r\n\r\n  delete p.redefines;\r\n};\r\n\r\nDescriptorBuilder.prototype.addNamedProperty = function(p, validate) {\r\n  var ns = p.ns,\r\n      propsByName = this.propertiesByName;\r\n\r\n  if (validate) {\r\n    this.assertNotDefined(p, ns.name);\r\n    this.assertNotDefined(p, ns.localName);\r\n  }\r\n\r\n  propsByName[ns.name] = propsByName[ns.localName] = p;\r\n};\r\n\r\nDescriptorBuilder.prototype.removeNamedProperty = function(p) {\r\n  var ns = p.ns,\r\n      propsByName = this.propertiesByName;\r\n\r\n  delete propsByName[ns.name];\r\n  delete propsByName[ns.localName];\r\n};\r\n\r\nDescriptorBuilder.prototype.setBodyProperty = function(p, validate) {\r\n\r\n  if (validate && this.bodyProperty) {\r\n    throw new Error(\r\n      'body property defined multiple times ' +\r\n      '(<' + this.bodyProperty.ns.name + '>, <' + p.ns.name + '>)');\r\n  }\r\n\r\n  this.bodyProperty = p;\r\n};\r\n\r\nDescriptorBuilder.prototype.addIdProperty = function(name) {\r\n  var nameNs = parseNameNs(name, this.ns.prefix);\r\n\r\n  var p = {\r\n    name: nameNs.localName,\r\n    type: 'String',\r\n    isAttr: true,\r\n    ns: nameNs\r\n  };\r\n\r\n  // ensure that id is always the first attribute (if present)\r\n  this.addProperty(p, 0);\r\n};\r\n\r\nDescriptorBuilder.prototype.assertNotDefined = function(p, name) {\r\n  var propertyName = p.name,\r\n      definedProperty = this.propertiesByName[propertyName];\r\n\r\n  if (definedProperty) {\r\n    throw new Error(\r\n      'property <' + propertyName + '> already defined; ' +\r\n      'override of <' + definedProperty.definedBy.ns.name + '#' + definedProperty.ns.name + '> by ' +\r\n      '<' + p.definedBy.ns.name + '#' + p.ns.name + '> not allowed without redefines');\r\n  }\r\n};\r\n\r\nDescriptorBuilder.prototype.hasProperty = function(name) {\r\n  return this.propertiesByName[name];\r\n};\r\n\r\nDescriptorBuilder.prototype.addTrait = function(t) {\r\n\r\n  var allTypes = this.allTypes;\r\n\r\n  if (allTypes.indexOf(t) !== -1) {\r\n    return;\r\n  }\r\n\r\n  _.forEach(t.properties, function(p) {\r\n\r\n    // clone property to allow extensions\r\n    p = _.extend({}, p, {\r\n      name: p.ns.localName\r\n    });\r\n\r\n    Object.defineProperty(p, 'definedBy', {\r\n      value: t\r\n    });\r\n\r\n    // add redefine support\r\n    if (p.redefines) {\r\n      this.redefineProperty(p);\r\n    } else {\r\n      if (p.isBody) {\r\n        this.setBodyProperty(p);\r\n      }\r\n      this.addProperty(p);\r\n    }\r\n  }, this);\r\n\r\n  allTypes.push(t);\r\n};\r\n\n},{\"./ns\":23}],21:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nvar _ = (window._);\r\n\r\nvar Base = _dereq_('./base');\r\n\r\n\r\nfunction Factory(model, properties) {\r\n  this.model = model;\r\n  this.properties = properties;\r\n}\r\n\r\nmodule.exports = Factory;\r\n\r\n\r\nFactory.prototype.createType = function(descriptor) {\r\n\r\n  var model = this.model;\r\n\r\n  var props = this.properties,\r\n      prototype = Object.create(Base.prototype);\r\n\r\n  // initialize default values\r\n  _.forEach(descriptor.properties, function(p) {\r\n    if (!p.isMany && p.default !== undefined) {\r\n      prototype[p.name] = p.default;\r\n    }\r\n  });\r\n\r\n  props.defineModel(prototype, model);\r\n  props.defineDescriptor(prototype, descriptor);\r\n\r\n  var name = descriptor.ns.name;\r\n\r\n  /**\r\n   * The new type constructor\r\n   */\r\n  function ModdleElement(attrs) {\r\n    props.define(this, '$type', { value: name, enumerable: true });\r\n    props.define(this, '$attrs', { value: {} });\r\n    props.define(this, '$parent', { writable: true });\r\n\r\n    _.forEach(attrs, function(val, key) {\r\n      this.set(key, val);\r\n    }, this);\r\n  }\r\n\r\n  ModdleElement.prototype = prototype;\r\n\r\n  ModdleElement.hasType = prototype.$instanceOf = this.model.hasType;\r\n\r\n  // static links\r\n  props.defineModel(ModdleElement, model);\r\n  props.defineDescriptor(ModdleElement, descriptor);\r\n\r\n  return ModdleElement;\r\n};\n},{\"./base\":19}],22:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nvar _ = (window._);\r\n\r\nvar Types = _dereq_('./types'),\r\n    Factory = _dereq_('./factory'),\r\n    Registry = _dereq_('./registry'),\r\n    Properties = _dereq_('./properties');\r\n\r\nvar parseNameNs = _dereq_('./ns').parseName;\r\n\r\n\r\n//// Moddle implementation /////////////////////////////////////////////////\r\n\r\n/**\r\n * @class Moddle\r\n *\r\n * A model that can be used to create elements of a specific type.\r\n *\r\n * @example\r\n *\r\n * var Moddle = require('moddle');\r\n *\r\n * var pkg = {\r\n *   name: 'mypackage',\r\n *   prefix: 'my',\r\n *   types: [\r\n *     { name: 'Root' }\r\n *   ]\r\n * };\r\n *\r\n * var moddle = new Moddle([pkg]);\r\n *\r\n * @param {Array<Package>} packages  the packages to contain\r\n * @param {Object} options  additional options to pass to the model\r\n */\r\nfunction Moddle(packages, options) {\r\n\r\n  options = options || {};\r\n\r\n  this.properties = new Properties(this);\r\n\r\n  this.factory = new Factory(this, this.properties);\r\n  this.registry = new Registry(packages, this.properties, options);\r\n\r\n  this.typeCache = {};\r\n}\r\n\r\nmodule.exports = Moddle;\r\n\r\n\r\n/**\r\n * Create an instance of the specified type.\r\n *\r\n * @method Moddle#create\r\n *\r\n * @example\r\n *\r\n * var foo = moddle.create('my:Foo');\r\n * var bar = moddle.create('my:Bar', { id: 'BAR_1' });\r\n *\r\n * @param  {String|Object} descriptor the type descriptor or name know to the model\r\n * @param  {Object} attrs   a number of attributes to initialize the model instance with\r\n * @return {Object}         model instance\r\n */\r\nModdle.prototype.create = function(descriptor, attrs) {\r\n  var Type = this.getType(descriptor);\r\n\r\n  if (!Type) {\r\n    throw new Error('unknown type <' + descriptor + '>');\r\n  }\r\n\r\n  return new Type(attrs);\r\n};\r\n\r\n\r\n/**\r\n * Returns the type representing a given descriptor\r\n *\r\n * @method Moddle#getType\r\n *\r\n * @example\r\n *\r\n * var Foo = moddle.getType('my:Foo');\r\n * var foo = new Foo({ 'id' : 'FOO_1' });\r\n *\r\n * @param  {String|Object} descriptor the type descriptor or name know to the model\r\n * @return {Object}         the type representing the descriptor\r\n */\r\nModdle.prototype.getType = function(descriptor) {\r\n\r\n  var cache = this.typeCache;\r\n\r\n  var name = _.isString(descriptor) ? descriptor : descriptor.ns.name;\r\n\r\n  var type = cache[name];\r\n\r\n  if (!type) {\r\n    descriptor = this.registry.getEffectiveDescriptor(name);\r\n    type = cache[descriptor.name] = this.factory.createType(descriptor);\r\n  }\r\n\r\n  return type;\r\n};\r\n\r\n\r\n/**\r\n * Creates an any-element type to be used within model instances.\r\n *\r\n * This can be used to create custom elements that lie outside the meta-model.\r\n * The created element contains all the meta-data required to serialize it\r\n * as part of meta-model elements.\r\n *\r\n * @method Moddle#createAny\r\n *\r\n * @example\r\n *\r\n * var foo = moddle.createAny('vendor:Foo', 'http://vendor', {\r\n *   value: 'bar'\r\n * });\r\n *\r\n * var container = moddle.create('my:Container', 'http://my', {\r\n *   any: [ foo ]\r\n * });\r\n *\r\n * // go ahead and serialize the stuff\r\n *\r\n *\r\n * @param  {String} name  the name of the element\r\n * @param  {String} nsUri the namespace uri of the element\r\n * @param  {Object} [properties] a map of properties to initialize the instance with\r\n * @return {Object} the any type instance\r\n */\r\nModdle.prototype.createAny = function(name, nsUri, properties) {\r\n\r\n  var nameNs = parseNameNs(name);\r\n\r\n  var element = {\r\n    $type: name\r\n  };\r\n\r\n  var descriptor = {\r\n    name: name,\r\n    isGeneric: true,\r\n    ns: {\r\n      prefix: nameNs.prefix,\r\n      localName: nameNs.localName,\r\n      uri: nsUri\r\n    }\r\n  };\r\n\r\n  this.properties.defineDescriptor(element, descriptor);\r\n  this.properties.defineModel(element, this);\r\n  this.properties.define(element, '$parent', { enumerable: false, writable: true });\r\n\r\n  _.forEach(properties, function(a, key) {\r\n    if (_.isObject(a) && a.value !== undefined) {\r\n      element[a.name] = a.value;\r\n    } else {\r\n      element[key] = a;\r\n    }\r\n  });\r\n\r\n  return element;\r\n};\r\n\r\n/**\r\n * Returns a registered package by uri or prefix\r\n *\r\n * @return {Object} the package\r\n */\r\nModdle.prototype.getPackage = function(uriOrPrefix) {\r\n  return this.registry.getPackage(uriOrPrefix);\r\n};\r\n\r\n/**\r\n * Returns a snapshot of all known packages\r\n *\r\n * @return {Object} the package\r\n */\r\nModdle.prototype.getPackages = function() {\r\n  return this.registry.getPackages();\r\n};\r\n\r\n/**\r\n * Returns the descriptor for an element\r\n */\r\nModdle.prototype.getElementDescriptor = function(element) {\r\n  return element.$descriptor;\r\n};\r\n\r\n/**\r\n * Returns true if the given descriptor or instance\r\n * represents the given type.\r\n *\r\n * May be applied to this, if element is omitted.\r\n */\r\nModdle.prototype.hasType = function(element, type) {\r\n  if (type === undefined) {\r\n    type = element;\r\n    element = this;\r\n  }\r\n\r\n  var descriptor = element.$model.getElementDescriptor(element);\r\n\r\n  return !!_.find(descriptor.allTypes, function(t) {\r\n    return t.name === type;\r\n  });\r\n};\r\n\r\n\r\n/**\r\n * Returns the descriptor of an elements named property\r\n */\r\nModdle.prototype.getPropertyDescriptor = function(element, property) {\r\n  return this.getElementDescriptor(element).propertiesByName[property];\r\n};\r\n\n},{\"./factory\":21,\"./ns\":23,\"./properties\":24,\"./registry\":25,\"./types\":26}],23:[function(_dereq_,module,exports){\n'use strict';\r\n\r\n/**\r\n * Parses a namespaced attribute name of the form (ns:)localName to an object,\r\n * given a default prefix to assume in case no explicit namespace is given.\r\n *\r\n * @param {String} name\r\n * @param {String} [defaultPrefix] the default prefix to take, if none is present.\r\n *\r\n * @return {Object} the parsed name\r\n */\r\nmodule.exports.parseName = function(name, defaultPrefix) {\r\n  var parts = name.split(/:/),\r\n      localName, prefix;\r\n\r\n  // no prefix (i.e. only local name)\r\n  if (parts.length === 1) {\r\n    localName = name;\r\n    prefix = defaultPrefix;\r\n  } else\r\n  // prefix + local name\r\n  if (parts.length === 2) {\r\n    localName = parts[1];\r\n    prefix = parts[0];\r\n  } else {\r\n    throw new Error('expected <prefix:localName> or <localName>, got ' + name);\r\n  }\r\n\r\n  name = (prefix ? prefix + ':' : '') + localName;\r\n\r\n  return {\r\n    name: name,\r\n    prefix: prefix,\r\n    localName: localName\r\n  };\r\n};\n},{}],24:[function(_dereq_,module,exports){\n'use strict';\r\n\r\n\r\n/**\r\n * A utility that gets and sets properties of model elements.\r\n *\r\n * @param {Model} model\r\n */\r\nfunction Properties(model) {\r\n  this.model = model;\r\n}\r\n\r\nmodule.exports = Properties;\r\n\r\n\r\n/**\r\n * Sets a named property on the target element\r\n *\r\n * @param {Object} target\r\n * @param {String} name\r\n * @param {Object} value\r\n */\r\nProperties.prototype.set = function(target, name, value) {\r\n\r\n  var property = this.model.getPropertyDescriptor(target, name);\r\n\r\n  if (!property) {\r\n    target.$attrs[name] = value;\r\n  } else {\r\n    Object.defineProperty(target, property.name, {\r\n      enumerable: !property.isReference,\r\n      writable: true,\r\n      value: value\r\n    });\r\n  }\r\n};\r\n\r\n/**\r\n * Returns the named property of the given element\r\n *\r\n * @param  {Object} target\r\n * @param  {String} name\r\n *\r\n * @return {Object}\r\n */\r\nProperties.prototype.get = function(target, name) {\r\n\r\n  var property = this.model.getPropertyDescriptor(target, name),\r\n      propertyName = property.name;\r\n\r\n  if (!property) {\r\n    return target[name];\r\n  }\r\n\r\n  // check if access to collection property and lazily initialize it\r\n  if (!target[propertyName] && property.isMany) {\r\n    Object.defineProperty(target, propertyName, {\r\n      enumerable: !property.isReference,\r\n      writable: true,\r\n      value: []\r\n    });\r\n  }\r\n\r\n  return target[propertyName];\r\n};\r\n\r\n\r\n/**\r\n * Define a property on the target element\r\n *\r\n * @param  {Object} target\r\n * @param  {String} name\r\n * @param  {Object} options\r\n */\r\nProperties.prototype.define = function(target, name, options) {\r\n  Object.defineProperty(target, name, options);\r\n};\r\n\r\n\r\n/**\r\n * Define the descriptor for an element\r\n */\r\nProperties.prototype.defineDescriptor = function(target, descriptor) {\r\n  this.define(target, '$descriptor', { value: descriptor });\r\n};\r\n\r\n/**\r\n * Define the model for an element\r\n */\r\nProperties.prototype.defineModel = function(target, model) {\r\n  this.define(target, '$model', { value: model });\r\n};\n},{}],25:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nvar _ = (window._);\r\n\r\nvar Types = _dereq_('./types'),\r\n    DescriptorBuilder = _dereq_('./descriptor-builder');\r\n\r\nvar parseNameNs = _dereq_('./ns').parseName;\r\n\r\n\r\nfunction Registry(packages, properties, options) {\r\n  this.options = _.extend({ generateId: 'id' }, options || {});\r\n\r\n  this.packageMap = {};\r\n  this.typeMap = {};\r\n\r\n  this.packages = [];\r\n\r\n  this.properties = properties;\r\n\r\n  _.forEach(packages, this.registerPackage, this);\r\n}\r\n\r\nmodule.exports = Registry;\r\n\r\n\r\nRegistry.prototype.getPackage = function(uriOrPrefix) {\r\n  return this.packageMap[uriOrPrefix];\r\n};\r\n\r\nRegistry.prototype.getPackages = function() {\r\n  return this.packages;\r\n};\r\n\r\n\r\nRegistry.prototype.registerPackage = function(pkg) {\r\n\r\n  // register types\r\n  _.forEach(pkg.types, function(descriptor) {\r\n    this.registerType(descriptor, pkg);\r\n  }, this);\r\n\r\n  this.packageMap[pkg.uri] = this.packageMap[pkg.prefix] = pkg;\r\n  this.packages.push(pkg);\r\n};\r\n\r\n\r\n/**\r\n * Register a type from a specific package with us\r\n */\r\nRegistry.prototype.registerType = function(type, pkg) {\r\n\r\n  var ns = parseNameNs(type.name, pkg.prefix),\r\n      name = ns.name,\r\n      propertiesByName = {};\r\n\r\n  // parse properties\r\n  _.forEach(type.properties, function(p) {\r\n\r\n    // namespace property names\r\n    var propertyNs = parseNameNs(p.name, ns.prefix),\r\n        propertyName = propertyNs.name;\r\n\r\n    // namespace property types\r\n    if (!Types.isBuiltIn(p.type)) {\r\n      p.type = parseNameNs(p.type, propertyNs.prefix).name;\r\n    }\r\n\r\n    _.extend(p, {\r\n      ns: propertyNs,\r\n      name: propertyName\r\n    });\r\n\r\n    propertiesByName[propertyName] = p;\r\n  });\r\n\r\n  // update ns + name\r\n  _.extend(type, {\r\n    ns: ns,\r\n    name: name,\r\n    propertiesByName: propertiesByName\r\n  });\r\n\r\n  // link to package\r\n  this.definePackage(type, pkg);\r\n\r\n  // register\r\n  this.typeMap[name] = type;\r\n};\r\n\r\n\r\n/**\r\n * Traverse the type hierarchy from bottom to top.\r\n */\r\nRegistry.prototype.mapTypes = function(nsName, iterator) {\r\n\r\n  var type = this.typeMap[nsName.name];\r\n\r\n  if (!type) {\r\n    throw new Error('unknown type <' + nsName.name + '>');\r\n  }\r\n\r\n  _.forEach(type.superClass, function(cls) {\r\n    var parentNs = parseNameNs(cls, nsName.prefix);\r\n    this.mapTypes(parentNs, iterator);\r\n  }, this);\r\n\r\n  iterator(type);\r\n};\r\n\r\n\r\n/**\r\n * Returns the effective descriptor for a type.\r\n *\r\n * @param  {String} type the namespaced name (ns:localName) of the type\r\n *\r\n * @return {Descriptor} the resulting effective descriptor\r\n */\r\nRegistry.prototype.getEffectiveDescriptor = function(name) {\r\n\r\n  var options = this.options,\r\n      nsName = parseNameNs(name);\r\n\r\n  var builder = new DescriptorBuilder(nsName);\r\n\r\n  this.mapTypes(nsName, function(type) {\r\n    builder.addTrait(type);\r\n  });\r\n\r\n  // check we have an id assigned\r\n  var id = this.options.generateId;\r\n  if (id && !builder.hasProperty(id)) {\r\n    builder.addIdProperty(id);\r\n  }\r\n\r\n  var descriptor = builder.build();\r\n\r\n  // define package link\r\n  this.definePackage(descriptor, descriptor.allTypes[descriptor.allTypes.length - 1].$pkg);\r\n\r\n  return descriptor;\r\n};\r\n\r\n\r\nRegistry.prototype.definePackage = function(target, pkg) {\r\n  this.properties.define(target, '$pkg', { value: pkg });\r\n};\n},{\"./descriptor-builder\":20,\"./ns\":23,\"./types\":26}],26:[function(_dereq_,module,exports){\n'use strict';\r\n\r\n/**\r\n * Built-in moddle types\r\n */\r\nvar BUILTINS = {\r\n  String: true,\r\n  Boolean: true,\r\n  Integer: true,\r\n  Real: true,\r\n  Element: true,\r\n};\r\n\r\n/**\r\n * Converters for built in types from string representations\r\n */\r\nvar TYPE_CONVERTERS = {\r\n  String: function(s) { return s; },\r\n  Boolean: function(s) { return s === 'true'; },\r\n  Integer: function(s) { return parseInt(s, 10); },\r\n  Real: function(s) { return parseFloat(s, 10); }\r\n};\r\n\r\n/**\r\n * Convert a type to its real representation\r\n */\r\nmodule.exports.coerceType = function(type, value) {\r\n\r\n  var converter = TYPE_CONVERTERS[type];\r\n\r\n  if (converter) {\r\n    return converter(value);\r\n  } else {\r\n    return value;\r\n  }\r\n};\r\n\r\n/**\r\n * Return whether the given type is built-in\r\n */\r\nmodule.exports.isBuiltIn = function(type) {\r\n  return !!BUILTINS[type];\r\n};\r\n\r\n/**\r\n * Return whether the given type is simple\r\n */\r\nmodule.exports.isSimple = function(type) {\r\n  return !!TYPE_CONVERTERS[type];\r\n};\n},{}],27:[function(_dereq_,module,exports){\n/**\n * Tiny stack for browser or server\n *\n * @author Jason Mulligan <jason.mulligan@avoidwork.com>\n * @copyright 2014 Jason Mulligan\n * @license BSD-3 <https://raw.github.com/avoidwork/tiny-stack/master/LICENSE>\n * @link http://avoidwork.github.io/tiny-stack\n * @module tiny-stack\n * @version 0.1.0\n */\n\n( function ( global ) {\n\n\"use strict\";\n\n/**\n * TinyStack\n *\n * @constructor\n */\nfunction TinyStack () {\n\tthis.data = [null];\n\tthis.top  = 0;\n}\n\n/**\n * Clears the stack\n *\n * @method clear\n * @memberOf TinyStack\n * @return {Object} {@link TinyStack}\n */\nTinyStack.prototype.clear = function clear () {\n\tthis.data = [null];\n\tthis.top  = 0;\n\n\treturn this;\n};\n\n/**\n * Gets the size of the stack\n *\n * @method length\n * @memberOf TinyStack\n * @return {Number} Size of stack\n */\nTinyStack.prototype.length = function length () {\n\treturn this.top;\n};\n\n/**\n * Gets the item at the top of the stack\n *\n * @method peek\n * @memberOf TinyStack\n * @return {Mixed} Item at the top of the stack\n */\nTinyStack.prototype.peek = function peek () {\n\treturn this.data[this.top];\n};\n\n/**\n * Gets & removes the item at the top of the stack\n *\n * @method pop\n * @memberOf TinyStack\n * @return {Mixed} Item at the top of the stack\n */\nTinyStack.prototype.pop = function pop () {\n\tif ( this.top > 0 ) {\n\t\tthis.top--;\n\n\t\treturn this.data.pop();\n\t}\n\telse {\n\t\treturn undefined;\n\t}\n};\n\n/**\n * Pushes an item onto the stack\n *\n * @method push\n * @memberOf TinyStack\n * @return {Object} {@link TinyStack}\n */\nTinyStack.prototype.push = function push ( arg ) {\n\tthis.data[++this.top] = arg;\n\n\treturn this;\n};\n\n/**\n * TinyStack factory\n *\n * @method factory\n * @return {Object} {@link TinyStack}\n */\nfunction factory () {\n\treturn new TinyStack();\n}\n\n// Node, AMD & window supported\nif ( typeof exports != \"undefined\" ) {\n\tmodule.exports = factory;\n}\nelse if ( typeof define == \"function\" ) {\n\tdefine( function () {\n\t\treturn factory;\n\t} );\n}\nelse {\n\tglobal.stack = factory;\n}\n} )( this );\n\n},{}],28:[function(_dereq_,module,exports){\nmodule.exports=_dereq_(18)\n},{\"./lib/moddle\":32,\"./lib/ns\":33,\"./lib/types\":36}],29:[function(_dereq_,module,exports){\nmodule.exports=_dereq_(19)\n},{}],30:[function(_dereq_,module,exports){\nmodule.exports=_dereq_(20)\n},{\"./ns\":33}],31:[function(_dereq_,module,exports){\nmodule.exports=_dereq_(21)\n},{\"./base\":29}],32:[function(_dereq_,module,exports){\nmodule.exports=_dereq_(22)\n},{\"./factory\":31,\"./ns\":33,\"./properties\":34,\"./registry\":35,\"./types\":36}],33:[function(_dereq_,module,exports){\nmodule.exports=_dereq_(23)\n},{}],34:[function(_dereq_,module,exports){\nmodule.exports=_dereq_(24)\n},{}],35:[function(_dereq_,module,exports){\nmodule.exports=_dereq_(25)\n},{\"./descriptor-builder\":30,\"./ns\":33,\"./types\":36}],36:[function(_dereq_,module,exports){\nmodule.exports=_dereq_(26)\n},{}],37:[function(_dereq_,module,exports){\nmodule.exports={\n  \"name\": \"BPMN20\",\n  \"uri\": \"http://www.omg.org/spec/BPMN/20100524/MODEL\",\n  \"associations\": [],\n  \"types\": [\n    {\n      \"name\": \"Interface\",\n      \"superClass\": [\n        \"RootElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"operations\",\n          \"type\": \"Operation\",\n          \"association\": \"A_operations_interface\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"implementationRef\",\n          \"type\": \"String\",\n          \"isAttr\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Operation\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"inMessageRef\",\n          \"type\": \"Message\",\n          \"association\": \"A_inMessageRef_operation\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"outMessageRef\",\n          \"type\": \"Message\",\n          \"association\": \"A_outMessageRef_operation\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"errorRefs\",\n          \"type\": \"Error\",\n          \"association\": \"A_errorRefs_operation\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"implementationRef\",\n          \"type\": \"String\",\n          \"isAttr\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"EndPoint\",\n      \"superClass\": [\n        \"RootElement\"\n      ]\n    },\n    {\n      \"name\": \"Auditing\",\n      \"superClass\": [\n        \"BaseElement\"\n      ]\n    },\n    {\n      \"name\": \"GlobalTask\",\n      \"superClass\": [\n        \"CallableElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"resources\",\n          \"type\": \"ResourceRole\",\n          \"association\": \"A_resources_globalTask\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Monitoring\",\n      \"superClass\": [\n        \"BaseElement\"\n      ]\n    },\n    {\n      \"name\": \"Performer\",\n      \"superClass\": [\n        \"ResourceRole\"\n      ]\n    },\n    {\n      \"name\": \"Process\",\n      \"superClass\": [\n        \"FlowElementsContainer\",\n        \"CallableElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"processType\",\n          \"type\": \"ProcessType\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"isClosed\",\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"auditing\",\n          \"type\": \"Auditing\",\n          \"association\": \"A_auditing_process\"\n        },\n        {\n          \"name\": \"monitoring\",\n          \"type\": \"Monitoring\",\n          \"association\": \"A_monitoring_process\"\n        },\n        {\n          \"name\": \"properties\",\n          \"type\": \"Property\",\n          \"association\": \"A_properties_process\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"supports\",\n          \"type\": \"Process\",\n          \"association\": \"A_supports_process\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"definitionalCollaborationRef\",\n          \"type\": \"Collaboration\",\n          \"association\": \"A_definitionalCollaborationRef_process\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"isExecutable\",\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"resources\",\n          \"type\": \"ResourceRole\",\n          \"association\": \"A_resources_process\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"artifacts\",\n          \"type\": \"Artifact\",\n          \"association\": \"A_artifacts_process\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"correlationSubscriptions\",\n          \"type\": \"CorrelationSubscription\",\n          \"association\": \"A_correlationSubscriptions_process\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"LaneSet\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"lanes\",\n          \"type\": \"Lane\",\n          \"association\": \"A_lanes_laneSet\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"Lane\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"childLaneSet\",\n          \"type\": \"LaneSet\",\n          \"association\": \"A_childLaneSet_parentLane\"\n        },\n        {\n          \"name\": \"partitionElementRef\",\n          \"type\": \"BaseElement\",\n          \"association\": \"A_partitionElementRef_lane\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"flowNodeRef\",\n          \"type\": \"FlowNode\",\n          \"association\": \"A_flowNodeRefs_lanes\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"partitionElement\",\n          \"type\": \"BaseElement\",\n          \"association\": \"A_partitionElement_lane\"\n        }\n      ]\n    },\n    {\n      \"name\": \"GlobalManualTask\",\n      \"superClass\": [\n        \"GlobalTask\"\n      ]\n    },\n    {\n      \"name\": \"ManualTask\",\n      \"superClass\": [\n        \"Task\"\n      ]\n    },\n    {\n      \"name\": \"UserTask\",\n      \"superClass\": [\n        \"Task\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"renderings\",\n          \"type\": \"Rendering\",\n          \"association\": \"A_renderings_usertask\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"implementation\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"Rendering\",\n      \"superClass\": [\n        \"BaseElement\"\n      ]\n    },\n    {\n      \"name\": \"HumanPerformer\",\n      \"superClass\": [\n        \"Performer\"\n      ]\n    },\n    {\n      \"name\": \"PotentialOwner\",\n      \"superClass\": [\n        \"HumanPerformer\"\n      ]\n    },\n    {\n      \"name\": \"GlobalUserTask\",\n      \"superClass\": [\n        \"GlobalTask\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"implementation\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"renderings\",\n          \"type\": \"Rendering\",\n          \"association\": \"A_renderings_globalUserTask\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Gateway\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"FlowNode\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"gatewayDirection\",\n          \"type\": \"GatewayDirection\",\n          \"default\": \"unspecified\",\n          \"isAttr\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"EventBasedGateway\",\n      \"superClass\": [\n        \"Gateway\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"instantiate\",\n          \"default\": false,\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"eventGatewayType\",\n          \"type\": \"EventBasedGatewayType\",\n          \"isAttr\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ComplexGateway\",\n      \"superClass\": [\n        \"Gateway\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"activationCondition\",\n          \"type\": \"Expression\",\n          \"association\": \"A_activationCondition_complexGateway\"\n        },\n        {\n          \"name\": \"default\",\n          \"type\": \"SequenceFlow\",\n          \"association\": \"A_default_complexGateway\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ExclusiveGateway\",\n      \"superClass\": [\n        \"Gateway\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"default\",\n          \"type\": \"SequenceFlow\",\n          \"association\": \"A_default_exclusiveGateway\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"InclusiveGateway\",\n      \"superClass\": [\n        \"Gateway\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"default\",\n          \"type\": \"SequenceFlow\",\n          \"association\": \"A_default_inclusiveGateway\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ParallelGateway\",\n      \"superClass\": [\n        \"Gateway\"\n      ]\n    },\n    {\n      \"name\": \"RootElement\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"BaseElement\"\n      ]\n    },\n    {\n      \"name\": \"Relationship\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"type\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"direction\",\n          \"type\": \"RelationshipDirection\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"sources\",\n          \"association\": \"A_sources_relationship\",\n          \"isMany\": true,\n          \"isReference\": true,\n          \"type\": \"Element\"\n        },\n        {\n          \"name\": \"targets\",\n          \"association\": \"A_targets_relationship\",\n          \"isMany\": true,\n          \"isReference\": true,\n          \"type\": \"Element\"\n        }\n      ]\n    },\n    {\n      \"name\": \"BaseElement\",\n      \"isAbstract\": true,\n      \"properties\": [\n        {\n          \"name\": \"id\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"extensionDefinitions\",\n          \"type\": \"ExtensionDefinition\",\n          \"association\": \"A_extensionDefinitions_baseElement\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"extensionElements\",\n          \"type\": \"ExtensionElements\",\n          \"association\": \"A_extensionElements_baseElement\"\n        },\n        {\n          \"name\": \"documentation\",\n          \"type\": \"Documentation\",\n          \"association\": \"A_documentation_baseElement\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Extension\",\n      \"properties\": [\n        {\n          \"name\": \"mustUnderstand\",\n          \"default\": false,\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"definition\",\n          \"type\": \"ExtensionDefinition\",\n          \"association\": \"A_definition_extension\"\n        }\n      ]\n    },\n    {\n      \"name\": \"ExtensionDefinition\",\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"extensionAttributeDefinitions\",\n          \"type\": \"ExtensionAttributeDefinition\",\n          \"association\": \"A_extensionAttributeDefinitions_extensionDefinition\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ExtensionAttributeDefinition\",\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"type\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"isReference\",\n          \"default\": false,\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"extensionDefinition\",\n          \"type\": \"ExtensionDefinition\",\n          \"association\": \"A_extensionAttributeDefinitions_extensionDefinition\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ExtensionElements\",\n      \"properties\": [\n        {\n          \"name\": \"valueRef\",\n          \"association\": \"A_valueRef_extensionElements\",\n          \"isAttr\": true,\n          \"isReference\": true,\n          \"type\": \"Element\"\n        },\n        {\n          \"name\": \"values\",\n          \"association\": \"A_value_extensionElements\",\n          \"type\": \"Element\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"extensionAttributeDefinition\",\n          \"type\": \"ExtensionAttributeDefinition\",\n          \"association\": \"A_extensionAttributeDefinition_extensionElements\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Documentation\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"text\",\n          \"isAttr\": true,\n          \"type\": \"String\",\n          \"isBody\": true\n        },\n        {\n          \"name\": \"textFormat\",\n          \"default\": \"text/plain\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"Event\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"FlowNode\",\n        \"InteractionNode\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"properties\",\n          \"type\": \"Property\",\n          \"association\": \"A_properties_event\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"IntermediateCatchEvent\",\n      \"superClass\": [\n        \"CatchEvent\"\n      ]\n    },\n    {\n      \"name\": \"IntermediateThrowEvent\",\n      \"superClass\": [\n        \"ThrowEvent\"\n      ]\n    },\n    {\n      \"name\": \"EndEvent\",\n      \"superClass\": [\n        \"ThrowEvent\"\n      ]\n    },\n    {\n      \"name\": \"StartEvent\",\n      \"superClass\": [\n        \"CatchEvent\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"isInterrupting\",\n          \"default\": true,\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        }\n      ]\n    },\n    {\n      \"name\": \"ThrowEvent\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"Event\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"inputSet\",\n          \"type\": \"InputSet\",\n          \"association\": \"A_inputSet_throwEvent\"\n        },\n        {\n          \"name\": \"eventDefinitionRefs\",\n          \"type\": \"EventDefinition\",\n          \"association\": \"A_eventDefinitionRefs_throwEvent\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"dataInputAssociation\",\n          \"type\": \"DataInputAssociation\",\n          \"association\": \"A_dataInputAssociation_throwEvent\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"dataInputs\",\n          \"type\": \"DataInput\",\n          \"association\": \"A_dataInputs_throwEvent\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"eventDefinitions\",\n          \"type\": \"EventDefinition\",\n          \"association\": \"A_eventDefinitions_throwEvent\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"CatchEvent\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"Event\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"parallelMultiple\",\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"outputSet\",\n          \"type\": \"OutputSet\",\n          \"association\": \"A_outputSet_catchEvent\"\n        },\n        {\n          \"name\": \"eventDefinitionRefs\",\n          \"type\": \"EventDefinition\",\n          \"association\": \"A_eventDefinitionRefs_catchEvent\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"dataOutputAssociation\",\n          \"type\": \"DataOutputAssociation\",\n          \"association\": \"A_dataOutputAssociation_catchEvent\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"dataOutputs\",\n          \"type\": \"DataOutput\",\n          \"association\": \"A_dataOutputs_catchEvent\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"eventDefinitions\",\n          \"type\": \"EventDefinition\",\n          \"association\": \"A_eventDefinitions_catchEvent\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"BoundaryEvent\",\n      \"superClass\": [\n        \"CatchEvent\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"cancelActivity\",\n          \"default\": true,\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"attachedToRef\",\n          \"type\": \"Activity\",\n          \"association\": \"A_boundaryEventRefs_attachedToRef\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"EventDefinition\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"RootElement\"\n      ]\n    },\n    {\n      \"name\": \"CancelEventDefinition\",\n      \"superClass\": [\n        \"EventDefinition\"\n      ]\n    },\n    {\n      \"name\": \"ErrorEventDefinition\",\n      \"superClass\": [\n        \"EventDefinition\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"errorRef\",\n          \"type\": \"Error\",\n          \"association\": \"A_errorRef_errorEventDefinition\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"TerminateEventDefinition\",\n      \"superClass\": [\n        \"EventDefinition\"\n      ]\n    },\n    {\n      \"name\": \"EscalationEventDefinition\",\n      \"superClass\": [\n        \"EventDefinition\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"escalationRef\",\n          \"type\": \"Escalation\",\n          \"association\": \"A_escalationRef_escalationEventDefinition\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Escalation\",\n      \"properties\": [\n        {\n          \"name\": \"structureRef\",\n          \"type\": \"ItemDefinition\",\n          \"association\": \"A_structureRef_escalation\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"escalationCode\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ],\n      \"superClass\": [\n        \"RootElement\"\n      ]\n    },\n    {\n      \"name\": \"CompensateEventDefinition\",\n      \"superClass\": [\n        \"EventDefinition\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"waitForCompletion\",\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"activityRef\",\n          \"type\": \"Activity\",\n          \"association\": \"A_activityRef_compensateEventDefinition\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"TimerEventDefinition\",\n      \"superClass\": [\n        \"EventDefinition\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"timeDate\",\n          \"type\": \"Expression\",\n          \"association\": \"A_timeDate_timerEventDefinition\"\n        },\n        {\n          \"name\": \"timeCycle\",\n          \"type\": \"Expression\",\n          \"association\": \"A_timeCycle_timerEventDefinition\"\n        },\n        {\n          \"name\": \"timeDuration\",\n          \"type\": \"Expression\",\n          \"association\": \"A_timeDuration_timerEventDefinition\"\n        }\n      ]\n    },\n    {\n      \"name\": \"LinkEventDefinition\",\n      \"superClass\": [\n        \"EventDefinition\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"target\",\n          \"type\": \"LinkEventDefinition\",\n          \"association\": \"A_target_source\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"source\",\n          \"type\": \"LinkEventDefinition\",\n          \"association\": \"A_target_source\",\n          \"isMany\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"MessageEventDefinition\",\n      \"superClass\": [\n        \"EventDefinition\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"messageRef\",\n          \"type\": \"Message\",\n          \"association\": \"A_messageRef_messageEventDefinition\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"operationRef\",\n          \"type\": \"Operation\",\n          \"association\": \"A_operationRef_messageEventDefinition\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ConditionalEventDefinition\",\n      \"superClass\": [\n        \"EventDefinition\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"condition\",\n          \"type\": \"Expression\",\n          \"association\": \"A_condition_conditionalEventDefinition\",\n          \"serialize\": \"xsi:type\"\n        }\n      ]\n    },\n    {\n      \"name\": \"SignalEventDefinition\",\n      \"superClass\": [\n        \"EventDefinition\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"signalRef\",\n          \"type\": \"Signal\",\n          \"association\": \"A_signalRef_signalEventDefinition\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Signal\",\n      \"superClass\": [\n        \"RootElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"structureRef\",\n          \"type\": \"ItemDefinition\",\n          \"association\": \"A_structureRef_signal\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"ImplicitThrowEvent\",\n      \"superClass\": [\n        \"ThrowEvent\"\n      ]\n    },\n    {\n      \"name\": \"DataState\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"ItemAwareElement\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"itemSubjectRef\",\n          \"type\": \"ItemDefinition\",\n          \"association\": \"A_itemSubjectRef_itemAwareElement\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"dataState\",\n          \"type\": \"DataState\",\n          \"association\": \"A_dataState_itemAwareElement\"\n        }\n      ]\n    },\n    {\n      \"name\": \"DataAssociation\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"transformation\",\n          \"type\": \"FormalExpression\",\n          \"association\": \"A_transformation_dataAssociation\"\n        },\n        {\n          \"name\": \"assignment\",\n          \"type\": \"Assignment\",\n          \"association\": \"A_assignment_dataAssociation\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"sourceRef\",\n          \"type\": \"ItemAwareElement\",\n          \"association\": \"A_sourceRef_dataAssociation\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"targetRef\",\n          \"type\": \"ItemAwareElement\",\n          \"association\": \"A_targetRef_dataAssociation\",\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"DataInput\",\n      \"superClass\": [\n        \"ItemAwareElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"isCollection\",\n          \"default\": false,\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"inputSetRefs\",\n          \"type\": \"InputSet\",\n          \"association\": \"A_dataInputRefs_inputSetRefs\",\n          \"isVirtual\": true,\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"inputSetWithOptional\",\n          \"type\": \"InputSet\",\n          \"association\": \"A_optionalInputRefs_inputSetWithOptional\",\n          \"isVirtual\": true,\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"inputSetWithWhileExecuting\",\n          \"type\": \"InputSet\",\n          \"association\": \"A_whileExecutingInputRefs_inputSetWithWhileExecuting\",\n          \"isVirtual\": true,\n          \"isMany\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"DataOutput\",\n      \"superClass\": [\n        \"ItemAwareElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"isCollection\",\n          \"default\": false,\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"outputSetRefs\",\n          \"type\": \"OutputSet\",\n          \"association\": \"A_dataOutputRefs_outputSetRefs\",\n          \"isVirtual\": true,\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"outputSetWithOptional\",\n          \"type\": \"OutputSet\",\n          \"association\": \"A_outputSetWithOptional_optionalOutputRefs\",\n          \"isVirtual\": true,\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"outputSetWithWhileExecuting\",\n          \"type\": \"OutputSet\",\n          \"association\": \"A_outputSetWithWhileExecuting_whileExecutingOutputRefs\",\n          \"isVirtual\": true,\n          \"isMany\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"InputSet\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"dataInputRefs\",\n          \"type\": \"DataInput\",\n          \"association\": \"A_dataInputRefs_inputSetRefs\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"optionalInputRefs\",\n          \"type\": \"DataInput\",\n          \"association\": \"A_optionalInputRefs_inputSetWithOptional\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"whileExecutingInputRefs\",\n          \"type\": \"DataInput\",\n          \"association\": \"A_whileExecutingInputRefs_inputSetWithWhileExecuting\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"outputSetRefs\",\n          \"type\": \"OutputSet\",\n          \"association\": \"A_inputSetRefs_outputSetRefs\",\n          \"isMany\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"OutputSet\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"dataOutputRefs\",\n          \"type\": \"DataOutput\",\n          \"association\": \"A_dataOutputRefs_outputSetRefs\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"inputSetRefs\",\n          \"type\": \"InputSet\",\n          \"association\": \"A_inputSetRefs_outputSetRefs\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"optionalOutputRefs\",\n          \"type\": \"DataOutput\",\n          \"association\": \"A_outputSetWithOptional_optionalOutputRefs\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"whileExecutingOutputRefs\",\n          \"type\": \"DataOutput\",\n          \"association\": \"A_outputSetWithWhileExecuting_whileExecutingOutputRefs\",\n          \"isMany\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Property\",\n      \"superClass\": [\n        \"ItemAwareElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"DataInputAssociation\",\n      \"superClass\": [\n        \"DataAssociation\"\n      ]\n    },\n    {\n      \"name\": \"DataOutputAssociation\",\n      \"superClass\": [\n        \"DataAssociation\"\n      ]\n    },\n    {\n      \"name\": \"InputOutputSpecification\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"inputSets\",\n          \"type\": \"InputSet\",\n          \"association\": \"A_inputSets_inputOutputSpecification\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"outputSets\",\n          \"type\": \"OutputSet\",\n          \"association\": \"A_outputSets_inputOutputSpecification\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"dataInputs\",\n          \"type\": \"DataInput\",\n          \"association\": \"A_dataInputs_inputOutputSpecification\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"dataOutputs\",\n          \"type\": \"DataOutput\",\n          \"association\": \"A_dataOutputs_inputOutputSpecification\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"DataObject\",\n      \"superClass\": [\n        \"FlowElement\",\n        \"ItemAwareElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"isCollection\",\n          \"default\": false,\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        }\n      ]\n    },\n    {\n      \"name\": \"InputOutputBinding\",\n      \"properties\": [\n        {\n          \"name\": \"inputDataRef\",\n          \"type\": \"InputSet\",\n          \"association\": \"A_inputDataRef_inputOutputBinding\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"outputDataRef\",\n          \"type\": \"OutputSet\",\n          \"association\": \"A_outputDataRef_inputOutputBinding\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"operationRef\",\n          \"type\": \"Operation\",\n          \"association\": \"A_operationRef_ioBinding\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Assignment\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"from\",\n          \"type\": \"Expression\",\n          \"association\": \"A_from_assignment\"\n        },\n        {\n          \"name\": \"to\",\n          \"type\": \"Expression\",\n          \"association\": \"A_to_assignment\"\n        }\n      ]\n    },\n    {\n      \"name\": \"DataStore\",\n      \"superClass\": [\n        \"RootElement\",\n        \"ItemAwareElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"capacity\",\n          \"isAttr\": true,\n          \"type\": \"Integer\"\n        },\n        {\n          \"name\": \"isUnlimited\",\n          \"default\": true,\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        }\n      ]\n    },\n    {\n      \"name\": \"DataStoreReference\",\n      \"superClass\": [\n        \"ItemAwareElement\",\n        \"FlowElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"dataStoreRef\",\n          \"type\": \"DataStore\",\n          \"association\": \"A_dataStoreRef_dataStoreReference\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"DataObjectReference\",\n      \"superClass\": [\n        \"ItemAwareElement\",\n        \"FlowElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"dataObjectRef\",\n          \"type\": \"DataObject\",\n          \"association\": \"A_dataObjectRef_dataObject\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ConversationLink\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"sourceRef\",\n          \"type\": \"InteractionNode\",\n          \"association\": \"A_sourceRef_outgoingConversationLinks\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"targetRef\",\n          \"type\": \"InteractionNode\",\n          \"association\": \"A_targetRef_incomingConversationLinks\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"ConversationAssociation\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"innerConversationNodeRef\",\n          \"type\": \"ConversationNode\",\n          \"association\": \"A_innerConversationNodeRef_conversationAssociation\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"outerConversationNodeRef\",\n          \"type\": \"ConversationNode\",\n          \"association\": \"A_outerConversationNodeRef_conversationAssociation\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"CallConversation\",\n      \"superClass\": [\n        \"ConversationNode\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"calledCollaborationRef\",\n          \"type\": \"Collaboration\",\n          \"association\": \"A_calledCollaborationRef_callConversation\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"participantAssociations\",\n          \"type\": \"ParticipantAssociation\",\n          \"association\": \"A_participantAssociations_callConversation\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Conversation\",\n      \"superClass\": [\n        \"ConversationNode\"\n      ]\n    },\n    {\n      \"name\": \"SubConversation\",\n      \"superClass\": [\n        \"ConversationNode\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"conversationNodes\",\n          \"type\": \"ConversationNode\",\n          \"association\": \"A_conversationNodes_subConversation\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ConversationNode\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"InteractionNode\",\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"participantRefs\",\n          \"type\": \"Participant\",\n          \"association\": \"A_participantRefs_conversationNode\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"messageFlowRefs\",\n          \"type\": \"MessageFlow\",\n          \"association\": \"A_messageFlowRefs_communication\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"correlationKeys\",\n          \"type\": \"CorrelationKey\",\n          \"association\": \"A_correlationKeys_conversationNode\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"GlobalConversation\",\n      \"superClass\": [\n        \"Collaboration\"\n      ]\n    },\n    {\n      \"name\": \"PartnerEntity\",\n      \"superClass\": [\n        \"RootElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"participantRef\",\n          \"type\": \"Participant\",\n          \"association\": \"A_partnerEntityRef_participantRef\",\n          \"isMany\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"PartnerRole\",\n      \"superClass\": [\n        \"RootElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"participantRef\",\n          \"type\": \"Participant\",\n          \"association\": \"A_partnerRoleRef_participantRef\",\n          \"isMany\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"CorrelationProperty\",\n      \"superClass\": [\n        \"RootElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"correlationPropertyRetrievalExpression\",\n          \"type\": \"CorrelationPropertyRetrievalExpression\",\n          \"association\": \"A_correlationPropertyRetrievalExpression_correlationproperty\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"type\",\n          \"type\": \"ItemDefinition\",\n          \"association\": \"A_type_correlationProperty\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Error\",\n      \"superClass\": [\n        \"RootElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"structureRef\",\n          \"type\": \"ItemDefinition\",\n          \"association\": \"A_structureRef_error\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"errorCode\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"CorrelationKey\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"correlationPropertyRef\",\n          \"type\": \"CorrelationProperty\",\n          \"association\": \"A_correlationPropertyRef_correlationKey\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"Expression\",\n      \"superClass\": [\n        \"BaseElement\"\n      ]\n    },\n    {\n      \"name\": \"FormalExpression\",\n      \"superClass\": [\n        \"Expression\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"language\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"body\",\n          \"type\": \"Element\"\n        },\n        {\n          \"name\": \"evaluatesToTypeRef\",\n          \"type\": \"ItemDefinition\",\n          \"association\": \"A_evaluatesToTypeRef_formalExpression\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Message\",\n      \"superClass\": [\n        \"RootElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"itemRef\",\n          \"type\": \"ItemDefinition\",\n          \"association\": \"A_itemRef_message\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ItemDefinition\",\n      \"superClass\": [\n        \"RootElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"itemKind\",\n          \"type\": \"ItemKind\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"structureRef\",\n          \"type\": \"String\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"isCollection\",\n          \"default\": false,\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"import\",\n          \"type\": \"Import\",\n          \"association\": \"A_import_itemDefinition\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"FlowElement\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"auditing\",\n          \"type\": \"Auditing\",\n          \"association\": \"A_auditing_flowElement\"\n        },\n        {\n          \"name\": \"monitoring\",\n          \"type\": \"Monitoring\",\n          \"association\": \"A_monitoring_flowElement\"\n        },\n        {\n          \"name\": \"categoryValueRef\",\n          \"type\": \"CategoryValue\",\n          \"association\": \"A_categorizedFlowElements_categoryValueRef\",\n          \"isMany\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"SequenceFlow\",\n      \"superClass\": [\n        \"FlowElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"isImmediate\",\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"conditionExpression\",\n          \"type\": \"Expression\",\n          \"association\": \"A_conditionExpression_sequenceFlow\"\n        },\n        {\n          \"name\": \"sourceRef\",\n          \"type\": \"FlowNode\",\n          \"association\": \"A_sourceRef_outgoing_flow\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"targetRef\",\n          \"type\": \"FlowNode\",\n          \"association\": \"A_targetRef_incoming_flow\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"FlowElementsContainer\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"laneSets\",\n          \"type\": \"LaneSet\",\n          \"association\": \"A_laneSets_flowElementsContainer\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"flowElements\",\n          \"type\": \"FlowElement\",\n          \"association\": \"A_flowElements_container\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"CallableElement\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"RootElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"ioSpecification\",\n          \"type\": \"InputOutputSpecification\",\n          \"association\": \"A_ioSpecification_callableElement\"\n        },\n        {\n          \"name\": \"supportedInterfaceRefs\",\n          \"type\": \"Interface\",\n          \"association\": \"A_supportedInterfaceRefs_callableElements\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"ioBinding\",\n          \"type\": \"InputOutputBinding\",\n          \"association\": \"A_ioBinding_callableElement\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"FlowNode\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"FlowElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"incoming\",\n          \"type\": \"SequenceFlow\",\n          \"association\": \"A_targetRef_incoming_flow\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"outgoing\",\n          \"type\": \"SequenceFlow\",\n          \"association\": \"A_sourceRef_outgoing_flow\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"lanes\",\n          \"type\": \"Lane\",\n          \"association\": \"A_flowNodeRefs_lanes\",\n          \"isVirtual\": true,\n          \"isMany\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"CorrelationPropertyRetrievalExpression\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"messagePath\",\n          \"type\": \"FormalExpression\",\n          \"association\": \"A_messagePath_correlationset\"\n        },\n        {\n          \"name\": \"messageRef\",\n          \"type\": \"Message\",\n          \"association\": \"A_messageRef_correlationPropertyRetrievalExpression\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"CorrelationPropertyBinding\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"dataPath\",\n          \"type\": \"FormalExpression\",\n          \"association\": \"A_dataPath_correlationPropertyBinding\"\n        },\n        {\n          \"name\": \"correlationPropertyRef\",\n          \"type\": \"CorrelationProperty\",\n          \"association\": \"A_correlationPropertyRef_correlationPropertyBinding\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Resource\",\n      \"superClass\": [\n        \"RootElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"resourceParameters\",\n          \"type\": \"ResourceParameter\",\n          \"association\": \"A_resourceParameters_resource\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ResourceParameter\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"isRequired\",\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"type\",\n          \"type\": \"ItemDefinition\",\n          \"association\": \"A_type_resourceParameter\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"CorrelationSubscription\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"correlationKeyRef\",\n          \"type\": \"CorrelationKey\",\n          \"association\": \"A_correlationKeyRef_correlationSubscription\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"correlationPropertyBinding\",\n          \"type\": \"CorrelationPropertyBinding\",\n          \"association\": \"A_correlationPropertyBinding_correlationSubscription\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"MessageFlow\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"sourceRef\",\n          \"type\": \"InteractionNode\",\n          \"association\": \"A_sourceRef_messageFlow\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"targetRef\",\n          \"type\": \"InteractionNode\",\n          \"association\": \"A_targetRef_messageFlow\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"messageRef\",\n          \"type\": \"Message\",\n          \"association\": \"A_messageRef_messageFlow\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"MessageFlowAssociation\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"innerMessageFlowRef\",\n          \"type\": \"MessageFlow\",\n          \"association\": \"A_innerMessageFlowRef_messageFlowAssociation\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"outerMessageFlowRef\",\n          \"type\": \"MessageFlow\",\n          \"association\": \"A_outerMessageFlowRef_messageFlowAssociation\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"InteractionNode\",\n      \"isAbstract\": true,\n      \"properties\": [\n        {\n          \"name\": \"incomingConversationLinks\",\n          \"type\": \"ConversationLink\",\n          \"association\": \"A_targetRef_incomingConversationLinks\",\n          \"isVirtual\": true,\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"outgoingConversationLinks\",\n          \"type\": \"ConversationLink\",\n          \"association\": \"A_sourceRef_outgoingConversationLinks\",\n          \"isVirtual\": true,\n          \"isMany\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Participant\",\n      \"superClass\": [\n        \"InteractionNode\",\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"interfaceRefs\",\n          \"type\": \"Interface\",\n          \"association\": \"A_interfaceRefs_participant\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"participantMultiplicity\",\n          \"type\": \"ParticipantMultiplicity\",\n          \"association\": \"A_participantMultiplicity_participant\"\n        },\n        {\n          \"name\": \"endPointRefs\",\n          \"type\": \"EndPoint\",\n          \"association\": \"A_endPointRefs_participant\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"processRef\",\n          \"type\": \"Process\",\n          \"association\": \"A_processRef_participant\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ParticipantAssociation\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"innerParticipantRef\",\n          \"type\": \"Participant\",\n          \"association\": \"A_innerParticipantRef_participantAssociation\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"outerParticipantRef\",\n          \"type\": \"Participant\",\n          \"association\": \"A_outerParticipantRef_participantAssociation\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ParticipantMultiplicity\",\n      \"properties\": [\n        {\n          \"name\": \"minimum\",\n          \"default\": \"0\",\n          \"isAttr\": true,\n          \"type\": \"Integer\"\n        },\n        {\n          \"name\": \"maximum\",\n          \"default\": \"1\",\n          \"isAttr\": true,\n          \"type\": \"Integer\"\n        }\n      ]\n    },\n    {\n      \"name\": \"Collaboration\",\n      \"superClass\": [\n        \"RootElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"isClosed\",\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"choreographyRef\",\n          \"type\": \"Choreography\",\n          \"association\": \"A_choreographyRef_collaboration\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"artifacts\",\n          \"type\": \"Artifact\",\n          \"association\": \"A_artifacts_collaboration\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"participantAssociations\",\n          \"type\": \"ParticipantAssociation\",\n          \"association\": \"A_participantAssociations_collaboration\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"messageFlowAssociations\",\n          \"type\": \"MessageFlowAssociation\",\n          \"association\": \"A_messageFlowAssociations_collaboration\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"conversationAssociations\",\n          \"type\": \"ConversationAssociation\",\n          \"association\": \"A_conversationAssociations_converstaionAssociations\"\n        },\n        {\n          \"name\": \"participants\",\n          \"type\": \"Participant\",\n          \"association\": \"A_participants_collaboration\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"messageFlows\",\n          \"type\": \"MessageFlow\",\n          \"association\": \"A_messageFlows_collaboration\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"correlationKeys\",\n          \"type\": \"CorrelationKey\",\n          \"association\": \"A_correlationKeys_collaboration\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"conversations\",\n          \"type\": \"ConversationNode\",\n          \"association\": \"A_conversations_collaboration\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"conversationLinks\",\n          \"type\": \"ConversationLink\",\n          \"association\": \"A_conversationLinks_collaboration\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ChoreographyActivity\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"FlowNode\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"participantRefs\",\n          \"type\": \"Participant\",\n          \"association\": \"A_participantRefs_choreographyActivity\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"initiatingParticipantRef\",\n          \"type\": \"Participant\",\n          \"association\": \"A_initiatingParticipantRef_choreographyActivity\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"correlationKeys\",\n          \"type\": \"CorrelationKey\",\n          \"association\": \"A_correlationKeys_choreographyActivity\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"loopType\",\n          \"type\": \"ChoreographyLoopType\",\n          \"default\": \"None\",\n          \"isAttr\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"CallChoreography\",\n      \"superClass\": [\n        \"ChoreographyActivity\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"calledChoreographyRef\",\n          \"type\": \"Choreography\",\n          \"association\": \"A_calledChoreographyRef_callChoreographyActivity\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"participantAssociations\",\n          \"type\": \"ParticipantAssociation\",\n          \"association\": \"A_participantAssociations_callChoreographyActivity\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"SubChoreography\",\n      \"superClass\": [\n        \"ChoreographyActivity\",\n        \"FlowElementsContainer\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"artifacts\",\n          \"type\": \"Artifact\",\n          \"association\": \"A_artifacts_subChoreography\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ChoreographyTask\",\n      \"superClass\": [\n        \"ChoreographyActivity\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"messageFlowRef\",\n          \"type\": \"MessageFlow\",\n          \"association\": \"A_messageFlowRef_choreographyTask\",\n          \"isMany\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Choreography\",\n      \"superClass\": [\n        \"FlowElementsContainer\",\n        \"Collaboration\"\n      ]\n    },\n    {\n      \"name\": \"GlobalChoreographyTask\",\n      \"superClass\": [\n        \"Choreography\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"initiatingParticipantRef\",\n          \"type\": \"Participant\",\n          \"association\": \"A_initiatingParticipantRef_globalChoreographyTask\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"TextAnnotation\",\n      \"superClass\": [\n        \"Artifact\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"text\",\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"textFormat\",\n          \"default\": \"text/plain\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"Group\",\n      \"superClass\": [\n        \"Artifact\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"categoryValueRef\",\n          \"type\": \"CategoryValue\",\n          \"association\": \"A_categoryValueRef_categoryValueRef\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Association\",\n      \"superClass\": [\n        \"Artifact\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"associationDirection\",\n          \"type\": \"AssociationDirection\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"sourceRef\",\n          \"type\": \"BaseElement\",\n          \"association\": \"A_sourceRef_outgoing_association\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"targetRef\",\n          \"type\": \"BaseElement\",\n          \"association\": \"A_targetRef_incoming_association\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Category\",\n      \"superClass\": [\n        \"RootElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"categoryValue\",\n          \"type\": \"CategoryValue\",\n          \"association\": \"A_categoryValue_category\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"Artifact\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"BaseElement\"\n      ]\n    },\n    {\n      \"name\": \"CategoryValue\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"categorizedFlowElements\",\n          \"type\": \"FlowElement\",\n          \"association\": \"A_categorizedFlowElements_categoryValueRef\",\n          \"isVirtual\": true,\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"value\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"Activity\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"FlowNode\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"isForCompensation\",\n          \"default\": false,\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"loopCharacteristics\",\n          \"type\": \"LoopCharacteristics\",\n          \"association\": \"A_loopCharacteristics_activity\"\n        },\n        {\n          \"name\": \"resources\",\n          \"type\": \"ResourceRole\",\n          \"association\": \"A_resources_activity\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"default\",\n          \"type\": \"SequenceFlow\",\n          \"association\": \"A_default_activity\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"properties\",\n          \"type\": \"Property\",\n          \"association\": \"A_properties_activity\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"ioSpecification\",\n          \"type\": \"InputOutputSpecification\",\n          \"association\": \"A_ioSpecification_activity\"\n        },\n        {\n          \"name\": \"boundaryEventRefs\",\n          \"type\": \"BoundaryEvent\",\n          \"association\": \"A_boundaryEventRefs_attachedToRef\",\n          \"isMany\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"dataInputAssociations\",\n          \"type\": \"DataInputAssociation\",\n          \"association\": \"A_dataInputAssociations_activity\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"dataOutputAssociations\",\n          \"type\": \"DataOutputAssociation\",\n          \"association\": \"A_dataOutputAssociations_activity\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"startQuantity\",\n          \"default\": \"1\",\n          \"isAttr\": true,\n          \"type\": \"Integer\"\n        },\n        {\n          \"name\": \"completionQuantity\",\n          \"default\": \"1\",\n          \"isAttr\": true,\n          \"type\": \"Integer\"\n        }\n      ]\n    },\n    {\n      \"name\": \"ServiceTask\",\n      \"superClass\": [\n        \"Task\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"implementation\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"operationRef\",\n          \"type\": \"Operation\",\n          \"association\": \"A_operationRef_serviceTask\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"SubProcess\",\n      \"superClass\": [\n        \"Activity\",\n        \"FlowElementsContainer\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"triggeredByEvent\",\n          \"default\": false,\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"artifacts\",\n          \"type\": \"Artifact\",\n          \"association\": \"A_artifacts_subProcess\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"LoopCharacteristics\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"BaseElement\"\n      ]\n    },\n    {\n      \"name\": \"MultiInstanceLoopCharacteristics\",\n      \"superClass\": [\n        \"LoopCharacteristics\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"isSequential\",\n          \"default\": false,\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"behavior\",\n          \"type\": \"MultiInstanceBehavior\",\n          \"default\": \"All\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"loopCardinality\",\n          \"type\": \"Expression\",\n          \"association\": \"A_loopCardinality_multiInstanceLoopCharacteristics\"\n        },\n        {\n          \"name\": \"loopDataInputRef\",\n          \"type\": \"ItemAwareElement\",\n          \"association\": \"A_loopDataInputRef_multiInstanceLoopCharacteristics\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"loopDataOutputRef\",\n          \"type\": \"ItemAwareElement\",\n          \"association\": \"A_loopDataOutputRef_multiInstanceLoopCharacteristics\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"inputDataItem\",\n          \"type\": \"DataInput\",\n          \"association\": \"A_inputDataItem_multiInstanceLoopCharacteristics\"\n        },\n        {\n          \"name\": \"outputDataItem\",\n          \"type\": \"DataOutput\",\n          \"association\": \"A_outputDataItem_multiInstanceLoopCharacteristics\"\n        },\n        {\n          \"name\": \"completionCondition\",\n          \"type\": \"Expression\",\n          \"association\": \"A_completionCondition_multiInstanceLoopCharacteristics\"\n        },\n        {\n          \"name\": \"complexBehaviorDefinition\",\n          \"type\": \"ComplexBehaviorDefinition\",\n          \"association\": \"A_complexBehaviorDefinition_multiInstanceLoopCharacteristics\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"oneBehaviorEventRef\",\n          \"type\": \"EventDefinition\",\n          \"association\": \"A_oneBehaviorEventRef_multiInstanceLoopCharacteristics\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"noneBehaviorEventRef\",\n          \"type\": \"EventDefinition\",\n          \"association\": \"A_noneBehaviorEventRef_multiInstanceLoopCharacteristics\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"StandardLoopCharacteristics\",\n      \"superClass\": [\n        \"LoopCharacteristics\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"testBefore\",\n          \"default\": false,\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"loopCondition\",\n          \"type\": \"Expression\",\n          \"association\": \"A_loopCondition_standardLoopCharacteristics\"\n        },\n        {\n          \"name\": \"loopMaximum\",\n          \"type\": \"Expression\",\n          \"association\": \"A_loopMaximum_standardLoopCharacteristics\"\n        }\n      ]\n    },\n    {\n      \"name\": \"CallActivity\",\n      \"superClass\": [\n        \"Activity\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"calledElement\",\n          \"type\": \"String\",\n          \"association\": \"A_calledElementRef_callActivity\",\n          \"isAttr\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Task\",\n      \"superClass\": [\n        \"Activity\",\n        \"InteractionNode\"\n      ]\n    },\n    {\n      \"name\": \"SendTask\",\n      \"superClass\": [\n        \"Task\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"implementation\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"operationRef\",\n          \"type\": \"Operation\",\n          \"association\": \"A_operationRef_sendTask\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"messageRef\",\n          \"type\": \"Message\",\n          \"association\": \"A_messageRef_sendTask\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ReceiveTask\",\n      \"superClass\": [\n        \"Task\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"implementation\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"instantiate\",\n          \"default\": false,\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"operationRef\",\n          \"type\": \"Operation\",\n          \"association\": \"A_operationRef_receiveTask\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"messageRef\",\n          \"type\": \"Message\",\n          \"association\": \"A_messageRef_receiveTask\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ScriptTask\",\n      \"superClass\": [\n        \"Task\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"scriptFormat\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"script\",\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"BusinessRuleTask\",\n      \"superClass\": [\n        \"Task\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"implementation\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"AdHocSubProcess\",\n      \"superClass\": [\n        \"SubProcess\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"completionCondition\",\n          \"type\": \"Expression\",\n          \"association\": \"A_completionCondition_adHocSubProcess\"\n        },\n        {\n          \"name\": \"ordering\",\n          \"type\": \"AdHocOrdering\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"cancelRemainingInstances\",\n          \"default\": true,\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        }\n      ]\n    },\n    {\n      \"name\": \"Transaction\",\n      \"superClass\": [\n        \"SubProcess\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"protocol\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"method\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"GlobalScriptTask\",\n      \"superClass\": [\n        \"GlobalTask\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"scriptLanguage\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"script\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"GlobalBusinessRuleTask\",\n      \"superClass\": [\n        \"GlobalTask\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"implementation\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"ComplexBehaviorDefinition\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"condition\",\n          \"type\": \"FormalExpression\",\n          \"association\": \"A_condition_complexBehaviorDefinition\"\n        },\n        {\n          \"name\": \"event\",\n          \"type\": \"ImplicitThrowEvent\",\n          \"association\": \"A_event_complexBehaviorDefinition\"\n        }\n      ]\n    },\n    {\n      \"name\": \"ResourceRole\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"resourceRef\",\n          \"type\": \"Resource\",\n          \"association\": \"A_resourceRef_activityResource\",\n          \"isAttr\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"resourceParameterBindings\",\n          \"type\": \"ResourceParameterBinding\",\n          \"association\": \"A_resourceParameterBindings_activityResource\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"resourceAssignmentExpression\",\n          \"type\": \"ResourceAssignmentExpression\",\n          \"association\": \"A_resourceAssignmentExpression_activityResource\"\n        },\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"ResourceParameterBinding\",\n      \"properties\": [\n        {\n          \"name\": \"expression\",\n          \"type\": \"Expression\",\n          \"association\": \"A_expression_resourceParameterBinding\"\n        },\n        {\n          \"name\": \"parameterRef\",\n          \"type\": \"ResourceParameter\",\n          \"association\": \"A_parameterRef_resourceParameterBinding\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"ResourceAssignmentExpression\",\n      \"properties\": [\n        {\n          \"name\": \"expression\",\n          \"type\": \"Expression\",\n          \"association\": \"A_expression_resourceAssignmentExpression\"\n        }\n      ]\n    },\n    {\n      \"name\": \"Import\",\n      \"properties\": [\n        {\n          \"name\": \"importType\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"location\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"namespace\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    },\n    {\n      \"name\": \"Definitions\",\n      \"superClass\": [\n        \"BaseElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"targetNamespace\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"expressionLanguage\",\n          \"default\": \"http://www.w3.org/1999/XPath\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"typeLanguage\",\n          \"default\": \"http://www.w3.org/2001/XMLSchema\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"imports\",\n          \"type\": \"Import\",\n          \"association\": \"A_imports_definition\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"extensions\",\n          \"type\": \"Extension\",\n          \"association\": \"A_extensions_definitions\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"relationships\",\n          \"type\": \"Relationship\",\n          \"association\": \"A_relationships_definition\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"rootElements\",\n          \"type\": \"RootElement\",\n          \"association\": \"A_rootElements_definition\",\n          \"isMany\": true\n        },\n        {\n          \"name\": \"diagrams\",\n          \"association\": \"A_diagrams_definitions\",\n          \"isMany\": true,\n          \"type\": \"bpmndi:BPMNDiagram\"\n        },\n        {\n          \"name\": \"exporter\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"exporterVersion\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        }\n      ]\n    }\n  ],\n  \"emumerations\": [\n    {\n      \"name\": \"ProcessType\",\n      \"literalValues\": [\n        {\n          \"name\": \"None\"\n        },\n        {\n          \"name\": \"Public\"\n        },\n        {\n          \"name\": \"Private\"\n        }\n      ]\n    },\n    {\n      \"name\": \"GatewayDirection\",\n      \"literalValues\": [\n        {\n          \"name\": \"Unspecified\"\n        },\n        {\n          \"name\": \"Converging\"\n        },\n        {\n          \"name\": \"Diverging\"\n        },\n        {\n          \"name\": \"Mixed\"\n        }\n      ]\n    },\n    {\n      \"name\": \"EventBasedGatewayType\",\n      \"literalValues\": [\n        {\n          \"name\": \"Parallel\"\n        },\n        {\n          \"name\": \"Exclusive\"\n        }\n      ]\n    },\n    {\n      \"name\": \"RelationshipDirection\",\n      \"literalValues\": [\n        {\n          \"name\": \"None\"\n        },\n        {\n          \"name\": \"Forward\"\n        },\n        {\n          \"name\": \"Backward\"\n        },\n        {\n          \"name\": \"Both\"\n        }\n      ]\n    },\n    {\n      \"name\": \"ItemKind\",\n      \"literalValues\": [\n        {\n          \"name\": \"Physical\"\n        },\n        {\n          \"name\": \"Information\"\n        }\n      ]\n    },\n    {\n      \"name\": \"ChoreographyLoopType\",\n      \"literalValues\": [\n        {\n          \"name\": \"None\"\n        },\n        {\n          \"name\": \"Standard\"\n        },\n        {\n          \"name\": \"MultiInstanceSequential\"\n        },\n        {\n          \"name\": \"MultiInstanceParallel\"\n        }\n      ]\n    },\n    {\n      \"name\": \"AssociationDirection\",\n      \"literalValues\": [\n        {\n          \"name\": \"None\"\n        },\n        {\n          \"name\": \"One\"\n        },\n        {\n          \"name\": \"Both\"\n        }\n      ]\n    },\n    {\n      \"name\": \"MultiInstanceBehavior\",\n      \"literalValues\": [\n        {\n          \"name\": \"None\"\n        },\n        {\n          \"name\": \"One\"\n        },\n        {\n          \"name\": \"All\"\n        },\n        {\n          \"name\": \"Complex\"\n        }\n      ]\n    },\n    {\n      \"name\": \"AdHocOrdering\",\n      \"literalValues\": [\n        {\n          \"name\": \"Parallel\"\n        },\n        {\n          \"name\": \"Sequential\"\n        }\n      ]\n    }\n  ],\n  \"prefix\": \"bpmn\",\n  \"xml\": {\n    \"alias\": \"lowerCase\"\n  }\n}\n},{}],38:[function(_dereq_,module,exports){\nmodule.exports={\n  \"name\": \"BPMNDI\",\n  \"uri\": \"http://www.omg.org/spec/BPMN/20100524/DI\",\n  \"types\": [\n    {\n      \"name\": \"BPMNDiagram\",\n      \"properties\": [\n        {\n          \"name\": \"plane\",\n          \"type\": \"BPMNPlane\",\n          \"association\": \"A_plane_diagram\",\n          \"redefines\": \"di:Diagram#rootElement\"\n        },\n        {\n          \"name\": \"labelStyle\",\n          \"type\": \"BPMNLabelStyle\",\n          \"association\": \"A_labelStyle_diagram\",\n          \"isMany\": true\n        }\n      ],\n      \"superClass\": [\n        \"di:Diagram\"\n      ]\n    },\n    {\n      \"name\": \"BPMNPlane\",\n      \"properties\": [\n        {\n          \"name\": \"bpmnElement\",\n          \"association\": \"A_bpmnElement_plane\",\n          \"isAttr\": true,\n          \"isReference\": true,\n          \"type\": \"bpmn:BaseElement\",\n          \"redefines\": \"di:DiagramElement#modelElement\"\n        }\n      ],\n      \"superClass\": [\n        \"di:Plane\"\n      ]\n    },\n    {\n      \"name\": \"BPMNShape\",\n      \"properties\": [\n        {\n          \"name\": \"bpmnElement\",\n          \"association\": \"A_bpmnElement_shape\",\n          \"isAttr\": true,\n          \"isReference\": true,\n          \"type\": \"bpmn:BaseElement\",\n          \"redefines\": \"di:DiagramElement#modelElement\"\n        },\n        {\n          \"name\": \"isHorizontal\",\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"isExpanded\",\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"isMarkerVisible\",\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"label\",\n          \"type\": \"BPMNLabel\",\n          \"association\": \"A_label_shape\"\n        },\n        {\n          \"name\": \"isMessageVisible\",\n          \"isAttr\": true,\n          \"type\": \"Boolean\"\n        },\n        {\n          \"name\": \"participantBandKind\",\n          \"type\": \"ParticipantBandKind\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"choreographyActivityShape\",\n          \"type\": \"BPMNShape\",\n          \"association\": \"A_choreographyActivityShape_participantBandShape\",\n          \"isAttr\": true,\n          \"isReference\": true\n        }\n      ],\n      \"superClass\": [\n        \"di:LabeledShape\"\n      ]\n    },\n    {\n      \"name\": \"BPMNEdge\",\n      \"properties\": [\n        {\n          \"name\": \"label\",\n          \"type\": \"BPMNLabel\",\n          \"association\": \"A_label_edge\"\n        },\n        {\n          \"name\": \"bpmnElement\",\n          \"association\": \"A_bpmnElement_edge\",\n          \"isAttr\": true,\n          \"isReference\": true,\n          \"type\": \"bpmn:BaseElement\",\n          \"redefines\": \"di:DiagramElement#modelElement\"\n        },\n        {\n          \"name\": \"sourceElement\",\n          \"association\": \"A_sourceElement_sourceEdge\",\n          \"isAttr\": true,\n          \"isReference\": true,\n          \"type\": \"di:DiagramElement\",\n          \"redefines\": \"di:Edge#source\"\n        },\n        {\n          \"name\": \"targetElement\",\n          \"association\": \"A_targetElement_targetEdge\",\n          \"isAttr\": true,\n          \"isReference\": true,\n          \"type\": \"di:DiagramElement\",\n          \"redefines\": \"di:Edge#target\"\n        },\n        {\n          \"name\": \"messageVisibleKind\",\n          \"type\": \"MessageVisibleKind\",\n          \"isAttr\": true\n        }\n      ],\n      \"superClass\": [\n        \"di:LabeledEdge\"\n      ]\n    },\n    {\n      \"name\": \"BPMNLabel\",\n      \"properties\": [\n        {\n          \"name\": \"labelStyle\",\n          \"type\": \"BPMNLabelStyle\",\n          \"association\": \"A_labelStyle_label\",\n          \"isAttr\": true,\n          \"isReference\": true,\n          \"redefines\": \"di:DiagramElement#style\"\n        }\n      ],\n      \"superClass\": [\n        \"di:Label\"\n      ]\n    },\n    {\n      \"name\": \"BPMNLabelStyle\",\n      \"properties\": [\n        {\n          \"name\": \"font\",\n          \"type\": \"dc:Font\"\n        }\n      ],\n      \"superClass\": [\n        \"di:Style\"\n      ]\n    }\n  ],\n  \"emumerations\": [\n    {\n      \"name\": \"ParticipantBandKind\",\n      \"literalValues\": [\n        {\n          \"name\": \"top_initiating\"\n        },\n        {\n          \"name\": \"middle_initiating\"\n        },\n        {\n          \"name\": \"bottom_initiating\"\n        },\n        {\n          \"name\": \"top_non_initiating\"\n        },\n        {\n          \"name\": \"middle_non_initiating\"\n        },\n        {\n          \"name\": \"bottom_non_initiating\"\n        }\n      ]\n    },\n    {\n      \"name\": \"MessageVisibleKind\",\n      \"literalValues\": [\n        {\n          \"name\": \"initiating\"\n        },\n        {\n          \"name\": \"non_initiating\"\n        }\n      ]\n    }\n  ],\n  \"associations\": [],\n  \"prefix\": \"bpmndi\"\n}\n},{}],39:[function(_dereq_,module,exports){\nmodule.exports={\n  \"name\": \"DC\",\n  \"uri\": \"http://www.omg.org/spec/DD/20100524/DC\",\n  \"types\": [\n    {\n      \"name\": \"Boolean\"\n    },\n    {\n      \"name\": \"Integer\"\n    },\n    {\n      \"name\": \"Real\"\n    },\n    {\n      \"name\": \"String\"\n    },\n    {\n      \"name\": \"Font\",\n      \"properties\": [\n        {\n          \"name\": \"name\",\n          \"type\": \"String\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"size\",\n          \"type\": \"Real\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"isBold\",\n          \"type\": \"Boolean\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"isItalic\",\n          \"type\": \"Boolean\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"isUnderline\",\n          \"type\": \"Boolean\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"isStrikeThrough\",\n          \"type\": \"Boolean\",\n          \"isAttr\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Point\",\n      \"properties\": [\n        {\n          \"name\": \"x\",\n          \"type\": \"Real\",\n          \"default\": \"0\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"y\",\n          \"type\": \"Real\",\n          \"default\": \"0\",\n          \"isAttr\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Bounds\",\n      \"properties\": [\n        {\n          \"name\": \"x\",\n          \"type\": \"Real\",\n          \"default\": \"0\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"y\",\n          \"type\": \"Real\",\n          \"default\": \"0\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"width\",\n          \"type\": \"Real\",\n          \"isAttr\": true\n        },\n        {\n          \"name\": \"height\",\n          \"type\": \"Real\",\n          \"isAttr\": true\n        }\n      ]\n    }\n  ],\n  \"prefix\": \"dc\",\n  \"associations\": []\n}\n},{}],40:[function(_dereq_,module,exports){\nmodule.exports={\n  \"name\": \"DI\",\n  \"uri\": \"http://www.omg.org/spec/DD/20100524/DI\",\n  \"types\": [\n    {\n      \"name\": \"DiagramElement\",\n      \"isAbstract\": true,\n      \"properties\": [\n        {\n          \"name\": \"owningDiagram\",\n          \"type\": \"Diagram\",\n          \"isReadOnly\": true,\n          \"association\": \"A_rootElement_owningDiagram\",\n          \"isVirtual\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"owningElement\",\n          \"type\": \"DiagramElement\",\n          \"isReadOnly\": true,\n          \"association\": \"A_ownedElement_owningElement\",\n          \"isVirtual\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"modelElement\",\n          \"isReadOnly\": true,\n          \"association\": \"A_modelElement_diagramElement\",\n          \"isVirtual\": true,\n          \"isReference\": true,\n          \"type\": \"Element\"\n        },\n        {\n          \"name\": \"style\",\n          \"type\": \"Style\",\n          \"isReadOnly\": true,\n          \"association\": \"A_style_diagramElement\",\n          \"isVirtual\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"ownedElement\",\n          \"type\": \"DiagramElement\",\n          \"isReadOnly\": true,\n          \"association\": \"A_ownedElement_owningElement\",\n          \"isVirtual\": true,\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Node\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"DiagramElement\"\n      ]\n    },\n    {\n      \"name\": \"Edge\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"DiagramElement\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"source\",\n          \"type\": \"DiagramElement\",\n          \"isReadOnly\": true,\n          \"association\": \"A_source_sourceEdge\",\n          \"isVirtual\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"target\",\n          \"type\": \"DiagramElement\",\n          \"isReadOnly\": true,\n          \"association\": \"A_target_targetEdge\",\n          \"isVirtual\": true,\n          \"isReference\": true\n        },\n        {\n          \"name\": \"waypoint\",\n          \"isUnique\": false,\n          \"isMany\": true,\n          \"type\": \"dc:Point\",\n          \"serialize\": \"xsi:type\"\n        }\n      ]\n    },\n    {\n      \"name\": \"Diagram\",\n      \"isAbstract\": true,\n      \"properties\": [\n        {\n          \"name\": \"rootElement\",\n          \"type\": \"DiagramElement\",\n          \"isReadOnly\": true,\n          \"association\": \"A_rootElement_owningDiagram\",\n          \"isVirtual\": true\n        },\n        {\n          \"name\": \"name\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"documentation\",\n          \"isAttr\": true,\n          \"type\": \"String\"\n        },\n        {\n          \"name\": \"resolution\",\n          \"isAttr\": true,\n          \"type\": \"Real\"\n        },\n        {\n          \"name\": \"ownedStyle\",\n          \"type\": \"Style\",\n          \"isReadOnly\": true,\n          \"association\": \"A_ownedStyle_owningDiagram\",\n          \"isVirtual\": true,\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Shape\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"Node\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"bounds\",\n          \"type\": \"dc:Bounds\"\n        }\n      ]\n    },\n    {\n      \"name\": \"Plane\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"Node\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"planeElement\",\n          \"type\": \"DiagramElement\",\n          \"subsettedProperty\": \"DiagramElement-ownedElement\",\n          \"association\": \"A_planeElement_plane\",\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"LabeledEdge\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"Edge\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"ownedLabel\",\n          \"type\": \"Label\",\n          \"isReadOnly\": true,\n          \"subsettedProperty\": \"DiagramElement-ownedElement\",\n          \"association\": \"A_ownedLabel_owningEdge\",\n          \"isVirtual\": true,\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"LabeledShape\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"Shape\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"ownedLabel\",\n          \"type\": \"Label\",\n          \"isReadOnly\": true,\n          \"subsettedProperty\": \"DiagramElement-ownedElement\",\n          \"association\": \"A_ownedLabel_owningShape\",\n          \"isVirtual\": true,\n          \"isMany\": true\n        }\n      ]\n    },\n    {\n      \"name\": \"Label\",\n      \"isAbstract\": true,\n      \"superClass\": [\n        \"Node\"\n      ],\n      \"properties\": [\n        {\n          \"name\": \"bounds\",\n          \"type\": \"dc:Bounds\"\n        }\n      ]\n    },\n    {\n      \"name\": \"Style\",\n      \"isAbstract\": true\n    }\n  ],\n  \"associations\": [],\n  \"prefix\": \"di\"\n}\n},{}],41:[function(_dereq_,module,exports){\nmodule.exports = _dereq_('./lib/Diagram');\n},{\"./lib/Diagram\":42}],42:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nvar di = _dereq_('didi');\r\n\r\n/**\r\n * @namespace djs\r\n */\r\n\r\n/**\r\n * Bootstrap an injector from a list of modules, instantiating a number of default components\r\n *\r\n * @ignore\r\n * @param {Array<didi.Module>} bootstrapModules\r\n *\r\n * @return {didi.Injector} a injector to use to access the components\r\n */\r\nfunction bootstrap(bootstrapModules) {\r\n\r\n  var modules = [];\r\n  var components = [];\r\n\r\n  function hasModule(m) {\r\n    return modules.indexOf(m) >= 0;\r\n  }\r\n\r\n  function addModule(m) {\r\n    modules.push(m);\r\n  }\r\n\r\n  function visit(m) {\r\n    if (hasModule(m)) {\r\n      return;\r\n    }\r\n\r\n    (m.__depends__ || []).forEach(visit);\r\n\r\n    if (hasModule(m)) {\r\n      return;\r\n    }\r\n\r\n    addModule(m);\r\n\r\n    (m.__init__ || []).forEach(function(c) {\r\n      components.push(c);\r\n    });\r\n  }\r\n\r\n  bootstrapModules.forEach(visit);\r\n\r\n  var injector = new di.Injector(modules);\r\n\r\n  components.forEach(function(c) {\r\n    // eagerly resolve main components\r\n    injector.get(c);\r\n  });\r\n\r\n  return injector;\r\n}\r\n\r\n/**\r\n * Creates an injector from passed options.\r\n *\r\n * @ignore\r\n * @param  {Object} options\r\n * @return {didi.Injector}\r\n */\r\nfunction createInjector(options) {\r\n\r\n  options = options || {};\r\n\r\n  var configModule = {\r\n    'config': ['value', options]\r\n  };\r\n\r\n  var coreModule = _dereq_('./core');\r\n\r\n  var modules = [ configModule, coreModule ].concat(options.modules || []);\r\n\r\n  return bootstrap(modules);\r\n}\r\n\r\n\r\n/**\r\n * The main diagram-js entry point that bootstraps the diagram with the given\r\n * configuration. To register extensions with the diagram, pass them as Array<didi.Module> to the constructor.\r\n *\r\n * @class djs.Diagram\r\n * @memberOf djs\r\n * @constructor\r\n *\r\n * @example\r\n *\r\n * <caption>Creating a plug-in that logs whenever a shape is added to the canvas.</caption>\r\n *\r\n * // plug-in implemenentation\r\n * function MyLoggingPlugin(eventBus) {\r\n *   eventBus.on('shape.added', function(event) {\r\n *     console.log('shape ', event.shape, ' was added to the diagram');\r\n *   });\r\n * }\r\n *\r\n * // export as module\r\n * module.exports = {\r\n *   __init__: [ 'myLoggingPlugin' ],\r\n *     myLoggingPlugin: [ 'type', MyLoggingPlugin ]\r\n * };\r\n *\r\n *\r\n * // instantiate the diagram with the new plug-in\r\n *\r\n * var diagram = new Diagram({ modules: [ require('path-to-my-logging-plugin') ] });\r\n *\r\n * diagram.invoke([ 'canvas', function(canvas) {\r\n *   // add shape to drawing canvas\r\n *   canvas.addShape({ x: 10, y: 10 });\r\n * });\r\n *\r\n * // 'shape ... was added to the diagram' logged to console\r\n *\r\n * @param {Object} options\r\n * @param {Array<didi.Module>} [options.modules] external modules to instantiate with the diagram\r\n * @param {didi.Injector} [injector] an (optional) injector to bootstrap the diagram with\r\n */\r\nfunction Diagram(options, injector) {\r\n\r\n  // create injector unless explicitly specified\r\n  this.injector = injector = injector || createInjector(options);\r\n\r\n  // API\r\n\r\n  /**\r\n   * Resolves a diagram service\r\n   *\r\n   * @method Diagram#get\r\n   *\r\n   * @param {String} name the name of the diagram service to be retrieved\r\n   * @param {Object} [locals] a number of locals to use to resolve certain dependencies\r\n   */\r\n  this.get = injector.get;\r\n\r\n  /**\r\n   * Executes a function into which diagram services are injected\r\n   *\r\n   * @method Diagram#invoke\r\n   *\r\n   * @param {Function|Object[]} fn the function to resolve\r\n   * @param {Object} locals a number of locals to use to resolve certain dependencies\r\n   */\r\n  this.invoke = injector.invoke;\r\n\r\n  // init\r\n\r\n  // indicate via event\r\n\r\n\r\n  /**\r\n   * An event indicating that all plug-ins are loaded.\r\n   *\r\n   * Use this event to fire other events to interested plug-ins\r\n   *\r\n   * @memberOf Diagram\r\n   *\r\n   * @event diagram.init\r\n   *\r\n   * @example\r\n   *\r\n   * events.on('diagram.init', function() {\r\n   *   events.fire('my-custom-event', { foo: 'BAR' });\r\n   * });\r\n   *\r\n   * @type {Object}\r\n   */\r\n  this.get('eventBus').fire('diagram.init');\r\n}\r\n\r\nmodule.exports = Diagram;\r\n\r\n\r\n/**\r\n * Destroys the diagram\r\n *\r\n * @method  Diagram#destroy\r\n */\r\nDiagram.prototype.destroy = function() {\r\n  this.get('eventBus').fire('diagram.destroy');\r\n};\n},{\"./core\":48,\"didi\":69}],43:[function(_dereq_,module,exports){\n'use strict';\r\n\r\n\r\nvar _ = (window._);\r\n\r\nvar remove = _dereq_('../util/Collections').remove;\r\n\r\n\r\nfunction round(number, resolution) {\r\n  return Math.round(number * resolution) / resolution;\r\n}\r\n\r\nfunction ensurePx(number) {\r\n  return _.isNumber(number) ? number + 'px' : number;\r\n}\r\n\r\n/**\r\n * Creates a HTML container element for a SVG element with\r\n * the given configuration\r\n *\r\n * @param  {Object} options\r\n * @return {HTMLElement} the container element\r\n */\r\nfunction createContainer(options) {\r\n\r\n  options = _.extend({}, { width: '100%', height: '100%' }, options);\r\n\r\n  var container = options.container || document.body;\r\n\r\n  // create a <div> around the svg element with the respective size\r\n  // this way we can always get the correct container size\r\n  // (this is impossible for <svg> elements at the moment)\r\n  var parent = document.createElement('div');\r\n  parent.setAttribute('class', 'djs-container');\r\n\r\n  _.extend(parent.style, {\r\n    position: 'relative',\r\n    width: ensurePx(options.width),\r\n    height: ensurePx(options.height)\r\n  });\r\n\r\n  container.appendChild(parent);\r\n\r\n  return parent;\r\n}\r\n\r\n\r\n/**\r\n * The main drawing canvas.\r\n *\r\n * @class\r\n * @constructor\r\n *\r\n * @emits Canvas#canvas.init\r\n *\r\n * @param {Object} config\r\n * @param {EventBus} eventBus\r\n * @param {GraphicsFactory} graphicsFactory\r\n * @param {ElementRegistry} elementRegistry\r\n */\r\nfunction Canvas(config, eventBus, graphicsFactory, elementRegistry, snap) {\r\n\r\n  var options = _.extend(config.canvas || {});\r\n\r\n  this._snap = snap;\r\n  this._eventBus = eventBus;\r\n  this._elementRegistry = elementRegistry;\r\n  this._graphicsFactory = graphicsFactory;\r\n\r\n  // Creates a <svg> element that is wrapped into a <div>.\r\n  // This way we are always able to correctly figure out the size of the svg element\r\n  // by querying the parent node.\r\n  //\r\n  // (It is not possible to get the size of a svg element cross browser @ 2014-04-01)\r\n  //\r\n  // <div class=\"djs-container\" style=\"width: {desired-width}, height: {desired-height}\">\r\n  //   <svg width=\"100%\" height=\"100%\">\r\n  //    ...\r\n  //   </svg>\r\n  // </div>\r\n\r\n  var container = this._container = createContainer(options);\r\n\r\n  // svg root\r\n  var paper = this._paper = createPaper(container);\r\n\r\n  // drawing root\r\n  var root = this._root = paper.group().attr({ 'class' : 'viewport' });\r\n\r\n\r\n  function createPaper(container) {\r\n    return graphicsFactory.createPaper({ container: container, width: '100%', height: '100%' });\r\n  }\r\n\r\n  /**\r\n   * Sends a shape to the front.\r\n   *\r\n   * This method takes parent / child relationships between shapes into account\r\n   * and makes sure that children are properly handled, too.\r\n   *\r\n   * @method Canvas#sendToFront\r\n   *\r\n   * @param {djs.ElementDescriptor} shape descriptor of the shape to be sent to front\r\n   * @param {boolean} bubble=true whether to send parent shapes to front, too\r\n   */\r\n  function sendToFront(shape, bubble) {\r\n\r\n    if (bubble !== false) {\r\n      bubble = true;\r\n    }\r\n\r\n    if (bubble && shape.parent) {\r\n      sendToFront(shape.parent);\r\n    }\r\n\r\n    if (shape.children) {\r\n      shape.children.forEach(function(child) {\r\n        sendToFront(child, false);\r\n      });\r\n    }\r\n\r\n    var gfx = getGraphics(shape),\r\n        gfxParent = gfx.parent();\r\n\r\n    gfx.remove().appendTo(gfxParent);\r\n  }\r\n\r\n  /**\r\n   * Return the graphical object underlaying a certain diagram element\r\n   *\r\n   * @method Canvas#getGraphics\r\n   *\r\n   * @param {djs.ElementDescriptor} element descriptor of the element\r\n   */\r\n  function getGraphics(element) {\r\n    return elementRegistry.getGraphicsByElement(element);\r\n  }\r\n\r\n  eventBus.on('diagram.init', function(event) {\r\n\r\n    /**\r\n     * An event indicating that the canvas is ready to be drawn on.\r\n     *\r\n     * @memberOf Canvas\r\n     *\r\n     * @event canvas.init\r\n     *\r\n     * @type {Object}\r\n     * @property {snapsvg.Paper} paper the initialized drawing paper\r\n     */\r\n    eventBus.fire('canvas.init', { root: root, paper: paper });\r\n  });\r\n\r\n  eventBus.on('diagram.destroy', function() {\r\n\r\n    if (container) {\r\n      var parent = container.parentNode;\r\n      parent.removeChild(container);\r\n    }\r\n\r\n    container = this._container = null;\r\n    paper = this._paper = null;\r\n    root = this._root = null;\r\n  });\r\n\r\n  this.getGraphics = getGraphics;\r\n\r\n  this.sendToFront = sendToFront;\r\n}\r\n\r\n/**\r\n * Ensure that an element has a valid, unique id\r\n *\r\n * @param {djs.model.Base} element\r\n */\r\nCanvas.prototype._ensureValidId = function(element) {\r\n  if (!element.id) {\r\n    throw new Error('element must have an id');\r\n  }\r\n\r\n  if (this._elementRegistry.getById(element.id)) {\r\n    throw new Error('element with id ' + element.id + ' already exists');\r\n  }\r\n};\r\n\r\n/**\r\n * Returns the root rendering context on which\r\n * all elements are drawn.\r\n *\r\n * @returns {snapsvg.Group}\r\n */\r\nCanvas.prototype.getRoot = function() {\r\n  return this._root;\r\n};\r\n\r\n/**\r\n * Returns the html element that encloses the\r\n * drawing canvas.\r\n *\r\n * @return {DOMNode}\r\n */\r\nCanvas.prototype.getContainer = function() {\r\n  return this._container;\r\n};\r\n\r\n/**\r\n * Adds a shape to the canvas\r\n *\r\n * @param {Object|djs.model.Shape} shape to add to the diagram\r\n *\r\n * @return {djs.model.Shape} the added shape\r\n */\r\nCanvas.prototype.addShape = function(shape, parent) {\r\n\r\n  this._ensureValidId(shape);\r\n\r\n  if (parent) {\r\n    shape.parent = parent;\r\n    parent.children.push(shape);\r\n  }\r\n\r\n  // create shape gfx\r\n  var gfx = this._graphicsFactory.createShape(this._root, shape);\r\n\r\n  /**\r\n   * An event indicating that a new shape is being added to the canvas.\r\n   *\r\n   * @memberOf Canvas\r\n   *\r\n   * @event shape.add\r\n   * @type {Object}\r\n   * @property {djs.model.Shape} element the shape\r\n   * @property {Object} gfx the graphical representation of the shape\r\n   */\r\n  this._eventBus.fire('shape.add', { element: shape, gfx: gfx });\r\n\r\n  // update its visual\r\n  this._graphicsFactory.updateShape(shape, gfx);\r\n\r\n  /**\r\n   * An event indicating that a new shape has been added to the canvas.\r\n   *\r\n   * @memberOf Canvas\r\n   *\r\n   * @event shape.added\r\n   * @type {Object}\r\n   * @property {djs.model.Shape} element the shape\r\n   * @property {Object} gfx the graphical representation of the shape\r\n   */\r\n  this._eventBus.fire('shape.added', { element: shape, gfx: gfx });\r\n\r\n  return shape;\r\n};\r\n\r\n/**\r\n * Adds a connection to the canvas\r\n *\r\n * @param {djs.model.Connection} connection to add to the diagram\r\n *\r\n * @return {djs.model.Connection} the added connection\r\n */\r\nCanvas.prototype.addConnection = function(connection, parent) {\r\n\r\n  this._ensureValidId(connection);\r\n\r\n  if (parent) {\r\n    connection.parent = parent;\r\n    parent.children.push(connection);\r\n  }\r\n\r\n  // create connection gfx\r\n  var gfx = this._graphicsFactory.createConnection(this._root, connection);\r\n\r\n  /**\r\n   * An event indicating that a new connection is being added to the canvas.\r\n   *\r\n   * @memberOf Canvas\r\n   *\r\n   * @event connection.add\r\n   * @type {Object}\r\n   * @property {djs.model.Connection} element the connection\r\n   * @property {Object} gfx the graphical representation of the connection\r\n   */\r\n  this._eventBus.fire('connection.add', { element: connection, gfx: gfx });\r\n\r\n  // update its visual\r\n  this._graphicsFactory.updateConnection(connection, gfx);\r\n\r\n  /**\r\n   * An event indicating that a new connection has been added to the canvas.\r\n   *\r\n   * @memberOf Canvas\r\n   *\r\n   * @event connection.added\r\n   * @type {Object}\r\n   * @property {djs.model.Connection} element the connection\r\n   * @property {Object} gfx the graphical representation of the connection\r\n   */\r\n  this._eventBus.fire('connection.added', { element: connection, gfx: gfx });\r\n\r\n  return connection;\r\n};\r\n\r\n\r\n/**\r\n * Internal remove element\r\n */\r\nCanvas.prototype._removeElement = function(element, type) {\r\n\r\n  if (_.isString(element)) {\r\n    element = this._elementRegistry.getById(element);\r\n  }\r\n\r\n  var gfx = this._elementRegistry.getGraphicsByElement(element);\r\n\r\n  this._eventBus.fire(type + '.remove', { element: element, gfx: gfx });\r\n\r\n  if (gfx) {\r\n    gfx.remove();\r\n  }\r\n\r\n  // unset parent <-> child relationship\r\n  remove(element.parent && element.parent.children, element);\r\n  element.parent = null;\r\n\r\n  this._eventBus.fire(type + '.removed', { element: element, gfx: gfx });\r\n\r\n  return element;\r\n};\r\n\r\n/**\r\n * Removes a shape from the canvas\r\n *\r\n * @param {String|djs.model.Shape} shape or shape id to be removed\r\n *\r\n * @return {djs.model.Shape} the removed shape\r\n */\r\nCanvas.prototype.removeShape = function(shape) {\r\n\r\n  /**\r\n   * An event indicating that a shape is about to be removed from the canvas.\r\n   *\r\n   * @memberOf Canvas\r\n   *\r\n   * @event shape.remove\r\n   * @type {Object}\r\n   * @property {djs.model.Shape} element the shape descriptor\r\n   * @property {Object} gfx the graphical representation of the shape\r\n   */\r\n\r\n  /**\r\n   * An event indicating that a shape has been removed from the canvas.\r\n   *\r\n   * @memberOf Canvas\r\n   *\r\n   * @event shape.removed\r\n   * @type {Object}\r\n   * @property {djs.model.Shape} element the shape descriptor\r\n   * @property {Object} gfx the graphical representation of the shape\r\n   */\r\n  return this._removeElement(shape, 'shape');\r\n};\r\n\r\n/**\r\n * Removes a connection from the canvas\r\n *\r\n * @param {String|djs.model.Connection} connection or connection id to be removed\r\n *\r\n * @return {djs.model.Connection} the removed connection\r\n */\r\nCanvas.prototype.removeConnection = function(connection) {\r\n\r\n  /**\r\n   * An event indicating that a connection is about to be removed from the canvas.\r\n   *\r\n   * @memberOf Canvas\r\n   *\r\n   * @event connection.remove\r\n   * @type {Object}\r\n   * @property {djs.model.Connection} element the connection descriptor\r\n   * @property {Object} gfx the graphical representation of the connection\r\n   */\r\n\r\n  /**\r\n   * An event indicating that a connection has been removed from the canvas.\r\n   *\r\n   * @memberOf Canvas\r\n   *\r\n   * @event connection.removed\r\n   * @type {Object}\r\n   * @property {djs.model.Connection} element the connection descriptor\r\n   * @property {Object} gfx the graphical representation of the connection\r\n   */\r\n  return this._removeElement(connection, 'connection');\r\n};\r\n\r\n\r\nCanvas.prototype._fireViewboxChange = function(viewbox) {\r\n  this._eventBus.fire('canvas.viewbox.changed', { viewbox: viewbox || this.viewbox() });\r\n};\r\n\r\n/**\r\n * Gets or sets the view box of the canvas, i.e. the area that is currently displayed\r\n *\r\n * @param  {Object} [box] the new view box to set\r\n * @param  {Number} box.x the top left X coordinate of the canvas visible in view box\r\n * @param  {Number} box.y the top left Y coordinate of the canvas visible in view box\r\n * @param  {Number} box.width the visible width\r\n * @param  {Number} box.height\r\n *\r\n * @example\r\n *\r\n * canvas.viewbox({ x: 100, y: 100, width: 500, height: 500 })\r\n *\r\n * // sets the visible area of the diagram to (100|100) -> (600|100)\r\n * // and and scales it according to the diagram width\r\n *\r\n * @return {Object} the current view box\r\n */\r\nCanvas.prototype.viewbox = function(box) {\r\n\r\n  var root = this._root;\r\n\r\n  var innerBox,\r\n      outerBox = this.getSize(),\r\n      matrix,\r\n      scale,\r\n      x, y;\r\n\r\n  if (!box) {\r\n    innerBox = root.getBBox(true);\r\n\r\n    matrix = root.transform().localMatrix;\r\n    scale = round(matrix.a, 1000);\r\n\r\n    x = round(-matrix.e || 0, 1000);\r\n    y = round(-matrix.f || 0, 1000);\r\n\r\n    return {\r\n      x: x ? x / scale : 0,\r\n      y: y ? y / scale : 0,\r\n      width: outerBox.width / scale,\r\n      height: outerBox.height / scale,\r\n      scale: scale,\r\n      inner: {\r\n        width: innerBox.width,\r\n        height: innerBox.height\r\n      },\r\n      outer: outerBox\r\n    };\r\n  } else {\r\n    scale = Math.max(outerBox.width / box.width, outerBox.height / box.height);\r\n\r\n    matrix = new this._snap.Matrix().scale(scale).translate(-box.x, -box.y);\r\n    root.transform(matrix);\r\n\r\n    this._fireViewboxChange();\r\n  }\r\n\r\n  return box;\r\n};\r\n\r\n\r\n/**\r\n * Gets or sets the scroll of the canvas.\r\n *\r\n * @param {Object} [delta] the new scroll to apply.\r\n *\r\n * @param {Number} [delta.dx]\r\n * @param {Number} [delta.dy]\r\n */\r\nCanvas.prototype.scroll = function(delta) {\r\n\r\n  var node = this._root.node;\r\n  var matrix = node.getCTM();\r\n\r\n  if (delta) {\r\n    delta = _.extend({ dx: 0, dy: 0 }, delta || {});\r\n\r\n    matrix = this._paper.node.createSVGMatrix().translate(delta.dx, delta.dy).multiply(matrix);\r\n\r\n    setCTM(node, matrix);\r\n\r\n    this._fireViewboxChange();\r\n  }\r\n\r\n  return { x: matrix.e, y: matrix.f };\r\n};\r\n\r\n\r\n/**\r\n * Gets or sets the current zoom of the canvas, optionally zooming to the specified position.\r\n *\r\n * @param {String|Number} [newScale] the new zoom level, either a number, i.e. 0.9,\r\n *                                   or `fit-viewport` to adjust the size to fit the current viewport\r\n * @param {String|Point} [center] the reference point { x: .., y: ..} to zoom to, 'auto' to zoom into mid or null\r\n *\r\n * @return {Number} the current scale\r\n */\r\nCanvas.prototype.zoom = function(newScale, center) {\r\n\r\n  var vbox = this.viewbox();\r\n\r\n  if (newScale === undefined) {\r\n    return vbox.scale;\r\n  }\r\n\r\n  var outer = vbox.outer;\r\n\r\n  if (newScale === 'fit-viewport') {\r\n    newScale = Math.min(1, outer.width / vbox.inner.width);\r\n  }\r\n\r\n  if (center === 'auto') {\r\n    center = {\r\n      x: outer.width / 2,\r\n      y: outer.height / 2\r\n    };\r\n  }\r\n\r\n  var matrix = this._setZoom(newScale, center);\r\n\r\n  this._fireViewboxChange();\r\n\r\n  return round(matrix.a, 1000);\r\n};\r\n\r\nfunction setCTM(node, m) {\r\n  var mstr = 'matrix(' + m.a + ',' + m.b + ',' + m.c + ',' + m.d + ',' + m.e + ',' + m.f + ')';\r\n  node.setAttribute('transform', mstr);\r\n}\r\n\r\nCanvas.prototype._setZoom = function(scale, center) {\r\n\r\n  var svg = this._paper.node,\r\n      viewport = this._root.node;\r\n\r\n  var matrix = svg.createSVGMatrix();\r\n  var point = svg.createSVGPoint();\r\n\r\n  var centerPoint,\r\n      originalPoint,\r\n      currentMatrix,\r\n      scaleMatrix,\r\n      newMatrix;\r\n\r\n  currentMatrix = viewport.getCTM();\r\n\r\n\r\n  var currentScale = currentMatrix.a;\r\n\r\n  if (center) {\r\n    centerPoint = _.extend(point, center);\r\n\r\n    // revert applied viewport transformations\r\n    originalPoint = centerPoint.matrixTransform(currentMatrix.inverse());\r\n\r\n    // create scale matrix\r\n    scaleMatrix = matrix\r\n                    .translate(originalPoint.x, originalPoint.y)\r\n                    .scale(1 / currentScale * scale)\r\n                    .translate(-originalPoint.x, -originalPoint.y);\r\n\r\n    newMatrix = currentMatrix.multiply(scaleMatrix);\r\n  } else {\r\n    newMatrix = matrix.scale(scale);\r\n  }\r\n\r\n  setCTM(this._root.node, newMatrix);\r\n\r\n  return newMatrix;\r\n};\r\n\r\n\r\n/**\r\n * Returns the size of the canvas\r\n *\r\n * @return {Dimensions}\r\n */\r\nCanvas.prototype.getSize = function () {\r\n  return {\r\n    width: this._container.clientWidth,\r\n    height: this._container.clientHeight\r\n  };\r\n};\r\n\r\n\r\n/**\r\n * Return the absolute bounding box for the given element\r\n *\r\n * The absolute bounding box may be used to display overlays in the\r\n * callers (browser) coordinate system rather than the zoomed in/out\r\n * canvas coordinates.\r\n *\r\n * @param  {ElementDescriptor} element\r\n * @return {Bounds} the absolute bounding box\r\n */\r\nCanvas.prototype.getAbsoluteBBox = function(element) {\r\n  var vbox = this.viewbox();\r\n\r\n  var gfx = this.getGraphics(element);\r\n\r\n  var transformBBox = gfx.getBBox(true);\r\n  var bbox = gfx.getBBox();\r\n\r\n  var x = (bbox.x - transformBBox.x) * vbox.scale - vbox.x * vbox.scale;\r\n  var y = (bbox.y - transformBBox.y) * vbox.scale - vbox.y * vbox.scale;\r\n\r\n  var width = (bbox.width + 2 * transformBBox.x) * vbox.scale;\r\n  var height = (bbox.height + 2 * transformBBox.y) * vbox.scale;\r\n\r\n  return {\r\n    x: x,\r\n    y: y,\r\n    width: width,\r\n    height: height\r\n  };\r\n};\r\n\r\nCanvas.$inject = [\r\n  'config',\r\n  'eventBus',\r\n  'graphicsFactory',\r\n  'elementRegistry',\r\n  'snap' ];\r\n\r\nmodule.exports = Canvas;\n},{\"../util/Collections\":64}],44:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nvar _ = (window._);\r\n\r\n\r\nvar Model = _dereq_('../model');\r\n\r\n\r\n/**\r\n * A factory for diagram-js shapes\r\n */\r\nfunction ElementFactory() {\r\n  this._uid = 12;\r\n}\r\n\r\nmodule.exports = ElementFactory;\r\n\r\n\r\nElementFactory.prototype.createRoot = function(attrs) {\r\n  return this.create('root', attrs);\r\n};\r\n\r\nElementFactory.prototype.createLabel = function(attrs) {\r\n  return this.create('label', attrs);\r\n};\r\n\r\nElementFactory.prototype.createShape = function(attrs) {\r\n  return this.create('shape', attrs);\r\n};\r\n\r\nElementFactory.prototype.createConnection = function(attrs) {\r\n  return this.create('connection', attrs);\r\n};\r\n\r\n/**\r\n * Create a model element with the given type and\r\n * a number of pre-set attributes.\r\n *\r\n * @param  {String} type\r\n * @param  {Object} attrs\r\n * @return {djs.model.Base} the newly created model instance\r\n */\r\nElementFactory.prototype.create = function(type, attrs) {\r\n\r\n  attrs = attrs || {};\r\n\r\n  if (!attrs.id) {\r\n    attrs.id = type + '_' + (this._uid++);\r\n  }\r\n\r\n  return Model.create(type, attrs);\r\n};\n},{\"../model\":63}],45:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nvar _ = (window._);\r\n\r\n\r\n/**\r\n * @class\r\n *\r\n * A registry that keeps track of all shapes in the diagram.\r\n *\r\n * @param {EventBus} eventBus the event bus\r\n */\r\nfunction ElementRegistry(eventBus) {\r\n\r\n  // mapping element.id -> container\r\n  this._elementMap = {};\r\n\r\n  // mapping gfx.id -> container\r\n  this._graphicsMap = {};\r\n\r\n\r\n  var self = this;\r\n\r\n  _.forEach([ 'shape', 'connection' ], function(type) {\r\n    eventBus.on(type + '.add', function(event) {\r\n      self.add(event.element, event.gfx);\r\n    });\r\n\r\n    eventBus.on(type + '.removed', function(event) {\r\n      self.remove(event.element, event.gfx);\r\n    });\r\n  });\r\n\r\n  eventBus.on('diagram.destroy', function(event) {\r\n    self._elementMap = null;\r\n    self.graphicsMap = null;\r\n  });\r\n}\r\n\r\nElementRegistry.$inject = [ 'eventBus' ];\r\n\r\nmodule.exports = ElementRegistry;\r\n\r\n\r\nElementRegistry.prototype.add = function(element, gfx) {\r\n  if (!element.id) {\r\n    throw new Error('element has no id');\r\n  }\r\n\r\n  if (!gfx.id) {\r\n    throw new Error('graphics has no id');\r\n  }\r\n\r\n  if (this._graphicsMap[gfx.id]) {\r\n    throw new Error('graphics with id ' + gfx.id + ' already registered');\r\n  }\r\n\r\n  if (this._elementMap[element.id]) {\r\n    throw new Error('element with id ' + element.id + ' already added');\r\n  }\r\n\r\n  this._elementMap[element.id] = this._graphicsMap[gfx.id] = { element: element, gfx: gfx };\r\n};\r\n\r\nElementRegistry.prototype.remove = function(element) {\r\n  var gfx = this.getGraphicsByElement(element);\r\n\r\n  delete this._elementMap[element.id];\r\n  delete this._graphicsMap[gfx.id];\r\n};\r\n\r\n\r\n/**\r\n * @method ElementRegistry#getByGraphics\r\n */\r\nElementRegistry.prototype.getByGraphics = function(gfx) {\r\n  var id = _.isString(gfx) ? gfx : gfx.id;\r\n\r\n  var container = this._graphicsMap[id];\r\n  return container && container.element;\r\n};\r\n\r\n\r\n/**\r\n * @method ElementRegistry#getById\r\n */\r\nElementRegistry.prototype.getById = function(id) {\r\n  var container = this._elementMap[id];\r\n  return container && container.element;\r\n};\r\n\r\n/**\r\n * @method ElementRegistry#getGraphicsByElement\r\n */\r\nElementRegistry.prototype.getGraphicsByElement = function(element) {\r\n  var id = _.isString(element) ? element : element.id;\r\n\r\n  var container = this._elementMap[id];\r\n  return container && container.gfx;\r\n};\n},{}],46:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nvar _ = (window._);\r\n\r\n/**\r\n * @global\r\n * @type {Object}\r\n * @static\r\n */\r\nvar EventPriority = {\r\n  standard: 1000,\r\n  overwrite: 10000\r\n};\r\n\r\n/**\r\n * @class\r\n *\r\n * A general purpose event bus\r\n */\r\nfunction EventBus() {\r\n  var listenerMap = {};\r\n\r\n  function getListeners(name) {\r\n    var listeners = listenerMap[name];\r\n\r\n    if (!listeners) {\r\n      listeners = listenerMap[name] = [];\r\n    }\r\n\r\n    return listeners;\r\n  }\r\n\r\n  function extendEvent(event, type) {\r\n\r\n    var propagationStopped,\r\n        defaultPrevented;\r\n\r\n    _.extend(event, {\r\n      type: type,\r\n\r\n      stopPropagation: function() {\r\n        this.propagationStopped = true;\r\n      },\r\n      preventDefault: function() {\r\n        this.defaultPrevented = true;\r\n      },\r\n\r\n      isPropagationStopped: function() {\r\n        return !!this.propagationStopped;\r\n      },\r\n\r\n      isDefaultPrevented: function() {\r\n        return !!this.defaultPrevented;\r\n      }\r\n    });\r\n\r\n    return event;\r\n  }\r\n\r\n  /**\r\n   * Register an event listener for events with the given name.\r\n   *\r\n   * The callback will be invoked with `event, ...additionalArguments`\r\n   * that have been passed to the evented element.\r\n   *\r\n   * @method EventBus#on\r\n   *\r\n   * @param {String|Array<String>} events\r\n   * @param {Number} [priority] the priority in which this listener is called,\r\n   *                            defaults to 1000 but may be changed to override execution order of callbacks\r\n   *                            (> {@link EventPriority#overwrite})\r\n   *\r\n   * @param {Function} callback\r\n   */\r\n  function on(events, priority, callback) {\r\n\r\n    events = _.isArray(events) ? events : [ events ];\r\n\r\n    if (_.isFunction(priority)) {\r\n      callback = priority;\r\n      priority = EventPriority.standard;\r\n    }\r\n\r\n    if (!_.isNumber(priority)) {\r\n      throw new Error('priority needs to be a number');\r\n    }\r\n\r\n    _.forEach(events, function(e) {\r\n      var listeners = getListeners(e);\r\n      addEventToArray(listeners, callback, priority);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Register an event listener that is executed only once.\r\n   *\r\n   * @method EventBus#once\r\n   *\r\n   * @param {String} event the event name to register for\r\n   * @param {Function} callback the callback to execute\r\n   *\r\n   * @see EventBus#on\r\n   */\r\n  function once(event, callback) {\r\n\r\n    /* jshint -W040 */\r\n\r\n    var self = this;\r\n    var wrappedCallback = function() {\r\n      var eventType = arguments[0].type;\r\n      callback.apply(this, arguments);\r\n      self.off(eventType, wrappedCallback);\r\n    };\r\n\r\n    this.on(event, wrappedCallback);\r\n  }\r\n\r\n  /**\r\n   * Removes event listeners by event and callback.\r\n   *\r\n   * If no callback is given, all listeners for a given event name are being removed.\r\n   *\r\n   * @method EventBus#off\r\n   *\r\n   * @param {String} event\r\n   * @param {Function} [callback]\r\n   */\r\n  function off(event, callback) {\r\n    var listeners, idx;\r\n\r\n    listeners = getListeners(event);\r\n    if (callback) {\r\n      _.forEach(listeners, function(listener) {\r\n        if(listener.callback === callback) {\r\n          idx = listeners.indexOf(listener);\r\n        }\r\n      });\r\n\r\n      if (idx !== -1) {\r\n        listeners.splice(idx, 1);\r\n      }\r\n    } else {\r\n      listeners.length = 0;\r\n    }\r\n  }\r\n\r\n  function handleError(error) {\r\n    return !fire('error', { error: error });\r\n  }\r\n\r\n  /**\r\n   * Fires a named event.\r\n   *\r\n   * @method EventBus#fire\r\n   *\r\n   * @example\r\n   *\r\n   * // fire event by name\r\n   * events.fire('foo');\r\n   *\r\n   * // fire event object with nested type\r\n   * var event = { type: 'foo' };\r\n   * events.fire(event);\r\n   *\r\n   * // fire event with explicit type\r\n   * var event = { x: 10, y: 20 };\r\n   * events.fire('element.moved', event);\r\n   *\r\n   * // pass additional arguments to the event\r\n   * events.on('foo', function(event, bar) {\r\n   *   alert(bar);\r\n   * });\r\n   *\r\n   * events.fire({ type: 'foo' }, 'I am bar!');\r\n   *\r\n   * @param {String} [name] the optional event name\r\n   * @param {Object} [event] the event object\r\n   * @param {...Object} additional arguments to be passed to the callback functions\r\n   *\r\n   * @return {Boolean} false if default was prevented\r\n   */\r\n  function fire() {\r\n\r\n    /* jshint -W040 */\r\n\r\n    var event, eventType,\r\n        listeners, i, l,\r\n        args;\r\n\r\n    args = Array.prototype.slice.call(arguments);\r\n\r\n    eventType = args[0];\r\n\r\n    if (_.isObject(eventType)) {\r\n      event = eventType;\r\n\r\n      // parse type from event\r\n      eventType = event.type;\r\n    } else {\r\n      // remove name parameter\r\n      args.shift();\r\n\r\n      event = args[0] || {};\r\n      event.type = eventType;\r\n      if(args.length === 0) {\r\n        args.push(event);\r\n      }\r\n    }\r\n\r\n    listeners = getListeners(eventType);\r\n    event = extendEvent(event, eventType);\r\n\r\n    for (i = 0, l; !!(l = listeners[i]); i++) {\r\n      if (event.isPropagationStopped()) {\r\n        break;\r\n      }\r\n\r\n      try {\r\n        l.callback.apply(this, args);\r\n      } catch (e) {\r\n        if (!handleError(e)) {\r\n          console.error('unhandled error in event listener', e);\r\n          throw e;\r\n        }\r\n      }\r\n    }\r\n\r\n    return !event.isDefaultPrevented();\r\n  }\r\n\r\n  function addEventToArray(array, callback, priority) {\r\n\r\n    array.push({\r\n      priority: priority,\r\n      callback: callback\r\n    });\r\n\r\n    array.sort(function(a, b) {\r\n      if (a.priority < b.priority) {\r\n        return 1;\r\n      } else if (a.priority > b.priority) {\r\n        return -1;\r\n      } else {\r\n        return 0;\r\n      }\r\n    });\r\n  }\r\n\r\n  this.on = on;\r\n  this.once = once;\r\n  this.off = off;\r\n  this.fire = fire;\r\n}\r\n\r\n\r\nmodule.exports = EventBus;\n},{}],47:[function(_dereq_,module,exports){\n'use strict';\r\n\r\n/**\r\n * Creates a gfx container for shapes and connections\r\n *\r\n * The layout is as follows:\r\n *\r\n * <g data-element-id=\"element-1\" class=\"djs-group djs-(type=shape|connection)\">\r\n *   <g class=\"djs-visual\">\r\n *     <!-- the renderer draws in here -->\r\n *   </g>\r\n *\r\n *   <!-- extensions (overlays, click box, ...) goes here\r\n * </g>\r\n *\r\n * @param {Object} root\r\n * @param {String} type the type of the element, i.e. shape | connection\r\n */\r\nfunction createContainer(root, type) {\r\n  var gfxContainer = root.group();\r\n\r\n  gfxContainer\r\n    .addClass('djs-group')\r\n    .addClass('djs-' + type);\r\n\r\n  var gfxGroup = gfxContainer.group().addClass('djs-visual');\r\n\r\n  return gfxContainer;\r\n}\r\n\r\n/**\r\n * Clears the graphical representation of the element and returns the\r\n * cleared result (the <g class=\"djs-visual\" /> element).\r\n */\r\nfunction clearVisual(gfx) {\r\n\r\n  var oldVisual = gfx.select('.djs-visual');\r\n\r\n  var newVisual = gfx.group().addClass('djs-visual').before(oldVisual);\r\n\r\n  oldVisual.remove();\r\n\r\n  return newVisual;\r\n}\r\n\r\n\r\nfunction createContainerFactory(type) {\r\n  return function(root, data) {\r\n    return createContainer(root, type).attr('data-element-id', data.id);\r\n  };\r\n}\r\n\r\n\r\n/**\r\n * A factory that creates graphical elements\r\n *\r\n * @param {Renderer} renderer\r\n * @param {Snap} snap\r\n */\r\nfunction GraphicsFactory(renderer, snap) {\r\n  this._renderer = renderer;\r\n  this._snap = snap;\r\n}\r\n\r\nGraphicsFactory.prototype.createShape = createContainerFactory('shape');\r\n\r\nGraphicsFactory.prototype.createConnection = createContainerFactory('connection');\r\n\r\nGraphicsFactory.prototype.createPaper = function(options) {\r\n  return this._snap.createSnapAt(options.width, options.height, options.container);\r\n};\r\n\r\n\r\nGraphicsFactory.prototype.updateShape = function(element, gfx) {\r\n\r\n  // clear visual\r\n  var gfxGroup = clearVisual(gfx);\r\n\r\n  // redraw\r\n  this._renderer.drawShape(gfxGroup, element);\r\n\r\n  // update positioning\r\n  gfx.translate(element.x, element.y);\r\n\r\n  if (element.hidden) {\r\n    gfx.attr('visibility', 'hidden');\r\n  }\r\n};\r\n\r\n\r\nGraphicsFactory.prototype.updateConnection = function(element, gfx) {\r\n\r\n  // clear visual\r\n  var gfxGroup = clearVisual(gfx);\r\n  this._renderer.drawConnection(gfxGroup, element);\r\n\r\n  if (element.hidden) {\r\n    gfx.attr('visibility', 'hidden');\r\n  }\r\n};\r\n\r\n\r\nGraphicsFactory.$inject = [ 'renderer', 'snap' ];\r\n\r\nmodule.exports = GraphicsFactory;\n},{}],48:[function(_dereq_,module,exports){\nmodule.exports = {\r\n  __depends__: [ _dereq_('../draw') ],\r\n  __init__: [ 'canvas' ],\r\n  canvas: [ 'type', _dereq_('./Canvas') ],\r\n  elementRegistry: [ 'type', _dereq_('./ElementRegistry') ],\r\n  elementFactory: [ 'type', _dereq_('./ElementFactory') ],\r\n  eventBus: [ 'type', _dereq_('./EventBus') ],\r\n  graphicsFactory: [ 'type', _dereq_('./GraphicsFactory') ]\r\n};\n},{\"../draw\":52,\"./Canvas\":43,\"./ElementFactory\":44,\"./ElementRegistry\":45,\"./EventBus\":46,\"./GraphicsFactory\":47}],49:[function(_dereq_,module,exports){\n'use strict';\r\n\r\n// required components\r\n\r\nfunction flattenPoints(points) {\r\n  var result = [];\r\n\r\n  for (var i = 0, p; !!(p = points[i]); i++) {\r\n    result.push(p.x);\r\n    result.push(p.y);\r\n  }\r\n\r\n  return result;\r\n}\r\n\r\n\r\n/**\r\n * @class Renderer\r\n *\r\n * The default renderer used for shapes and connections.\r\n *\r\n * @param {Styles} styles\r\n */\r\nfunction Renderer(styles) {\r\n  this.CONNECTION_STYLE = styles.style([ 'no-fill' ], { strokeWidth: 5, stroke: 'fuchsia' });\r\n  this.SHAPE_STYLE = styles.style({ fill: 'white', stroke: 'fuchsia', strokeWidth: 2 });\r\n}\r\n\r\nRenderer.prototype.drawShape = function drawShape(gfxGroup, data) {\r\n  if (data.width === undefined ||\r\n      data.height === undefined) {\r\n\r\n    throw new Error('must specify width and height properties for new shape');\r\n  }\r\n\r\n  return gfxGroup.rect(0, 0, data.width, data.height, 10, 10).attr(this.SHAPE_STYLE);\r\n};\r\n\r\nRenderer.prototype.drawConnection = function drawConnection(gfxGroup, data) {\r\n  var points = flattenPoints(data.waypoints);\r\n  return gfxGroup.polyline(points).attr(this.CONNECTION_STYLE);\r\n};\r\n\r\n\r\nRenderer.$inject = ['styles'];\r\n\r\n\r\nmodule.exports = Renderer;\r\nmodule.exports.flattenPoints = flattenPoints;\n},{}],50:[function(_dereq_,module,exports){\nvar snapsvg = (window.Snap);\r\n\r\n// require snapsvg extensions\r\n_dereq_('./snapsvg-extensions');\r\n\r\nmodule.exports = snapsvg;\n},{\"./snapsvg-extensions\":53}],51:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nvar _ = (window._);\r\n\r\n\r\n/**\r\n * A component that manages shape styles\r\n */\r\nfunction Styles() {\r\n\r\n  var defaultTraits = {\r\n\r\n    'no-fill': {\r\n      fill: 'none'\r\n    },\r\n    'no-border': {\r\n      strokeOpacity: 0.0\r\n    },\r\n    'no-events': {\r\n      pointerEvents: 'none'\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Builds a style definition from a className, a list of traits and an object of additional attributes.\r\n   *\r\n   * @param  {String} className\r\n   * @param  {Array<String>} traits\r\n   * @param  {Object} additionalAttrs\r\n   *\r\n   * @return {Object} the style defintion\r\n   */\r\n  this.cls = function(className, traits, additionalAttrs) {\r\n    var attrs = this.style(traits, additionalAttrs);\r\n\r\n    return _.extend(attrs, { 'class': className });\r\n  };\r\n\r\n  /**\r\n   * Builds a style definition from a list of traits and an object of additional attributes.\r\n   *\r\n   * @param  {Array<String>} traits\r\n   * @param  {Object} additionalAttrs\r\n   *\r\n   * @return {Object} the style defintion\r\n   */\r\n  this.style = function(traits, additionalAttrs) {\r\n\r\n    if (!_.isArray(traits) && !additionalAttrs) {\r\n      additionalAttrs = traits;\r\n      traits = [];\r\n    }\r\n\r\n    var attrs = _.inject(traits, function(attrs, t) {\r\n      return _.extend(attrs, defaultTraits[t] || {});\r\n    }, {});\r\n\r\n    return additionalAttrs ? _.extend(attrs, additionalAttrs) : attrs;\r\n  };\r\n}\r\n\r\nmodule.exports = Styles;\n},{}],52:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nmodule.exports = {\r\n  renderer: [ 'type', _dereq_('./Renderer') ],\r\n  snap: [ 'value', _dereq_('./Snap') ],\r\n  styles: [ 'type', _dereq_('./Styles') ]\r\n};\n},{\"./Renderer\":49,\"./Snap\":50,\"./Styles\":51}],53:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nvar Snap = (window.Snap);\r\n\r\n/**\r\n * @module snapsvg/extensions\r\n */\r\n\r\n/**\r\n * @namespace snapsvg\r\n */\r\n\r\n/**\r\n * @class snapsvg.Element\r\n */\r\n\r\n/**\r\n * @class ClassPlugin\r\n *\r\n * Extends snapsvg with methods to add and remove classes\r\n */\r\nSnap.plugin(function (Snap, Element, Paper, global) {\r\n\r\n  function split(str) {\r\n    return str.split(/\\s+/);\r\n  }\r\n\r\n  function join(array) {\r\n    return array.join(' ');\r\n  }\r\n\r\n  function getClasses(e) {\r\n    return split(e.attr('class') || '');\r\n  }\r\n\r\n  function setClasses(e, classes) {\r\n    e.attr('class', join(classes));\r\n  }\r\n\r\n  /**\r\n   * @method snapsvg.Element#addClass\r\n   *\r\n   * @example\r\n   *\r\n   * e.attr('class', 'selector');\r\n   *\r\n   * e.addClass('foo bar'); // adds classes foo and bar\r\n   * e.attr('class'); // -> 'selector foo bar'\r\n   *\r\n   * e.addClass('fooBar');\r\n   * e.attr('class'); // -> 'selector foo bar fooBar'\r\n   *\r\n   * @param {String} cls classes to be added to the element\r\n   *\r\n   * @return {snapsvg.Element} the element (this)\r\n   */\r\n  Element.prototype.addClass = function(cls) {\r\n    var current = getClasses(this),\r\n        add = split(cls),\r\n        i, e;\r\n\r\n    for (i = 0, e; !!(e = add[i]); i++) {\r\n      if (current.indexOf(e) === -1) {\r\n        current.push(e);\r\n      }\r\n    }\r\n\r\n    setClasses(this, current);\r\n\r\n    return this;\r\n  };\r\n\r\n  /**\r\n   * @method snapsvg.Element#hasClass\r\n   *\r\n   * @param  {String}  cls the class to query for\r\n   * @return {Boolean} returns true if the element has the given class\r\n   */\r\n  Element.prototype.hasClass = function(cls) {\r\n    if (!cls) {\r\n      throw new Error('[snapsvg] syntax: hasClass(clsStr)');\r\n    }\r\n\r\n    return getClasses(this).indexOf(cls) !== -1;\r\n  };\r\n\r\n  /**\r\n   * @method snapsvg.Element#removeClass\r\n   *\r\n   * @example\r\n   *\r\n   * e.attr('class', 'foo bar');\r\n   *\r\n   * e.removeClass('foo');\r\n   * e.attr('class'); // -> 'bar'\r\n   *\r\n   * e.removeClass('foo bar'); // removes classes foo and bar\r\n   * e.attr('class'); // -> ''\r\n   *\r\n   * @param {String} cls classes to be removed from element\r\n   *\r\n   * @return {snapsvg.Element} the element (this)\r\n   */\r\n  Element.prototype.removeClass = function(cls) {\r\n    var current = getClasses(this),\r\n        remove = split(cls),\r\n        i, e, idx;\r\n\r\n    for (i = 0, e; !!(e = remove[i]); i++) {\r\n      idx = current.indexOf(e);\r\n\r\n      if (idx !== -1) {\r\n        // remove element from array\r\n        current.splice(idx, 1);\r\n      }\r\n    }\r\n\r\n    setClasses(this, current);\r\n\r\n    return this;\r\n  };\r\n\r\n});\r\n\r\n/**\r\n * @class TranslatePlugin\r\n *\r\n * Extends snapsvg with methods to translate elements\r\n */\r\nSnap.plugin(function (Snap, Element, Paper, global) {\r\n\r\n  /*\r\n   * @method snapsvg.Element#translate\r\n   *\r\n   * @example\r\n   *\r\n   * e.translate(10, 20);\r\n   *\r\n   * // sets transform matrix to translate(10, 20)\r\n   *\r\n   * @param {Number} x translation\r\n   * @param {Number} y translation\r\n   *\r\n   * @return {snapsvg.Element} the element (this)\r\n   */\r\n  Element.prototype.translate = function(x, y) {\r\n    var matrix = new Snap.Matrix();\r\n    matrix.translate(x, y);\r\n    return this.transform(matrix);\r\n  };\r\n});\r\n\r\n/**\r\n * @class CreatSnapAtPlugin\r\n *\r\n * Extends snap.svg with a method to create a SVG element\r\n * at a specific position in the DOM.\r\n */\r\nSnap.plugin(function (Snap, Element, Paper, global) {\r\n\r\n  /*\r\n   * @method snapsvg.createSnapAt\r\n   *\r\n   * @example\r\n   *\r\n   * snapsvg.createSnapAt(parentNode, 200, 200);\r\n   *\r\n   * @param {Number} width of svg\r\n   * @param {Number} height of svg\r\n   * @param {Object} parentNode svg Element will be child of this\r\n   *\r\n   * @return {snapsvg.Element} the newly created wrapped SVG element instance\r\n   */\r\n  Snap.createSnapAt = function(width, height, parentNode) {\r\n\r\n    var svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\r\n    svg.setAttribute('width', width);\r\n    svg.setAttribute('height', height);\r\n    if (!parentNode) {\r\n      parentNode = document.body;\r\n    }\r\n    parentNode.appendChild(svg);\r\n\r\n    return new Snap(svg);\r\n  };\r\n});\n},{}],54:[function(_dereq_,module,exports){\n'use strict';\r\n\r\n\r\nvar _ = (window._);\r\n\r\nvar GraphicsUtil = _dereq_('../../util/GraphicsUtil');\r\n\r\n\r\n/**\r\n * @class\r\n *\r\n * A plugin that provides interactivity in terms of events (mouse over and selection to a diagram).\r\n *\r\n * @param {EventBus} eventBus\r\n */\r\nfunction InteractionEvents(eventBus, styles) {\r\n\r\n  var HIT_STYLE = styles.cls('djs-hit', [ 'no-fill', 'no-border' ], {\r\n    pointerEvents: 'stroke',\r\n    stroke: 'white',\r\n    strokeWidth: 10\r\n  });\r\n\r\n  function isCtxSwitch(e) {\r\n    return !e.relatedTarget || e.target.parentNode !== e.relatedTarget.parentNode;\r\n  }\r\n\r\n  function fire(event, baseEvent, eventName) {\r\n    var e = _.extend({}, baseEvent, event);\r\n    eventBus.fire(eventName, e);\r\n  }\r\n\r\n  function makeSelectable(element, gfx, options) {\r\n    var type = options.type,\r\n        baseEvent = { element: element, gfx: gfx },\r\n        visual = GraphicsUtil.getVisual(gfx),\r\n        hit,\r\n        bbox;\r\n\r\n    if (type === 'shape') {\r\n      bbox = visual.getBBox();\r\n      hit = gfx.rect(bbox.x, bbox.y, bbox.width, bbox.height);\r\n    } else {\r\n      hit = visual.select('*').clone().attr('style', '');\r\n    }\r\n\r\n    hit.attr(HIT_STYLE).prependTo(gfx);\r\n\r\n    gfx.hover(function(e) {\r\n      if (isCtxSwitch(e)) {\r\n        /**\r\n         * An event indicating that shape|connection has been hovered\r\n         *\r\n         * shape.hover, connection.hover\r\n         */\r\n        fire(e, baseEvent, type + '.hover');\r\n      }\r\n    }, function(e) {\r\n      if (isCtxSwitch(e)) {\r\n        fire(e, baseEvent, type + '.out');\r\n      }\r\n    });\r\n\r\n    visual.click(function(e) {\r\n      fire(e, baseEvent, type + '.click');\r\n    });\r\n\r\n    visual.dblclick(function(e) {\r\n      fire(e, baseEvent, type + '.dblclick');\r\n    });\r\n  }\r\n\r\n  function registerEvents(eventBus) {\r\n\r\n    eventBus.on('canvas.init', function(event) {\r\n      var root = event.root;\r\n\r\n      // implement direct canvas click\r\n      root.click(function(event) {\r\n\r\n        /**\r\n         * An event indicating that the canvas has been directly clicked\r\n         *\r\n         * @memberOf InteractionEvents\r\n         *\r\n         * @event canvas.click\r\n         *\r\n         * @type {Object}\r\n         */\r\n        eventBus.fire('canvas.click', _.extend({}, event, { root: root }));\r\n      });\r\n    });\r\n\r\n    eventBus.on('shape.added', function(event) {\r\n      makeSelectable(event.element, event.gfx, { type: 'shape' });\r\n    });\r\n\r\n    eventBus.on('connection.added', function(event) {\r\n      makeSelectable(event.element, event.gfx, { type: 'connection' });\r\n    });\r\n  }\r\n\r\n  registerEvents(eventBus);\r\n}\r\n\r\n\r\nInteractionEvents.$inject = [ 'eventBus', 'styles' ];\r\n\r\nmodule.exports = InteractionEvents;\n},{\"../../util/GraphicsUtil\":65}],55:[function(_dereq_,module,exports){\nmodule.exports = {\r\n  __init__: [ 'interactionEvents' ],\r\n  interactionEvents: [ 'type', _dereq_('./InteractionEvents') ]\r\n};\n},{\"./InteractionEvents\":54}],56:[function(_dereq_,module,exports){\n'use strict';\r\n\r\n\r\nvar GraphicsUtil = _dereq_('../../util/GraphicsUtil');\r\n\r\n\r\n/**\r\n * @class\r\n *\r\n * A plugin that adds an outline to shapes and connections that may be activated and styled\r\n * via CSS classes.\r\n *\r\n * @param {EventBus} events the event bus\r\n */\r\nfunction Outline(events, styles) {\r\n\r\n  var OUTLINE_OFFSET = 5;\r\n\r\n  var OUTLINE_STYLE = styles.cls('djs-outline', [ 'no-fill' ]);\r\n\r\n  function createOutline(gfx) {\r\n    return gfx.rect(0, 0, 0, 0)\r\n            .attr(OUTLINE_STYLE)\r\n            .prependTo(gfx);\r\n  }\r\n\r\n  function updateOutline(outline, bbox) {\r\n\r\n    outline.attr({\r\n      x: bbox.x - OUTLINE_OFFSET,\r\n      y: bbox.y - OUTLINE_OFFSET,\r\n      width: bbox.width + OUTLINE_OFFSET * 2,\r\n      height: bbox.height + OUTLINE_OFFSET * 2\r\n    });\r\n  }\r\n\r\n  events.on('shape.added', function(event) {\r\n    var element = event.element,\r\n        gfx = event.gfx;\r\n\r\n    var outline = createOutline(gfx);\r\n\r\n    updateOutline(outline, GraphicsUtil.getVisual(gfx).getBBox());\r\n  });\r\n\r\n  events.on('connection.change', function(event) {\r\n    // TODO: update connection outline box\r\n  });\r\n\r\n  events.on('shape.change', function(event) {\r\n    // TODO: update shape outline box\r\n  });\r\n}\r\n\r\n\r\nOutline.$inject = ['eventBus', 'styles'];\r\n\r\nmodule.exports = Outline;\n},{\"../../util/GraphicsUtil\":65}],57:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nmodule.exports = {\r\n  __init__: [ 'outline' ],\r\n  outline: [ 'type', _dereq_('./Outline') ]\r\n};\n},{\"./Outline\":56}],58:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nvar _ = (window._),\r\n    $ = (window.$);\r\n\r\n// document wide unique overlay ids\r\nvar ids = new (_dereq_('../../util/IdGenerator'))('ov');\r\n\r\n\r\n/**\r\n * A plugin that allows users to attach overlays to diagram elements.\r\n *\r\n * The overlay service will take care of overlay positioning during updates.\r\n *\r\n * @class\r\n *\r\n * @example\r\n *\r\n * // add a pink badge on the top left of the shape\r\n * overlays.add(someShape, {\r\n *   position: {\r\n *     top: -5,\r\n *     left: -5\r\n *   }\r\n *   html: '<div style=\"width: 10px; background: fuchsia; color: white;\">0</div>'\r\n * });\r\n *\r\n * // or add via shape id\r\n *\r\n * overlays.add('some-element-id', {\r\n *   position: {\r\n *     top: -5,\r\n *     left: -5\r\n *   }\r\n *   html: '<div style=\"width: 10px; background: fuchsia; color: white;\">0</div>'\r\n * });\r\n *\r\n * // or add with optional type\r\n *\r\n * overlays.add(someShape, 'badge', {\r\n *   position: {\r\n *     top: -5,\r\n *     left: -5\r\n *   }\r\n *   html: '<div style=\"width: 10px; background: fuchsia; color: white;\">0</div>'\r\n * });\r\n *\r\n *\r\n * // remove an overlay\r\n *\r\n * var id = overlays.add(...);\r\n * overlays.remove(id);\r\n *\r\n * @param {EventBus} eventBus\r\n * @param {Canvas} canvas\r\n * @param {ElementRegistry} elementRegistry\r\n */\r\nfunction Overlays(config, eventBus, canvas, elementRegistry) {\r\n\r\n  this._eventBus = eventBus;\r\n  this._canvas = canvas;\r\n  this._elementRegistry = elementRegistry;\r\n\r\n  this._ids = ids;\r\n\r\n  this._overlayDefaults = {\r\n    show: {\r\n      trigger: 'automatic',\r\n      minZoom: 0.7,\r\n      maxZoom: 5.0\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Mapping overlay-id > overlay\r\n   */\r\n  this._overlays = {};\r\n\r\n  /**\r\n   * Mapping element-id > overlay container\r\n   */\r\n  this._overlayContainers = {};\r\n\r\n  // root html element for all overlays\r\n  this._overlayRoot = $('<div class=\"djs-overlay-container\" />')\r\n                        .css({ position: 'absolute', width: 0, height: 0 })\r\n                        .prependTo(canvas.getContainer());\r\n\r\n  this._init(config);\r\n}\r\n\r\n\r\nOverlays.$inject = [ 'config.overlays', 'eventBus', 'canvas', 'elementRegistry' ];\r\n\r\nmodule.exports = Overlays;\r\n\r\n\r\n/**\r\n * Returns the overlay with the specified id or a list of overlays\r\n * for an element with a given type.\r\n *\r\n * @example\r\n *\r\n * // return the single overlay with the given id\r\n * overlays.get('some-id');\r\n *\r\n * // return all overlays for the shape\r\n * overlays.get({ element: someShape });\r\n *\r\n * // return all overlays on shape with type 'badge'\r\n * overlays.get({ element: someShape, type: 'badge' });\r\n *\r\n * // shape can also be specified as id\r\n * overlays.get({ element: 'element-id', type: 'badge' });\r\n *\r\n *\r\n * @param {Object} filter\r\n * @param {String} [filter.id]\r\n * @param {String|djs.model.Base} [filter.element]\r\n * @param {String} [filter.type]\r\n *\r\n * @return {Object|Array<Object>} the overlay(s)\r\n */\r\nOverlays.prototype.get = function(filter) {\r\n\r\n  if (_.isString(filter)) {\r\n    filter = { id: filter };\r\n  }\r\n\r\n  if (filter.element) {\r\n    var container = this._getOverlayContainer(filter.element, true);\r\n\r\n    // return a list of overlays when filtering by element (+type)\r\n    if (container) {\r\n      return filter.type ? _.filter(container.overlays, { type: filter.type }) : _.clone(container.overlays);\r\n    } else {\r\n      return [];\r\n    }\r\n  } else {\r\n    // return single element when filtering by id\r\n    return filter.id ? this._overlays[filter.id] : null;\r\n  }\r\n};\r\n\r\n/**\r\n * Adds a HTML overlay to an element.\r\n *\r\n * @param {String|djs.model.Base}   element   attach overlay to this shape\r\n * @param {String}                  [type]    optional type to assign to the overlay\r\n * @param {Object}                  overlay   the overlay configuration\r\n *\r\n * @param {String|DOMElement}       overlay.html                      html element to use as an overlay\r\n * @param {Object}                  [overlay.show]                    show configuration\r\n * @param {Number}                  overlay.show.minZoom              minimal zoom level to show the overlay\r\n * @param {Number}                  overlay.show.maxZoom              maximum zoom level to show the overlay\r\n * @param {String}                  [overlay.show.trigger=automatic]  automatic or manual (user triggers show)\r\n * @param {Object}                  overlay.show.position             where to attach the overlay\r\n * @param {Number}                  [overlay.show.position.left]      relative to element bbox left attachment\r\n * @param {Number}                  [overlay.show.position.top]       relative to element bbox top attachment\r\n * @param {Number}                  [overlay.show.position.bottom]    relative to element bbox bottom attachment\r\n * @param {Number}                  [overlay.show.position.right]     relative to element bbox right attachment\r\n *\r\n * @return {String}                 id that may be used to reference the overlay for update or removal\r\n */\r\nOverlays.prototype.add = function(element, type, overlay) {\r\n\r\n  if (_.isObject(type)) {\r\n    overlay = type;\r\n    type = null;\r\n  }\r\n\r\n  if (_.isString(element)) {\r\n    element = this._elementRegistry.getById(element);\r\n  }\r\n\r\n  if (!overlay.position) {\r\n    throw new Error('must specifiy overlay position');\r\n  }\r\n\r\n  if (!overlay.html) {\r\n    throw new Error('must specifiy overlay html');\r\n  }\r\n\r\n  if (!element) {\r\n    throw new Error('invalid element specified');\r\n  }\r\n\r\n  var id = this._ids.next();\r\n\r\n  overlay = _.extend({}, this._overlayDefaults, overlay, {\r\n    id: id,\r\n    type: type,\r\n    element: element,\r\n    html: $(overlay.html)\r\n  });\r\n\r\n  this._addOverlay(overlay);\r\n\r\n  return id;\r\n};\r\n\r\n\r\n/**\r\n * Remove an overlay with the given id\r\n *\r\n * @param  {String} id\r\n */\r\nOverlays.prototype.remove = function(id) {\r\n\r\n  var overlay = this.get(id),\r\n      container = overlay && this._getOverlayContainer(overlay.element, true);\r\n\r\n  if (overlay) {\r\n    overlay.html.remove();\r\n    overlay.htmlContainer.remove();\r\n\r\n    delete overlay.htmlContainer;\r\n    delete overlay.element;\r\n\r\n    delete this._overlays[id];\r\n  }\r\n\r\n  if (container) {\r\n    var idx = container.overlays.indexOf(overlay);\r\n    if (idx !== -1) {\r\n      container.overlays.splice(idx, 1);\r\n    }\r\n  }\r\n};\r\n\r\n\r\nOverlays.prototype.show = function() {\r\n  this._overlayRoot.show();\r\n};\r\n\r\n\r\nOverlays.prototype.hide = function() {\r\n  this._overlayRoot.hide();\r\n};\r\n\r\n\r\nOverlays.prototype._updateOverlayContainer = function(container) {\r\n  var element = container.element,\r\n      html = container.html;\r\n\r\n  // update container left,top according to the elements x,y coordinates\r\n  // this ensures we can attach child elements relative to this container\r\n\r\n  // TODO(nre): update according to element bbox (for connections)\r\n  html.css({ left: element.x, top: element.y });\r\n};\r\n\r\n\r\nOverlays.prototype._updateOverlay = function(overlay) {\r\n\r\n  var position = overlay.position,\r\n      htmlContainer = overlay.htmlContainer,\r\n      element = overlay.element;\r\n\r\n  // update overlay html relative to shape because\r\n  // it is already positioned on the element\r\n\r\n  // update relative\r\n  var left = position.left,\r\n      top = position.top;\r\n\r\n  if (position.right !== undefined) {\r\n    left = position.right * -1 + element.width;\r\n  }\r\n\r\n  if (position.bottom !== undefined) {\r\n    top = position.bottom * -1 + element.height;\r\n  }\r\n\r\n  htmlContainer.css({ left: left || 0, top: top || 0 });\r\n};\r\n\r\n\r\nOverlays.prototype._createOverlayContainer = function(element) {\r\n  var html = $('<div />')\r\n                .addClass('djs-overlays')\r\n                .addClass('djs-overlays-' + element.id)\r\n                .css({ position: 'absolute' });\r\n\r\n  html.appendTo(this._overlayRoot);\r\n\r\n  var container = {\r\n    html: html,\r\n    element: element,\r\n    overlays: []\r\n  };\r\n\r\n  this._updateOverlayContainer(container);\r\n\r\n  return container;\r\n};\r\n\r\n\r\nOverlays.prototype._updateRoot = function(viewbox) {\r\n  var a = viewbox.scale || 1;\r\n  var d = viewbox.scale || 1;\r\n  var e = viewbox.x || 0;\r\n  var f = viewbox.y || 0;\r\n\r\n  var matrix = 'matrix(' + a + ',0,0,' + d + ',' + (-1 * viewbox.x * a) + ',' + (-1 * viewbox.y * d) + ')';\r\n\r\n  this._overlayRoot.css('transform', matrix);\r\n};\r\n\r\n\r\nOverlays.prototype._getOverlayContainer = function(element, raw) {\r\n  var id = (element && element.id) || element;\r\n\r\n  var container = this._overlayContainers[id];\r\n  if (!container && !raw) {\r\n    container = this._overlayContainers[id] = this._createOverlayContainer(element);\r\n  }\r\n\r\n  return container;\r\n};\r\n\r\n\r\nOverlays.prototype._addOverlay = function(overlay) {\r\n\r\n  var id = overlay.id,\r\n      element = overlay.element;\r\n\r\n  var container = this._getOverlayContainer(element);\r\n\r\n  var htmlContainer = $('<div>', {\r\n    id: id,\r\n    className: 'djs-overlay'\r\n  }).css({ position: 'absolute' }).append(overlay.html);\r\n\r\n  if (overlay.type) {\r\n    htmlContainer.addClass('djs-overlay-' + overlay.type);\r\n  }\r\n\r\n  overlay.htmlContainer = htmlContainer;\r\n\r\n  container.overlays.push(overlay);\r\n  container.html.append(htmlContainer);\r\n\r\n  this._overlays[id] = overlay;\r\n\r\n  this._updateOverlay(overlay);\r\n};\r\n\r\nOverlays.prototype._updateOverlayVisibilty = function(viewbox) {\r\n\r\n  _.forEach(this._overlays, function(overlay) {\r\n    if (overlay.show) {\r\n      if (overlay.show.minZoom > viewbox.scale ||\r\n          overlay.show.maxZoom < viewbox.scale) {\r\n        overlay.htmlContainer.hide();\r\n      } else {\r\n        overlay.htmlContainer.show();\r\n      }\r\n    }\r\n  });\r\n};\r\n\r\nOverlays.prototype._init = function(config) {\r\n\r\n  var eventBus = this._eventBus;\r\n\r\n  var self = this;\r\n\r\n\r\n  // scroll/zoom integration\r\n\r\n  var updateViewbox = function(viewbox) {\r\n    self._updateRoot(viewbox);\r\n    self._updateOverlayVisibilty(viewbox);\r\n\r\n    self.show();\r\n  };\r\n\r\n  if (!config || config.deferUpdate !== false) {\r\n    updateViewbox = _.debounce(updateViewbox, 300);\r\n  }\r\n\r\n  eventBus.on('canvas.viewbox.changed', function(event) {\r\n    self.hide();\r\n    updateViewbox(event.viewbox);\r\n  });\r\n\r\n\r\n  // remove integration\r\n\r\n  eventBus.on([ 'shape.remove', 'connection.remove' ], function(e) {\r\n    var overlays = self.get({ element: e.element });\r\n\r\n    _.forEach(overlays, function(o) {\r\n      self.remove(o.id);\r\n    });\r\n  });\r\n\r\n\r\n  // move integration\r\n\r\n  eventBus.on([\r\n    'commandStack.shape.move.executed',\r\n    'commandStack.shape.move.reverted'\r\n  ], function(e) {\r\n    var element = e.context.shape;\r\n\r\n    var container = self._getOverlayContainer(element, true);\r\n    if (container) {\r\n      self._updateOverlayContainer(container);\r\n    }\r\n  });\r\n};\n},{\"../../util/IdGenerator\":66}],59:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nmodule.exports = {\r\n  __init__: [ 'overlays' ],\r\n  overlays: [ 'type', _dereq_('./Overlays') ]\r\n};\n},{\"./Overlays\":58}],60:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nvar _ = (window._);\r\n\r\n\r\n/**\r\n * A service that offers the current selection in a diagram.\r\n * Offers the api to control the selection, too.\r\n *\r\n * @class\r\n *\r\n * @param {EventBus} eventBus the event bus\r\n */\r\nfunction Selection(eventBus) {\r\n\r\n  this._eventBus = eventBus;\r\n\r\n  this._selectedElements = [];\r\n\r\n  var self = this;\r\n\r\n  eventBus.on([ 'shape.remove', 'connection.remove' ], function(e) {\r\n    var element = e.element;\r\n    self.deselect(element);\r\n  });\r\n}\r\n\r\nSelection.$inject = [ 'eventBus' ];\r\n\r\nmodule.exports = Selection;\r\n\r\n\r\nSelection.prototype.deselect = function(element) {\r\n  var selectedElements = this._selectedElements;\r\n\r\n  var idx = selectedElements.indexOf(element);\r\n\r\n  if (idx !== -1) {\r\n    var oldSelection = selectedElements.slice();\r\n\r\n    selectedElements.splice(idx, 1);\r\n\r\n    this._eventBus.fire('selection.changed', { oldSelection: oldSelection, newSelection: selectedElements });\r\n  }\r\n};\r\n\r\n\r\nSelection.prototype.get = function() {\r\n  return this._selectedElements;\r\n};\r\n\r\nSelection.prototype.isSelected = function(element) {\r\n  return this._selectedElements.indexOf(element) !== -1;\r\n};\r\n\r\n\r\n/**\r\n * This method selects one or more elements on the diagram.\r\n *\r\n * By passing an additional add parameter you can decide whether or not the element(s)\r\n * should be added to the already existing selection or not.\r\n *\r\n * @method Selection#select\r\n *\r\n * @param  {Object|Object[]} elements element or array of elements to be selected\r\n * @param  {boolean} [add] whether the element(s) should be appended to the current selection, defaults to false\r\n */\r\nSelection.prototype.select = function(elements, add) {\r\n  var selectedElements = this._selectedElements,\r\n      oldSelection = selectedElements.slice();\r\n\r\n  if (!_.isArray(elements)) {\r\n    elements = elements ? [ elements ] : [];\r\n  }\r\n\r\n  var self = this;\r\n\r\n  // selection may be cleared by passing an empty array or null\r\n  // to the method\r\n  if (elements.length && add) {\r\n    _.forEach(elements, function(element) {\r\n      if (selectedElements.indexOf(element) !== -1) {\r\n        // already selected\r\n        return;\r\n      } else {\r\n        selectedElements.push(element);\r\n      }\r\n    });\r\n  } else {\r\n    this._selectedElements = selectedElements = elements.slice();\r\n  }\r\n\r\n  this._eventBus.fire('selection.changed', { oldSelection: oldSelection, newSelection: selectedElements });\r\n};\n},{}],61:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nvar _ = (window._);\r\n\r\n\r\nfunction originalEvent(e) {\r\n  return e.srcEvent || e;\r\n}\r\n\r\n\r\n/**\r\n * @class\r\n *\r\n * A plugin that adds a visible selection UI to shapes and connections\r\n * by appending the <code>hover</code> and <code>selected</code> classes to them.\r\n *\r\n * Makes elements selectable, too.\r\n *\r\n * @param {EventBus} events\r\n * @param {SelectionService} selection\r\n * @param {ElementRegistry} elementRegistry\r\n */\r\nfunction SelectionVisuals(events, selection, elementRegistry) {\r\n\r\n  var HOVER_CLS = 'hover',\r\n      SELECTED_CLS = 'selected';\r\n\r\n  function addMarker(gfx, cls) {\r\n    if (gfx) {\r\n      gfx.addClass(cls);\r\n    }\r\n  }\r\n\r\n  function removeMarker(gfx, cls) {\r\n    if (gfx) {\r\n      gfx.removeClass(cls);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Wire click on shape to select the shape\r\n   *\r\n   * @param  {Object} event the fired event\r\n   */\r\n  events.on('shape.click', function(event) {\r\n    var add = originalEvent(event).shiftKey;\r\n    selection.select(event.element, add);\r\n  });\r\n\r\n  events.on('shape.hover', function(event) {\r\n    addMarker(event.gfx, HOVER_CLS);\r\n  });\r\n\r\n  events.on('shape.out', function(event) {\r\n    removeMarker(event.gfx, HOVER_CLS);\r\n  });\r\n\r\n  events.on('selection.changed', function(event) {\r\n\r\n    function deselect(s) {\r\n      removeMarker(elementRegistry.getGraphicsByElement(s), SELECTED_CLS);\r\n    }\r\n\r\n    function select(s) {\r\n      addMarker(elementRegistry.getGraphicsByElement(s), SELECTED_CLS);\r\n    }\r\n\r\n    var oldSelection = event.oldSelection,\r\n        newSelection = event.newSelection;\r\n\r\n    _.forEach(oldSelection, function(e) {\r\n      if (newSelection.indexOf(e) === -1) {\r\n        deselect(e);\r\n      }\r\n    });\r\n\r\n    _.forEach(newSelection, function(e) {\r\n      if (oldSelection.indexOf(e) === -1) {\r\n        select(e);\r\n      }\r\n    });\r\n  });\r\n\r\n  // deselect all selected shapes on canvas click\r\n  events.on('canvas.click', function(event) {\r\n    if (originalEvent(event).srcElement === event.root.paper.node) {\r\n      selection.select(null);\r\n    }\r\n  });\r\n}\r\n\r\nSelectionVisuals.$inject = [\r\n  'eventBus',\r\n  'selection',\r\n  'elementRegistry'\r\n];\r\n\r\nmodule.exports = SelectionVisuals;\n},{}],62:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nmodule.exports = {\r\n  __init__: [ 'selectionVisuals' ],\r\n  __depends__: [\r\n    _dereq_('../interaction-events'),\r\n    _dereq_('../outline')\r\n  ],\r\n  selection: [ 'type', _dereq_('./Selection') ],\r\n  selectionVisuals: [ 'type', _dereq_('./SelectionVisuals') ]\r\n};\n},{\"../interaction-events\":55,\"../outline\":57,\"./Selection\":60,\"./SelectionVisuals\":61}],63:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nvar _ = (window._);\r\n\r\nvar Refs = _dereq_('object-refs');\r\n\r\nvar parentRefs = new Refs({ name: 'children', enumerable: true, collection: true }, { name: 'parent' }),\r\n    labelRefs = new Refs({ name: 'label', enumerable: true }, { name: 'labelTarget' }),\r\n    outgoingRefs = new Refs({ name: 'outgoing', collection: true }, { name: 'source' }),\r\n    incomingRefs = new Refs({ name: 'incoming', collection: true }, { name: 'target' });\r\n\r\n/**\r\n * @namespace djs.model\r\n */\r\n\r\n/**\r\n * @memberOf djs.model\r\n */\r\n\r\n/**\r\n * The basic graphical representation\r\n *\r\n * @class\r\n *\r\n * @abstract\r\n */\r\nfunction Base() {\r\n\r\n  /**\r\n   * The object that backs up the shape\r\n   *\r\n   * @name Base#businessObject\r\n   * @type Object\r\n   */\r\n  Object.defineProperty(this, 'businessObject', {\r\n    writable: true\r\n  });\r\n\r\n  /**\r\n   * The parent shape\r\n   *\r\n   * @name Base#parent\r\n   * @type Shape\r\n   */\r\n  parentRefs.bind(this, 'parent');\r\n\r\n  /**\r\n   * @name Base#label\r\n   * @type Label\r\n   */\r\n  labelRefs.bind(this, 'label');\r\n\r\n  /**\r\n   * The list of outgoing connections\r\n   *\r\n   * @name Base#outgoing\r\n   * @type Array<Connection>\r\n   */\r\n  outgoingRefs.bind(this, 'outgoing');\r\n\r\n  /**\r\n   * The list of outgoing connections\r\n   *\r\n   * @name Base#incoming\r\n   * @type Array<Connection>\r\n   */\r\n  incomingRefs.bind(this, 'incoming');\r\n}\r\n\r\n\r\n/**\r\n * A graphical object\r\n *\r\n * @class\r\n * @constructor\r\n *\r\n * @extends Base\r\n */\r\nfunction Shape() {\r\n  Base.call(this);\r\n\r\n  /**\r\n   * The list of children\r\n   *\r\n   * @name Shape#children\r\n   * @type Array<Base>\r\n   */\r\n  parentRefs.bind(this, 'children');\r\n}\r\n\r\nShape.prototype = Object.create(Base.prototype);\r\n\r\n\r\n/**\r\n * A root graphical object\r\n *\r\n * @class\r\n * @constructor\r\n *\r\n * @extends Shape\r\n */\r\nfunction Root() {\r\n  Shape.call(this);\r\n}\r\n\r\nRoot.prototype = Object.create(Shape.prototype);\r\n\r\n\r\n/**\r\n * A label for an element\r\n *\r\n * @class\r\n * @constructor\r\n *\r\n * @extends Shape\r\n */\r\nfunction Label() {\r\n  Shape.call(this);\r\n\r\n  /**\r\n   * The labeled element\r\n   *\r\n   * @name Label#labelTarget\r\n   * @type Base\r\n   */\r\n  labelRefs.bind(this, 'labelTarget');\r\n}\r\n\r\nLabel.prototype = Object.create(Shape.prototype);\r\n\r\n\r\n/**\r\n * A connection between two elements\r\n *\r\n * @class\r\n * @constructor\r\n *\r\n * @extends Base\r\n */\r\nfunction Connection() {\r\n  Base.call(this);\r\n\r\n  /**\r\n   * The element this connection originates from\r\n   *\r\n   * @name Connection#source\r\n   * @type Base\r\n   */\r\n  outgoingRefs.bind(this, 'source');\r\n\r\n  /**\r\n   * The element this connection points to\r\n   *\r\n   * @name Connection#target\r\n   * @type Base\r\n   */\r\n  incomingRefs.bind(this, 'target');\r\n}\r\n\r\nConnection.prototype = Object.create(Base.prototype);\r\n\r\n\r\nvar types = {\r\n  connection: Connection,\r\n  shape: Shape,\r\n  label: Label,\r\n  root: Root\r\n};\r\n\r\n/**\r\n * Creates a new model element of the specified type\r\n *\r\n * @method create\r\n *\r\n * @example\r\n *\r\n * var shape1 = Model.create('shape', { x: 10, y: 10, width: 100, height: 100 });\r\n * var shape2 = Model.create('shape', { x: 210, y: 210, width: 100, height: 100 });\r\n *\r\n * var connection = Model.create('connection', { waypoints: [ { x: 110, y: 55 }, {x: 210, y: 55 } ] });\r\n *\r\n * @param  {String} type lower-cased model name\r\n * @param  {Object} attrs attributes to initialize the new model instance with\r\n *\r\n * @return {Base} the new model instance\r\n */\r\nmodule.exports.create = function(type, attrs) {\r\n  var Type = types[type];\r\n  if (!Type) {\r\n    throw new Error('unknown type: <' + type + '>');\r\n  }\r\n  return _.extend(new Type(), attrs);\r\n};\r\n\r\n\r\nmodule.exports.Root = Root;\r\nmodule.exports.Shape = Shape;\r\nmodule.exports.Connection = Connection;\r\nmodule.exports.Label = Label;\n},{\"object-refs\":72}],64:[function(_dereq_,module,exports){\n'use strict';\r\n\r\n/**\r\n * Failsafe remove an element from a collection\r\n *\r\n * @param  {Array<Object>} [collection]\r\n * @param  {Object} [element]\r\n *\r\n * @return {Object} the element that got removed or undefined\r\n */\r\nmodule.exports.remove = function(collection, element) {\r\n\r\n  if (!collection || !element) {\r\n    return;\r\n  }\r\n\r\n  var idx = collection.indexOf(element);\r\n  if (idx === -1) {\r\n    return;\r\n  }\r\n\r\n  collection.splice(idx, 1);\r\n\r\n  return element;\r\n};\n},{}],65:[function(_dereq_,module,exports){\n'use strict';\r\n\r\n/**\r\n * @module util/GraphicsUtil\r\n */\r\n\r\nfunction is(e, cls) {\r\n  return e.hasClass(cls);\r\n}\r\n\r\n\r\n/**\r\n *\r\n * A note on how SVG elements are structured:\r\n *\r\n * Shape layout:\r\n *\r\n * [group.djs-group.djs-shape]\r\n *  |-> [rect.djs-hit]\r\n *  |-> [rect.djs-visual]\r\n *  |-> [rect.djs-outline]\r\n *  ...\r\n *\r\n * [group.djs-group.djs-connection]\r\n *  |-> [polyline.djs-hit]\r\n *  |-> [polyline.djs-visual]\r\n *  |-> [polyline.djs-outline]\r\n *  ...\r\n *\r\n */\r\n\r\n/**\r\n * Returns the visual part of a diagram element\r\n *\r\n * @param  {snapsvg.Element} gfx\r\n * @return {snapsvg.Element}\r\n */\r\nfunction getVisual(gfx) {\r\n  return gfx.select('.djs-visual');\r\n}\r\n\r\nmodule.exports.getVisual = getVisual;\n},{}],66:[function(_dereq_,module,exports){\n'use strict';\r\n\r\n/**\r\n * Util that provides unique IDs.\r\n *\r\n * @class djs.util.IdGenerator\r\n * @memberOf djs.util\r\n *\r\n * @constructor\r\n *\r\n * The ids can be customized via a given prefix and contain a random value to avoid collisions.\r\n *\r\n * @param {String} prefix a prefix to prepend to generated ids (for better readability)\r\n */\r\nfunction IdGenerator(prefix) {\r\n\r\n  this._counter = 0;\r\n  this._prefix = (prefix ? prefix + '-' : '') + Math.floor(Math.random() * 1000000000) + '-';\r\n}\r\n\r\nmodule.exports = IdGenerator;\r\n\r\n/**\r\n * Returns a next unique ID.\r\n *\r\n * @method djs.util.IdGenerator#next\r\n *\r\n * @returns {String} the id\r\n */\r\nIdGenerator.prototype.next = function() {\r\n  return this._prefix + (++this._counter);\r\n};\r\n\n},{}],67:[function(_dereq_,module,exports){\nvar _ = (window._);\r\n\r\nvar DEFAULT_BOX_PADDING = 5;\r\n\r\nvar DEFAULT_LABEL_SIZE = {\r\n  width: 150,\r\n  height: 50\r\n};\r\n\r\n\r\nfunction parseAlign(align) {\r\n\r\n  var parts = align.split('-');\r\n\r\n  return {\r\n    horizontal: parts[0] || 'center',\r\n    vertical: parts[1] || 'top'\r\n  };\r\n}\r\n\r\nfunction parsePadding(padding) {\r\n\r\n  if (_.isObject(padding)) {\r\n    return _.extend({ top: 0, left: 0, right: 0, bottom: 0 }, padding);\r\n  } else {\r\n    return {\r\n      top: padding,\r\n      left: padding,\r\n      right: padding,\r\n      bottom: padding\r\n    };\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * Creates a new label utility\r\n *\r\n * @param {Object} config\r\n * @param {Dimensions} config.size\r\n * @param {Number} config.padding\r\n * @param {Object} config.style\r\n * @param {String} config.align\r\n */\r\nfunction LabelUtil(config) {\r\n\r\n  config = _.extend({}, {\r\n    size: DEFAULT_LABEL_SIZE,\r\n    padding: DEFAULT_BOX_PADDING,\r\n    style: {},\r\n    align: 'center-top'\r\n  }, config || {});\r\n\r\n  /**\r\n   * Create a label in the parent node.\r\n   *\r\n   * @method LabelUtil#createLabel\r\n   *\r\n   * @param {SVGElement} parent the parent to draw the label on\r\n   * @param {String} text the text to render on the label\r\n   * @param {Object} options\r\n   * @param {String} options.align how to align in the bounding box.\r\n   *                             Any of { 'center-middle', 'center-top' }, defaults to 'center-top'.\r\n   * @param {String} options.style style to be applied to the text\r\n   *\r\n   * @return {SVGText} the text element created\r\n   */\r\n  function createLabel(parent, text, options) {\r\n\r\n    var box = _.merge({}, config.size, options.box || {}),\r\n        style = _.merge({}, config.style, options.style || {}),\r\n        align = parseAlign(options.align || config.align),\r\n        padding = parsePadding(options.padding !== undefined ? options.padding : config.padding);\r\n\r\n    var lines = text.split(/\\r?\\n/g),\r\n        layouted = [];\r\n\r\n    var maxWidth = box.width - padding.left - padding.right;\r\n\r\n    /**\r\n     * Layout the next line and return the layouted element.\r\n     *\r\n     * Alters the lines passed.\r\n     *\r\n     * @param  {Array<String>} lines\r\n     * @return {Object} the line descriptor, an object { width, height, text }\r\n     */\r\n    function layoutNext(lines) {\r\n\r\n      var originalLine = lines.shift(),\r\n          fitLine = originalLine;\r\n\r\n      var textBBox;\r\n\r\n      function fit() {\r\n        if (fitLine.length < originalLine.length) {\r\n          var nextLine = lines[0] || '',\r\n              remainder = originalLine.slice(fitLine.length);\r\n\r\n          if (/-\\s*$/.test(remainder)) {\r\n            nextLine = remainder.replace(/-\\s*$/, '') + nextLine.replace(/^\\s+/, '');\r\n          } else {\r\n            nextLine = remainder + ' ' + nextLine;\r\n          }\r\n\r\n          lines[0] = nextLine;\r\n        }\r\n        return { width: textBBox.width, height: textBBox.height, text: fitLine };\r\n      }\r\n\r\n      function getTextBBox(text) {\r\n        var textElement = parent.text(0, 0, fitLine).attr(style);\r\n\r\n        var bbox = textElement.getBBox();\r\n\r\n        textElement.remove();\r\n        return bbox;\r\n      }\r\n\r\n      /**\r\n       * Shortens a line based on spacing and hyphens.\r\n       * Returns the shortened result on success.\r\n       *\r\n       * @param  {String} line\r\n       * @param  {Number} maxLength the maximum characters of the string\r\n       * @return {String} the shortened string\r\n       */\r\n      function semanticShorten(line, maxLength) {\r\n        var parts = line.split(/(\\s|-)/g),\r\n            part,\r\n            shortenedParts = [],\r\n            length = 0;\r\n\r\n        // try to shorten via spaces + hyphens\r\n        if (parts.length > 1) {\r\n          while ((part = parts.shift())) {\r\n\r\n            if (part.length + length < maxLength) {\r\n              shortenedParts.push(part);\r\n              length += part.length;\r\n            } else {\r\n              // remove previous part, too if hyphen does not fit anymore\r\n              if (part === '-') {\r\n                shortenedParts.pop();\r\n              }\r\n\r\n              break;\r\n            }\r\n          }\r\n        }\r\n\r\n        return shortenedParts.join('');\r\n      }\r\n\r\n      function shortenLine(line, width, maxWidth) {\r\n        var shortenedLine = '';\r\n\r\n        var approximateLength = line.length * (maxWidth / width);\r\n\r\n        // try to shorten semantically (i.e. based on spaces and hyphens)\r\n        shortenedLine = semanticShorten(line, approximateLength);\r\n\r\n        if (!shortenedLine) {\r\n\r\n          // force shorten by cutting the long word\r\n          shortenedLine = line.slice(0, Math.floor(approximateLength - 1));\r\n        }\r\n\r\n        return shortenedLine;\r\n      }\r\n\r\n\r\n      while (true) {\r\n\r\n        textBBox = getTextBBox(fitLine);\r\n\r\n        // try to fit\r\n        if (textBBox.width < maxWidth) {\r\n          return fit();\r\n        }\r\n\r\n        fitLine = shortenLine(fitLine, textBBox.width, maxWidth);\r\n      }\r\n    }\r\n\r\n    while (lines.length) {\r\n      layouted.push(layoutNext(lines));\r\n    }\r\n\r\n    var totalHeight = _.reduce(layouted, function(sum, line, idx) {\r\n      return sum + line.height;\r\n    }, 0);\r\n\r\n\r\n    // the center x position to align against\r\n    var cx = box.width / 2;\r\n\r\n    // the y position of the next line\r\n    var y, x;\r\n\r\n    switch (align.vertical) {\r\n      case 'middle':\r\n        y = (box.height - totalHeight) / 2 - layouted[0].height / 4;\r\n        break;\r\n\r\n      default:\r\n        y = padding.top;\r\n    }\r\n\r\n    var textElement = parent.group().attr(style);\r\n\r\n    _.forEach(layouted, function(line) {\r\n      y += line.height;\r\n\r\n      switch (align.horizontal) {\r\n        case 'left':\r\n          x = padding.left;\r\n          break;\r\n\r\n        case 'right':\r\n          x = (maxWidth - padding.right - line.width);\r\n          break;\r\n\r\n        default:\r\n          // aka center\r\n          x = (maxWidth - line.width) / 2 + padding.left;\r\n      }\r\n\r\n\r\n      parent.text(x, y, line.text).appendTo(textElement);\r\n    });\r\n\r\n    return textElement;\r\n  }\r\n\r\n  // API\r\n  this.createLabel = createLabel;\r\n}\r\n\r\n\r\nmodule.exports = LabelUtil;\n},{}],68:[function(_dereq_,module,exports){\n\r\nvar isArray = function(obj) {\r\n  return Object.prototype.toString.call(obj) === '[object Array]';\r\n};\r\n\r\nvar annotate = function() {\r\n  var args = Array.prototype.slice.call(arguments);\r\n  \r\n  if (args.length === 1 && isArray(args[0])) {\r\n    args = args[0];\r\n  }\r\n\r\n  var fn = args.pop();\r\n\r\n  fn.$inject = args;\r\n\r\n  return fn;\r\n};\r\n\r\n\r\n// Current limitations:\r\n// - can't put into \"function arg\" comments\r\n// function /* (no parenthesis like this) */ (){}\r\n// function abc( /* xx (no parenthesis like this) */ a, b) {}\r\n//\r\n// Just put the comment before function or inside:\r\n// /* (((this is fine))) */ function(a, b) {}\r\n// function abc(a) { /* (((this is fine))) */}\r\n\r\nvar FN_ARGS = /^function\\s*[^\\(]*\\(\\s*([^\\)]*)\\)/m;\r\nvar FN_ARG = /\\/\\*([^\\*]*)\\*\\//m;\r\n\r\nvar parse = function(fn) {\r\n  if (typeof fn !== 'function') {\r\n    throw new Error('Cannot annotate \"' + fn + '\". Expected a function!');\r\n  }\r\n\r\n  var match = fn.toString().match(FN_ARGS);\r\n  return match[1] && match[1].split(',').map(function(arg) {\r\n    match = arg.match(FN_ARG);\r\n    return match ? match[1].trim() : arg.trim();\r\n  }) || [];\r\n};\r\n\r\n\r\nexports.annotate = annotate;\r\nexports.parse = parse;\r\nexports.isArray = isArray;\r\n\n},{}],69:[function(_dereq_,module,exports){\nmodule.exports = {\r\n  annotate: _dereq_('./annotation').annotate,\r\n  Module: _dereq_('./module'),\r\n  Injector: _dereq_('./injector')\r\n};\r\n\n},{\"./annotation\":68,\"./injector\":70,\"./module\":71}],70:[function(_dereq_,module,exports){\nvar Module = _dereq_('./module');\r\nvar autoAnnotate = _dereq_('./annotation').parse;\r\nvar annotate = _dereq_('./annotation').annotate;\r\nvar isArray = _dereq_('./annotation').isArray;\r\n\r\n\r\nvar Injector = function(modules, parent) {\r\n  parent = parent || {\r\n    get: function(name) {\r\n      currentlyResolving.push(name);\r\n      throw error('No provider for \"' + name + '\"!');\r\n    }\r\n  };\r\n\r\n  var currentlyResolving = [];\r\n  var providers = this._providers = Object.create(parent._providers || null);\r\n  var instances = this._instances = Object.create(null);\r\n\r\n  var self = instances.injector = this;\r\n\r\n  var error = function(msg) {\r\n    var stack = currentlyResolving.join(' -> ');\r\n    currentlyResolving.length = 0;\r\n    return new Error(stack ? msg + ' (Resolving: ' + stack + ')' : msg);\r\n  };\r\n\r\n  var get = function(name) {\r\n    if (!providers[name] && name.indexOf('.') !== -1) {\r\n      var parts = name.split('.');\r\n      var pivot = get(parts.shift());\r\n\r\n      while(parts.length) {\r\n        pivot = pivot[parts.shift()];\r\n      }\r\n\r\n      return pivot;\r\n    }\r\n\r\n    if (Object.hasOwnProperty.call(instances, name)) {\r\n      return instances[name];\r\n    }\r\n\r\n    if (Object.hasOwnProperty.call(providers, name)) {\r\n      if (currentlyResolving.indexOf(name) !== -1) {\r\n        currentlyResolving.push(name);\r\n        throw error('Cannot resolve circular dependency!');\r\n      }\r\n\r\n      currentlyResolving.push(name);\r\n      instances[name] = providers[name][0](providers[name][1]);\r\n      currentlyResolving.pop();\r\n\r\n      return instances[name];\r\n    }\r\n\r\n    return parent.get(name);\r\n  };\r\n\r\n  var instantiate = function(Type) {\r\n    var instance = Object.create(Type.prototype);\r\n    var returned = invoke(Type, instance);\r\n\r\n    return typeof returned === 'object' ? returned : instance;\r\n  };\r\n\r\n  var invoke = function(fn, context) {\r\n    if (typeof fn !== 'function') {\r\n      if (isArray(fn)) {\r\n        fn = annotate(fn.slice());\r\n      } else {\r\n        throw new Error('Cannot invoke \"' + fn + '\". Expected a function!');\r\n      }\r\n    }\r\n\r\n    var inject = fn.$inject && fn.$inject || autoAnnotate(fn);\r\n    var dependencies = inject.map(function(dep) {\r\n      return get(dep);\r\n    });\r\n\r\n    // TODO(vojta): optimize without apply\r\n    return fn.apply(context, dependencies);\r\n  };\r\n\r\n\r\n  var createPrivateInjectorFactory = function(privateChildInjector) {\r\n    return annotate(function(key) {\r\n      return privateChildInjector.get(key);\r\n    });\r\n  };\r\n\r\n  var createChild = function(modules, forceNewInstances) {\r\n    if (forceNewInstances && forceNewInstances.length) {\r\n      var fromParentModule = Object.create(null);\r\n      var matchedScopes = Object.create(null);\r\n\r\n      var privateInjectorsCache = [];\r\n      var privateChildInjectors = [];\r\n      var privateChildFactories = [];\r\n\r\n      var provider;\r\n      var cacheIdx;\r\n      var privateChildInjector;\r\n      var privateChildInjectorFactory;\r\n      for (var name in providers) {\r\n        provider = providers[name];\r\n\r\n        if (forceNewInstances.indexOf(name) !== -1) {\r\n          if (provider[2] === 'private') {\r\n            cacheIdx = privateInjectorsCache.indexOf(provider[3]);\r\n            if (cacheIdx === -1) {\r\n              privateChildInjector = provider[3].createChild([], forceNewInstances);\r\n              privateChildInjectorFactory = createPrivateInjectorFactory(privateChildInjector);\r\n              privateInjectorsCache.push(provider[3]);\r\n              privateChildInjectors.push(privateChildInjector);\r\n              privateChildFactories.push(privateChildInjectorFactory);\r\n              fromParentModule[name] = [privateChildInjectorFactory, name, 'private', privateChildInjector];\r\n            } else {\r\n              fromParentModule[name] = [privateChildFactories[cacheIdx], name, 'private', privateChildInjectors[cacheIdx]];\r\n            }\r\n          } else {\r\n            fromParentModule[name] = [provider[2], provider[1]];\r\n          }\r\n          matchedScopes[name] = true;\r\n        }\r\n\r\n        if ((provider[2] === 'factory' || provider[2] === 'type') && provider[1].$scope) {\r\n          forceNewInstances.forEach(function(scope) {\r\n            if (provider[1].$scope.indexOf(scope) !== -1) {\r\n              fromParentModule[name] = [provider[2], provider[1]];\r\n              matchedScopes[scope] = true;\r\n            }\r\n          });\r\n        }\r\n      }\r\n\r\n      forceNewInstances.forEach(function(scope) {\r\n        if (!matchedScopes[scope]) {\r\n          throw new Error('No provider for \"' + scope + '\". Cannot use provider from the parent!');\r\n        }\r\n      });\r\n\r\n      modules.unshift(fromParentModule);\r\n    }\r\n\r\n    return new Injector(modules, self);\r\n  };\r\n\r\n  var factoryMap = {\r\n    factory: invoke,\r\n    type: instantiate,\r\n    value: function(value) {\r\n      return value;\r\n    }\r\n  };\r\n\r\n  modules.forEach(function(module) {\r\n\r\n    function arrayUnwrap(type, value) {\r\n      if (type !== 'value' && isArray(value)) {\r\n        value = annotate(value.slice());\r\n      }\r\n\r\n      return value;\r\n    }\r\n\r\n    // TODO(vojta): handle wrong inputs (modules)\r\n    if (module instanceof Module) {\r\n      module.forEach(function(provider) {\r\n        var name = provider[0];\r\n        var type = provider[1];\r\n        var value = provider[2];\r\n\r\n        providers[name] = [factoryMap[type], arrayUnwrap(type, value), type];\r\n      });\r\n    } else if (typeof module === 'object') {\r\n      if (module.__exports__) {\r\n        var clonedModule = Object.keys(module).reduce(function(m, key) {\r\n          if (key.substring(0, 2) !== '__') {\r\n            m[key] = module[key];\r\n          }\r\n          return m;\r\n        }, Object.create(null));\r\n\r\n        var privateInjector = new Injector((module.__modules__ || []).concat([clonedModule]), self);\r\n        var getFromPrivateInjector = annotate(function(key) {\r\n          return privateInjector.get(key);\r\n        });\r\n        module.__exports__.forEach(function(key) {\r\n          providers[key] = [getFromPrivateInjector, key, 'private', privateInjector];\r\n        });\r\n      } else {\r\n        Object.keys(module).forEach(function(name) {\r\n          if (module[name][2] === 'private') {\r\n            providers[name] = module[name];\r\n            return;\r\n          }\r\n\r\n          var type = module[name][0];\r\n          var value = module[name][1];\r\n\r\n          providers[name] = [factoryMap[type], arrayUnwrap(type, value), type];\r\n        });\r\n      }\r\n    }\r\n  });\r\n\r\n  // public API\r\n  this.get = get;\r\n  this.invoke = invoke;\r\n  this.instantiate = instantiate;\r\n  this.createChild = createChild;\r\n};\r\n\r\nmodule.exports = Injector;\r\n\n},{\"./annotation\":68,\"./module\":71}],71:[function(_dereq_,module,exports){\nvar Module = function() {\r\n  var providers = [];\r\n\r\n  this.factory = function(name, factory) {\r\n    providers.push([name, 'factory', factory]);\r\n    return this;\r\n  };\r\n\r\n  this.value = function(name, value) {\r\n    providers.push([name, 'value', value]);\r\n    return this;\r\n  };\r\n\r\n  this.type = function(name, type) {\r\n    providers.push([name, 'type', type]);\r\n    return this;\r\n  };\r\n\r\n  this.forEach = function(iterator) {\r\n    providers.forEach(iterator);\r\n  };\r\n};\r\n\r\nmodule.exports = Module;\r\n\n},{}],72:[function(_dereq_,module,exports){\nmodule.exports = _dereq_('./lib/refs');\r\n\r\nmodule.exports.Collection = _dereq_('./lib/collection');\n},{\"./lib/collection\":73,\"./lib/refs\":74}],73:[function(_dereq_,module,exports){\n'use strict';\r\n\r\n/**\r\n * An empty collection stub. Use {@link RefsCollection.extend} to extend a\r\n * collection with ref semantics.\r\n *\r\n * @classdesc A change and inverse-reference aware collection with set semantics.\r\n *\r\n * @class RefsCollection\r\n */\r\nfunction RefsCollection() { }\r\n\r\n/**\r\n * Extends a collection with {@link Refs} aware methods\r\n *\r\n * @memberof RefsCollection\r\n * @static\r\n *\r\n * @param  {Array<Object>} collection\r\n * @param  {Refs} refs instance\r\n * @param  {Object} property represented by the collection\r\n * @param  {Object} target object the collection is attached to\r\n *\r\n * @return {RefsCollection<Object>} the extended array\r\n */\r\nfunction extend(collection, refs, property, target) {\r\n\r\n  var inverseProperty = property.inverse;\r\n\r\n  /**\r\n   * Removes the given element from the array and returns it.\r\n   *\r\n   * @method RefsCollection#remove\r\n   *\r\n   * @param {Object} element the element to remove\r\n   */\r\n  collection.remove = function(element) {\r\n    var idx = this.indexOf(element);\r\n    if (idx !== -1) {\r\n      this.splice(idx, 1);\r\n\r\n      // unset inverse\r\n      refs.unset(element, inverseProperty, target);\r\n    }\r\n\r\n    return element;\r\n  };\r\n\r\n  /**\r\n   * Returns true if the collection contains the given element\r\n   *\r\n   * @method RefsCollection#contains\r\n   *\r\n   * @param {Object} element the element to check for\r\n   */\r\n  collection.contains = function(element) {\r\n    return this.indexOf(element) !== -1;\r\n  };\r\n\r\n  /**\r\n   * Adds an element to the array, unless it exists already (set semantics).\r\n   *\r\n   * @method RefsCollection#add\r\n   *\r\n   * @param {Object} element the element to add\r\n   */\r\n  collection.add = function(element) {\r\n\r\n    if (!this.contains(element)) {\r\n      this.push(element);\r\n\r\n      // set inverse\r\n      refs.set(element, inverseProperty, target);\r\n    }\r\n  };\r\n\r\n  return collection;\r\n}\r\n\r\n\r\nmodule.exports.extend = extend;\n},{}],74:[function(_dereq_,module,exports){\n'use strict';\r\n\r\nvar Collection = _dereq_('./collection');\r\n\r\nfunction hasOwnProperty(e, property) {\r\n  return Object.prototype.hasOwnProperty.call(e, property.name || property);\r\n}\r\n\r\n\r\nfunction defineCollectionProperty(ref, property, target) {\r\n  Object.defineProperty(target, property.name, {\r\n    enumerable: property.enumerable,\r\n    value: Collection.extend(target[property.name] || [], ref, property, target)\r\n  });\r\n}\r\n\r\n\r\nfunction defineProperty(ref, property, target) {\r\n\r\n  var inverseProperty = property.inverse;\r\n\r\n  var _value = target[property.name];\r\n\r\n  Object.defineProperty(target, property.name, {\r\n    enumerable: property.enumerable,\r\n\r\n    get: function() {\r\n      return _value;\r\n    },\r\n\r\n    set: function(value) {\r\n\r\n      // return if we already performed all changes\r\n      if (value === _value) {\r\n        return;\r\n      }\r\n\r\n      var old = _value;\r\n\r\n      // temporary set null\r\n      _value = null;\r\n\r\n      if (old) {\r\n        ref.unset(old, inverseProperty, target);\r\n      }\r\n\r\n      // set new value\r\n      _value = value;\r\n\r\n      // set inverse value\r\n      ref.set(_value, inverseProperty, target);\r\n    }\r\n  });\r\n\r\n}\r\n\r\n/**\r\n * Creates a new references object defining two inversly related\r\n * attribute descriptors a and b.\r\n *\r\n * <p>\r\n *   When bound to an object using {@link Refs#bind} the references\r\n *   get activated and ensure that add and remove operations are applied\r\n *   reversely, too.\r\n * </p>\r\n *\r\n * <p>\r\n *   For attributes represented as collections {@link Refs} provides the\r\n *   {@link RefsCollection#add}, {@link RefsCollection#remove} and {@link RefsCollection#contains} extensions\r\n *   that must be used to properly hook into the inverse change mechanism.\r\n * </p>\r\n *\r\n * @class Refs\r\n *\r\n * @classdesc A bi-directional reference between two attributes.\r\n *\r\n * @param {Refs.AttributeDescriptor} a property descriptor\r\n * @param {Refs.AttributeDescriptor} b property descriptor\r\n *\r\n * @example\r\n *\r\n * var refs = Refs({ name: 'wheels', collection: true, enumerable: true }, { name: 'car' });\r\n *\r\n * var car = { name: 'toyota' };\r\n * var wheels = [{ pos: 'front-left' }, { pos: 'front-right' }];\r\n *\r\n * refs.bind(car, 'wheels');\r\n *\r\n * car.wheels // []\r\n * car.wheels.add(wheels[0]);\r\n * car.wheels.add(wheels[1]);\r\n *\r\n * car.wheels // [{ pos: 'front-left' }, { pos: 'front-right' }]\r\n *\r\n * wheels[0].car // { name: 'toyota' };\r\n * car.wheels.remove(wheels[0]);\r\n *\r\n * wheels[0].car // undefined\r\n */\r\nfunction Refs(a, b) {\r\n\r\n  if (!(this instanceof Refs)) {\r\n    return new Refs(a, b);\r\n  }\r\n\r\n  // link\r\n  a.inverse = b;\r\n  b.inverse = a;\r\n\r\n  this.props = {};\r\n  this.props[a.name] = a;\r\n  this.props[b.name] = b;\r\n}\r\n\r\n/**\r\n * Binds one side of a bi-directional reference to a\r\n * target object.\r\n *\r\n * @memberOf Refs\r\n *\r\n * @param  {Object} target\r\n * @param  {String} property\r\n */\r\nRefs.prototype.bind = function(target, property) {\r\n  if (typeof property === 'string') {\r\n    if (!this.props[property]) {\r\n      throw new Error('no property <' + property + '> in ref');\r\n    }\r\n    property = this.props[property];\r\n  }\r\n\r\n  if (property.collection) {\r\n    defineCollectionProperty(this, property, target);\r\n  } else {\r\n    defineProperty(this, property, target);\r\n  }\r\n};\r\n\r\nRefs.prototype.ensureBound = function(target, property) {\r\n  if (!hasOwnProperty(target, property)) {\r\n    this.bind(target, property);\r\n  }\r\n};\r\n\r\nRefs.prototype.unset = function(target, property, value) {\r\n\r\n  if (target) {\r\n    this.ensureBound(target, property);\r\n\r\n    if (property.collection) {\r\n      target[property.name].remove(value);\r\n    } else {\r\n      target[property.name] = undefined;\r\n    }\r\n  }\r\n};\r\n\r\nRefs.prototype.set = function(target, property, value) {\r\n\r\n  if (target) {\r\n    this.ensureBound(target, property);\r\n\r\n    if (property.collection) {\r\n      target[property.name].add(value);\r\n    } else {\r\n      target[property.name] = value;\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = Refs;\r\n\r\n\r\n/**\r\n * An attribute descriptor to be used specify an attribute in a {@link Refs} instance\r\n *\r\n * @typedef {Object} Refs.AttributeDescriptor\r\n * @property {String} name\r\n * @property {boolean} [collection=false]\r\n * @property {boolean} [enumerable=false]\r\n */\n},{\"./collection\":73}],75:[function(_dereq_,module,exports){\nmodule.exports=_dereq_(72)\n},{\"./lib/collection\":76,\"./lib/refs\":77}],76:[function(_dereq_,module,exports){\nmodule.exports=_dereq_(73)\n},{}],77:[function(_dereq_,module,exports){\nmodule.exports=_dereq_(74)\n},{\"./collection\":76}]},{},[1])\n(1)\n});"]}